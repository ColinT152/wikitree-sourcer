!function(e){function t(t){for(var a,o,s=t[0],l=t[1],c=t[2],d=0,m=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&m.push(i[o][0]),i[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(p&&p(t);m.length;)m.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(a=!1)}a&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},i={9:0},r=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var p=l;r.push([578,0]),n()}({1:function(e,t){e.exports=React},110:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareIcons=t.ShareClipping=void 0;var a=n(3),i=n(1),r=n(7),o=n(188),s=n(32),l=n(79),c=n(189),p=n(13),d=n(5),m=n(190),u=n(111),h=n(21),g={ancestry:{symbol:"an",name:"Ancestry",supported:["clipping"]},embed:{symbol:"embed",name:"Embed",supported:["clipping"]},email:{symbol:"email",name:"Email",supported:["clipping"]},facebook:{symbol:"fb",name:"Facebook",supported:["clipping"]},twitter:{symbol:"tw",name:"Twitter",supported:["clipping"]},pinterest:{symbol:"pint",name:"Pinterest",supported:["clipping"]}};t.ShareClipping=function(e){var n=e.id,f=e.initialName,b=e.clipping,y=e.sourceEmail,v=e.firstClipping,_=e.newClipping,E=e.setId,w=e.updateClipping,C=a.__read(i.useState(f||""),2),S=C[0],N=C[1],x=a.__read(i.useState({width:700,height:700}),2),k=x[0],P=x[1],I=a.__read(i.useState(""),2),M=I[0],D=I[1],T=a.__read(i.useState("large"),2),O=T[0],A=T[1],F=a.__read(i.useState(new Map([[0,""]])),2),L=F[0],R=F[1],B=a.__read(i.useState(!1),2),V=B[0],z=B[1],G=a.__read(i.useState(!1),2),U=G[0],H=G[1],j=a.__read(i.useState({sourceEmail:y,recipients:"",message:"I thought you might like to see a clipping someone created on ".concat(ncom.product.name),url:"",srcid:null==b?void 0:b.clipping_id,sourceType:"Footnote",unregFlag:ncom.user?"0":"1"}),2),W=j[0],K=j[1],Z=a.__read(i.useState(),2),Y=Z[0],J=(Z[1],i.useRef(null)),$=i.useRef(null),q=i.useRef(!1);i.useEffect((function(){return K((function(e){return a.__assign(a.__assign({},e),{sourceEmail:y,url:"".concat(ncom.paths.site,"/clip/").concat(b.clipping_id)})}))}),[y,n,b.clipping_id]);var X=function(e,t){e.preventDefault(),t.current.select(),t.current.setSelectionRange(0,999999),navigator.clipboard?navigator.clipboard.writeText(t.current.value):document.execCommand("copy")},Q=function(e){void 0===e&&(e="large"),D((function(){if("large"===e){A("large"),P({width:700,height:700});var t=b.rectangle.height/b.rectangle.width;return t=Math.floor(590*t),"".concat(ncom.paths.image,"/img/img?clippingId=").concat(b.clipping_id,"&amp;width=700&amp;height=").concat(t,"&amp;ts=1607535806")}return"medium"===e?(A("medium"),P({width:300,height:300}),"".concat(ncom.paths.image,"/img/thumbnail/").concat(b.page_id,"/300/300/").concat(b.rectangle.x,"_").concat(b.rectangle.y,"_").concat(b.rectangle.width,"_").concat(b.rectangle.height,".jpg")):(A("small"),P({width:200,height:200}),"".concat(ncom.paths.image,"/img/thumbnail/").concat(b.page_id,"/200/200/").concat(b.rectangle.x,"_").concat(b.rectangle.y,"_").concat(b.rectangle.width,"_").concat(b.rectangle.height,".jpg"))}))};i.useEffect((function(){return K((function(e){return a.__assign(a.__assign({},e),{srcid:b.clipping_id})}))}),[b]),i.useEffect((function(){var e=a.__spreadArray([],a.__read(L.values()),!1).filter((function(e){return(0,o.isValidEmail)(e)})).join("|");K((function(t){return a.__assign(a.__assign({},t),{recipients:e})}))}),[L]),i.useEffect((function(){m.ShareDao.showShareAfterClip(U)}),[U]),i.useEffect((function(){return(null==b?void 0:b.rectangle)&&Q("large")}),[b]);var ee=function(e,t){var n,a;q.current||((0,u.putEvent)({type:"ancestry"===t?"SAVE_TO_ANCESTRY":"SHARE",facets:{label:"clipping",share_to:t,embed_size:"embed"===t?O:void 0,embed_iframe:"embed"===t?V:void 0,user:(null===ncom||void 0===ncom?void 0:ncom.user)?ncom.user:void 0,product:(null===(n=null===ncom||void 0===ncom?void 0:ncom.product)||void 0===n?void 0:n.id)?ncom.product.id:void 0,institution:(null===(a=null===ncom||void 0===ncom?void 0:ncom.institution)||void 0===a?void 0:a.id)?ncom.institution.id:void 0,clipping:e.clipping_id,image:e.page_id,publication:e.page_publication_id,article:e.article_id?e.article_id:void 0}}),(0,h.sendArticleShareEvent)(e.clipping_id.toString(),{article_name:e.title?e.title:e.publication?e.publication.name:"",social_platform:"facebook"===t||"twitter"===t||"pinterest"===t?t:""}),q.current=!0,setTimeout((function(){q.current=!1}),1e3))};return i.createElement(r.NewsModal,{id:n.toString(),alert:Y,size:"lg",visible:n>0,close:function(){E(0)}},i.createElement("div",{id:"share_dialog"},i.createElement("h1",{id:"mt-".concat(n.toString()),className:"border-bottom border-dark mb-2 pb-2 mt-0 h3"},f||"Share"),!b.is_public&&b.user_id===ncom.user&&i.createElement(i.Fragment,null,i.createElement("p",{className:"alert text-center mb-0",role:"alert"},i.createElement("span",{className:"icon-error","aria-hidden":"true"})," This clipping is not visible to the public. Change your clipping to visible to share."),b.user_id===ncom.user&&i.createElement(d.ModalFooter,null,i.createElement(d.Button,{color:"link",onClick:function(){E(0)}},"Cancel"),i.createElement(d.Button,{color:"primary",onClick:function(){return a.__awaiter(void 0,void 0,void 0,(function(){var e;return a.__generator(this,(function(t){return(e=s.Clipping.copy(b)).is_public=!0,w(b,e),E(b.clipping_id),[2]}))}))}},"Make Visible & Share"))),!!b.is_public&&i.createElement(i.Fragment,null,!f&&i.createElement("div",{id:"socialsites",className:"mt-3"},i.createElement("ul",{className:"ss-icons list-inline"},Object.values(g).map((function(e,n){return i.createElement(t.ShareIcons,a.__assign({key:n},e,{displayHandle:N}))})))),i.createElement(p.ErrorBoundary,{FallbackComponent:r.FallbackOops},function(){switch(S){case g.ancestry.name:var e=document.createElement("script");e.src=ncom.saveToAncestryApiScript,document.head.appendChild(e),e.onload=function(){void 0!==window.SaveToAncestryApi&&("undefined"!=typeof staPageDetail?(window.SaveToAncestryApi.invoke(staPageDetail),ee(b,"ancestry")):l.ClippingDao.getSaveToAncestryClippingDetails(b.clipping_id).then((function(e){var t=e.data;window.SaveToAncestryApi.invoke(t),ee(b,"ancestry")}))),e.remove()},N("");break;case g.embed.name:return i.createElement("div",{id:"share_link_embed",className:"w-100 border-bottom pb-2 mb-2 row no-gutters"},i.createElement("label",{className:"form-col-label col-12 col-sm-2  text-sm-right text-muted pr-3",htmlFor:"share_link_embed_url"},"Embed"),i.createElement("div",{className:"embed-tools col-12 col-sm-10"},b&&i.createElement("textarea",{ref:$,className:"w-100",rows:4,id:"share_link_embed_url",readOnly:!0,value:V?'<iframe src="'.concat(ncom.paths.www,"/clippings/embed_clipping/?id=").concat(b.clipping_id,"&w=").concat(k.width,"&h=").concat(k.height,'" scrolling="no" frameBorder="0" height=').concat(k.height," width=").concat(k.width,' style="width: ').concat(k.width,"px; height: ").concat(k.height,"px; background: #fff url(").concat(ncom.paths.www,'/i/loading-sm.gif) no-repeat 50% 50%;"></iframe>'):'<a href="'.concat(ncom.paths.site,"/clip/").concat(n,"/").concat(b.title?(0,r.getUrlTitle)(b.title,40):(0,r.getUrlTitle)(b.publication.name,40),'/" style="text-decoration: none;display:block;" target="_parent"><img src="').concat(M,'" alt="').concat(b.title,'" style="max-width:100%;"><span style="display:block;font: 13px helvetica, sans-serif; color: #747474;padding: 4px 0;max-width: 700px;"><strong>').concat(b.title,"</strong> ").concat((0,c.DateFormat)(b.page_date)," <em>").concat(b.publication.name," (").concat(b.publication.location,")</em> Newspapers.com</span></a>")}),i.createElement("div",{className:"form-check mb-2"},i.createElement("input",{className:"form-check-input",id:"embedder",type:"checkbox",checked:V,onChange:function(){return z(!V)}}),i.createElement("label",{className:"form-check-label",htmlFor:"embedder"},"Use advanced embed",i.createElement("span",{className:"text-muted"}," (Uses iframe tag and includes more info)"))),i.createElement("fieldset",{className:"share_embed_size form-group"},i.createElement("div",{className:"form-check form-check-inline"},i.createElement("input",{className:"form-check-input",type:"radio",id:"sizeL",name:"embed_size",checked:"large"===O,value:"large",onChange:function(e){var t=e.target.value;return Q(t)}}),i.createElement("label",{className:"form-check-label",htmlFor:"sizeL"},"Large")),i.createElement("div",{className:"form-check form-check-inline"},i.createElement("input",{className:"form-check-input",type:"radio",id:"sizeM",name:"embed_size",checked:"medium"===O,value:"medium",onChange:function(e){var t=e.target.value;return Q(t)}}),i.createElement("label",{className:"form-check-label",htmlFor:"sizeM"},"Medium")),i.createElement("div",{className:"form-check form-check-inline"},i.createElement("input",{className:"form-check-input",type:"radio",id:"sizeS",name:"embed_size",checked:"small"===O,value:"small",onChange:function(e){var t=e.target.value;return Q(t)}}),i.createElement("label",{className:"form-check-label",htmlFor:"sizeS"},"Small"))),i.createElement("div",{className:"btn_bar m-0"},i.createElement("button",{id:"embed_copy",className:"btn-primary btn dlg_button",onClick:function(e){X(e,$),ee(b,"embed")}},"Copy Embed Code"))));case g.email.name:return i.createElement("div",{id:"share_email",className:"border-bottom pb-2 mb-2 row no-gutters on"},i.createElement("form",{id:"share_form",className:"w-100",action:"#",method:"POST",onSubmit:function(){return!1}},i.createElement("div",{id:"input_controls"},i.createElement(d.Container,{fluid:!0,className:"border-top pt-3"},i.createElement("div",{className:"form-row"},i.createElement(d.Col,{xs:12,lg:4,className:"text-lg-right"},i.createElement("label",{"data-cy":"friend-email",className:"text-muted",htmlFor:"email-0"},"Friend's Email:")),i.createElement(d.Col,{xs:12,lg:8},i.createElement("div",{id:"share_target",className:"lbl-value form-group"},a.__spreadArray([],a.__read(L.keys()),!1).map((function(e,t){return i.createElement(d.Row,{noGutters:!0,className:"pb-2",key:t},i.createElement(d.Col,null,i.createElement("input",{className:"form-control",id:"email-".concat(t),required:0===t,value:L.get(e),onChange:function(e){var n=e.currentTarget.value;return R((function(e){var a=new Map(e);return a.set(t,n),a}))}})),L.size>1&&i.createElement(d.Col,{xs:"auto"},i.createElement(d.Button,{className:"mx-2 btn btn-secondary",type:"button",onClick:function(){R((function(t){var n=new Map(t);return n.delete(e),n}))}},"Remove")))})),i.createElement("a",{"data-cy":"add-another-email",className:"addmore",href:"#",role:"button",onClick:function(){return R((function(e){var t=new Map(e);return t.set(e.size,""),t}))}},i.createElement("small",null,"Add another email"))))),i.createElement("div",{className:"form-row"},i.createElement(d.Col,{xs:12,lg:4,className:"text-lg-right"},i.createElement("label",{"data-cy":"your-email",className:"text-muted",htmlFor:"share_source_email"},"Your Email: ")),i.createElement(d.Col,{lg:8},i.createElement("div",{id:"source_email",className:"form-group"},i.createElement("input",{className:"form-control",value:W.sourceEmail,readOnly:!!ncom.user,onChange:function(e){var t=e.currentTarget.value;return K((function(e){return a.__assign(a.__assign({},e),{sourceEmail:t})}))}})))),i.createElement("div",{className:"form-row"},i.createElement(d.Col,{xs:12,lg:4,className:"text-lg-right"},i.createElement("label",{className:"text-muted"},"Message (Optional):")),i.createElement(d.Col,{lg:8},i.createElement("div",{id:"share_message",className:"lbl-value form-group"},i.createElement("textarea",{"data-cy":"share-message",readOnly:!ncom.user,className:"textarea text form-control",id:"share_message_text",name:"message",rows:7,value:W.message,onChange:function(e){var t=e.currentTarget.value;return K((function(e){return a.__assign(a.__assign({},e),{message:t})}))}})))),i.createElement("div",{className:"form-row"},i.createElement(d.Col,{lg:{size:8,offset:4}},i.createElement("div",{id:"share_controls"},i.createElement("input",{type:"submit",value:"Send",disabled:!(0,o.isValidEmail)(W.sourceEmail)||!W.recipients.split("|").every((function(e){return(0,o.isValidEmail)(e)})),className:"btn-primary btn dlg_button",onClick:function(e){e.preventDefault(),m.ShareDao.sendEmail(W),E(0),N(""),ee(b,"email")}}))))))));case g.facebook.name:return window.open("https://facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent("".concat(ncom.paths.site,"/clip/").concat(n,"/"))),g.facebook.name,"width=800,height=600"),ee(b,"facebook"),i.createElement(i.Fragment,null);case g.twitter.name:return window.open("https://twitter.com/intent/tweet?url=".concat(encodeURIComponent("".concat(ncom.paths.site,"/clip/").concat(n,"/")),"&text=").concat(encodeURIComponent(b.title)),g.twitter.name,"width=800,height=600"),ee(b,"twitter"),i.createElement(i.Fragment,null);case g.pinterest.name:return window.open("http://pinterest.com/pin/create/button/?url=".concat(encodeURIComponent("".concat(ncom.paths.site,"/clip/").concat(n,"/")),"&description=").concat(encodeURIComponent(b.title)),g.pinterest.name,"width=800,height=600"),ee(b,"pinterest"),i.createElement(i.Fragment,null);default:return i.createElement(i.Fragment,null)}}()),!f&&i.createElement("div",{className:"form-group form-row justify-content-center"},i.createElement("label",{className:"sr-only",htmlFor:"share_link_link_url"},"Share clipping link:"),i.createElement("div",{id:"share_link_link",className:"input-group justify-content-center no-gutters mt-3 mb-3 col-12 col-sm-8"},i.createElement("input",{type:"text",id:"share_link_link_url",className:"form-control bg-white user-select-all",ref:J,value:"".concat(ncom.paths.site,"/clip/").concat(n,"/").concat(b.title?(0,r.getUrlTitle)(b.title,40)+"/":""),contentEditable:!0,readOnly:!0,"aria-describedby":"copyBtn"}),i.createElement("div",{className:"input-group-append"},i.createElement("button",{type:"button",className:"btn-secondary btn dlg_button",id:"copyBtn",onClick:function(e){X(e,J),ee(b,"copy_url")}},"Copy")))),v||_&&i.createElement("div",{className:"share-footer"},i.createElement("label",{className:"text-muted"},i.createElement("input",{id:"showShareAfterCreatingClipping",checked:U,type:"checkbox",onChange:function(){return H((function(e){return!e}))}})," Hide share options after creating a new clipping.")))))};t.ShareIcons=function(e){var t=e.symbol,n=e.name,a=e.displayHandle;return i.createElement("li",{className:"list-inline-item ss-".concat(t)},i.createElement("a",{href:"#",role:"button",id:"".concat(n.toLowerCase(),"-share"),onClick:function(e){e.preventDefault(),a(n)}},n))}},248:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Browse=void 0;var a=n(3),i=n(1),r=n(108),o=n(11),s=n(5),l=n(249),c=n(13),p=n(22),d=n(251),m=n(6),u=n(7);function h(){var e=o.QueryTerms.countryAbbrevaiationToFullCountry(ncom.country_code?ncom.country_code:"us");return e&&ncom.country_code&&"us"!==ncom.country_code?e.toLowerCase().replace(/\s/g,"-"):"united-states"}t.Browse=(0,m.observer)((function(e){var t,n,m=e.viewerUrl,g=e.isAdmin,f=i.useRef(),b=(0,d.useContainerDimensions)(f).width,y=i.useRef(null),v=i.createRef(),_=a.__read(i.useState(void 0!==m?m:"/"+window.location.pathname.replace(/\/+$/,"").split("/").slice(2).join("/")),2),E=_[0],w=_[1],C=a.__read(i.useState(""),2),S=C[0],N=C[1],x=a.__read(i.useState(new Map),2),k=x[0],P=x[1],I=a.__read(i.useState(new Map([["COUNTRY",h()]])),2),M=I[0],D=I[1],T=a.__read(i.useState(!1),2),O=T[0],A=T[1],F=a.__read(i.useState(0),2),L=F[0],R=F[1],B=a.__read(i.useState(!0),2),V=B[0],z=B[1],G=a.__read(i.useState(!1),2),U=G[0],H=G[1],j=a.__read(i.useState(0),2),W=j[0],K=j[1];i.useEffect((function(){var e,t,n;(null===(n=y.current)||void 0===n?void 0:n.cancel)&&y.current.cancel();try{for(var i=a.__values(k.keys()),o=i.next();!o.done;o=i.next()){var s=o.value;E.startsWith(s)||k.delete(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}"PAGE"!==(k.size>0&&Array.from(k.values()).pop().typeOfChildren)&&void 0!==E&&function(e){var t;for(void 0===e&&(e="/"),t="/"===e||""===e?[""]:[e];e.lastIndexOf("/")>=0;)e=e.substring(0,e.lastIndexOf("/")),t.push(e);t.forEach((function(e){try{if(H(!0),Z&&k.has(e))return H(!1),k.get(e);r.BrowseDao.getNode(e,y).then((function(t){if(z(!0),void 0!==m&&z(!0),P((function(n){var i,r;try{for(var o=a.__values(n.entries()),s=o.next();!s.done;s=o.next()){var l=a.__read(s.value,2),c=l[0];l[1].typeOfChildren===t.typeOfChildren&&1===Number(ncom.product.id)&&n.delete(c)}}catch(e){i={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}var p=new Map(n);return p.set(e,t),p})),1===t.children.length&&void 0===m&&w((function(e){var n;return t.node||"/"!==e?t.node?(null===(n=null==e?void 0:e.split("/"))||void 0===n?void 0:n.includes(t.children[0].name))&&"PAGE"!==t.node.type?(history.replaceState({},null,"/browse".concat(e,"/")),e):(history.replaceState({},null,"/browse".concat(e,"/").concat(t.children[0].name,"/")),"".concat(e,"/").concat(t.children[0].name)):e:(history.replaceState({},null,"/browse/".concat(t.children[0].name,"/")),"/".concat(t.children[0].name))})),D((function(n){var a=new Map(n),i=e.split("/");return t.node&&"COUNTRY"===t.node.type&&a.set("",i[1]),t.node&&(a.set(t.node.type,i[i.length-1]),"MONTH"===t.node.type?a.set(t.node.type,"".concat(i[i.length-2],"-").concat(i[i.length-1])):"DATE"===t.node.type&&a.set(t.node.type,"".concat(i[i.length-3],"-").concat(i[i.length-2],"-").concat(i[i.length-1]))),a})),"COUNTRY"===t.typeOfChildren&&(null==E?void 0:E.length)<=1){var n=h(),i=t.children.find((function(e){return e.name===n}));i=void 0===i?t.children[0]:i,w("/".concat(i.name)),D((function(){var e=new Map;return e.set("",i.name),e}))}}))}catch(e){throw H(!1),e}}))}(E)}),[E]),i.useEffect((function(){b>700&&(K(Array.from(v.current.children).map((function(e){return e.clientWidth})).reduce((function(e,t){return e+t}),0)),b<=W&&V&&L<k.size-1&&R((function(e){return e+1})))}),[v,W]);i.useEffect((function(){b>0&&b<700&&R(E.split("/").length-1)}),[b]),i.useEffect((function(){m&&w(m)}),[m]);var Z=i.useMemo((function(){return Array.from(k.entries()).sort((function(e,t){var n=a.__read(e,2),i=n[0],r=(n[1],a.__read(t,2)),o=r[0];r[1];return i.length-o.length}))}),[k]);return i.useEffect((function(){H(!1)}),[Z.length]),i.createElement(s.Container,{fluid:!0,className:void 0!==m?"bg-light":"bg-white main-section n-page",id:void 0!==m?"viewer-browse-content":"content"},i.createElement(s.Row,{className:"no-gutters"},void 0!==m?i.createElement(i.Fragment,null):i.createElement("div",{className:"col col-sm-4 col-md-3 py-4 pl-sm-3 mr-auto"},i.createElement(s.Nav,{tabs:!0},i.createElement(s.NavItem,null,i.createElement(p.Link,{to:"/browse/"},i.createElement(s.NavLink,{className:"ml-4 active"},"Browse"))),i.createElement(s.NavItem,null,i.createElement(p.Link,{to:"/map/"},i.createElement(s.NavLink,null,"Map"))),void 0!==typeof g&&g?i.createElement(s.NavItem,null,i.createElement(s.NavLink,{className:O?"active":null,onClick:function(){return A(!O)}},O?"Default View":"Admin View")):i.createElement(i.Fragment,null))),i.createElement("form",{action:"/search/",method:"get",className:"py-sm-3 mb-3 mb-sm-0 ".concat(void 0!==m?" col-sm-12 col-md-12":" col-sm-8 col-md-9")},i.createElement("div",{className:"border-bottom form-row align-items-center search_controls justify-content-end"},i.createElement("div",{className:"col-auto d-none d-md-block pt-1 pr-sm-2"},i.createElement("label",{htmlFor:"searchText",className:"sr-only"},"Search within")),i.createElement("div",{className:"col-auto col-md-8 col-12 pb-2 input-group"},i.createElement("input",{id:"searchText",className:"form-control",value:S,placeholder:"Search within ".concat(Z&&Z.filter((function(e){var t,n=a.__read(e,2),i=(n[0],n[1]);return"United States of America"!==(null===(t=null==i?void 0:i.node)||void 0===t?void 0:t.displayName)})).map((function(e){var t=a.__read(e,2),n=(t[0],t[1]);return n.node?n.node.displayName||n.node.name:void 0})).slice(1,k.size).join(" › ")),type:"text",name:"query",onChange:function(e){var t=e.target.value;return N(t)},title:"Search within ".concat(Z&&Z.map((function(e){var t=a.__read(e,2),n=(t[0],t[1]);return n.node?n.node.displayName||n.node.name:void 0})).slice(1,k.size).join(" › "))}),i.createElement("div",{className:"input-group-append"},i.createElement("button",{type:"submit",className:"btn btn-primary icon-news icon-mag-left ".concat(S?"":"disabled"),onClick:function(e){e.preventDefault();var t=new o.QueryTerms([]),n=a.__read(Z.pop(),2),i=n[0],r=n[1];switch(r&&r.node.type){case"COUNTRY":t.addPlaces("country",[r.node.name.replace(/-/g," ")]);break;case"NATION":case"STATE":case"PROVINCE":t.addPlaces("province",[r.node.name.replace(/-/g," ")]);break;case"CITY":var s=i.slice(1).split("/").reverse().map((function(e){return e.replace(/-/g," ")})).join(", ");t.addPlaces("city",[s]);break;case"NEWSPAPER":t.addTitle(r.node.id.toString());break;case"YEAR":t.addTitle(r.ancestors[0].id.toString()),t.addDateRange("year",r.node.name,r.node.name,!1);break;case"MONTH":t.addTitle(r.ancestors[1].id.toString()),t.addDateExact("year_month",r.node.date,!1);break;case"DATE":t.addTitle(r.ancestors[2].id.toString()),t.addDateExact("year_month_day",r.node.date,!1)}t.addKeywords(S),window.location.href="/search/?".concat(t.toHash()),N("")}},i.createElement("span",{className:"sr-only"},"Search"))))))),i.createElement(s.Row,null,i.createElement("div",{className:"tab-content w-100",ref:f},i.createElement(s.TabPane,{tabId:"1",id:"browse_container",className:"fade show active"},i.createElement("div",{id:"browse_content",className:"clear"},L>0&&i.createElement("a",{id:"bc_previous",onClick:function(){L>0&&(b>700&&z(!1),R((function(e){return e-1})))},className:"d-inline-block"},i.createElement("span",{className:"d-inline-block d-sm-none icon-news icon-chevron-left btn btn-default btn-sm"},"Back")),b>700&&W>b&&i.createElement("a",{id:"bc_next",onClick:function(){L<k.size-1&&R((function(e){return e+1}))},className:Z&&(L>0||k.size>5||void 0!==m)?"d-inline-block":"d-none"},i.createElement("span",{className:"d-inline-block d-sm-none btn btn-default btn-sm"},"Next",i.createElement("span",{className:"icon-news icon-chevron"}))),i.createElement("div",{className:"bc_containers d-flex",ref:v},i.createElement(c.ErrorBoundary,{FallbackComponent:u.FallbackBlank},Z&&Z.filter((function(e,t){var n=a.__read(e,2);n[0],n[1];return t>=L})).map((function(e,t){var n=a.__read(e,2),r=n[0],o=n[1];return i.createElement(l.Column,{key:t,viewerUrl:m,width:b,setLeftColumnIndex:R,isAdminView:O,total:Array.from(k.entries()).filter((function(e,t){var n=a.__read(e,2);n[0],n[1];return t>=L})).length,columnNum:t,data:o,url:r,setUrl:w,selected:M,setColumnLoading:H})}))),k.size>0&&"PAGE"!==Z[k.size-1][1].typeOfChildren&&b>700?i.createElement("div",{className:"browse-container action-container position-static border-right flex-grow-1 flex-shrink-0 flex-sm-shrink-0 browse-container node-container flex-sm-grow-1"},i.createElement("div",{className:"info-text"},"Select",i.createElement("br",null),i.createElement("span",{className:"info-title"},Z&&k.size>0&&(null===(n=null===(t=Z[k.size-1][1])||void 0===t?void 0:t.typeOfChildren)||void 0===n?void 0:n.toLowerCase())),i.createElement("div",null,U&&i.createElement(s.Spinner,{color:"dark"},"Loading")))):i.createElement(i.Fragment,null)))),i.createElement(s.TabPane,{tabId:"2"},"Map UI"))))}))},249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Column=t.dateFormat=void 0;var a=n(3),i=n(1),r=n(101),o=n(108),s=n(22),l=n(7),c=n(250),p=n(5),d=n(21);t.dateFormat=function(e){var t=new RegExp("^\\d{4}-\\d{2}-\\d{2}$"),n=new RegExp("^\\d{4}-\\d{2}$");if(t.exec(e)){var a=e.split("-");return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][(i=new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2]))).getMonth()]+" "+a[2]+" "+a[0]+", "+["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][i.getDay()]}if(n.exec(e)){var i;a=e.split("-");return["January","February","March","April","May","June","July","August","September","October","November","December"][(i=new Date(parseInt(a[0]),parseInt(a[1])-1)).getMonth()]}return e};t.Column=function(e){var n,m=e.data,u=a.__read(i.useState(!1),2),h=u[0],g=u[1],f=a.__read(i.useState(),2),b=f[0],y=f[1],v=a.__read(i.useState(),2),_=v[0],E=v[1],w=a.__read(i.useState(),2),C=w[0],S=w[1],N=a.__read(i.useState([]),2),x=N[0],k=N[1],P=a.__read(i.useState([]),2),I=P[0],M=P[1],D=a.__read(i.useState(),2),T=D[0],O=D[1],A=a.__read(i.useState(!0),2),F=A[0],L=A[1],R=i.useRef(null);i.useEffect((function(){"PAGE"===m.typeOfChildren&&e.isAdminView&&y((function(){return m.children.map((function(e){return e.name}))}))}),[e.isAdminView]),i.useEffect((function(){e.isAdminView&&"PAGE"===m.typeOfChildren&&B()}),[b]);var B=function(){return a.__awaiter(void 0,void 0,void 0,(function(){var e;return a.__generator(this,(function(t){switch(t.label){case 0:return[4,o.BrowseDao.getImageDetails(b)];case 1:return e=t.sent().data.images,S(a.__spreadArray([],a.__read(Object.values(e)),!1)),[2]}}))}))};return i.useEffect((function(){var e,t;(null===(e=R.current)||void 0===e?void 0:e.offsetTop)&&(null===(t=null==R?void 0:R.current)||void 0===t||t.scrollIntoView({behavior:"smooth",block:"end"}))}),[null==R?void 0:R.current]),i.createElement("fieldset",{className:"".concat("PAGE"===(null==m?void 0:m.typeOfChildren)?"flex-sm-grow-1":"flex-sm-grow-0"," position-static border-right flex-grow-1 flex-shrink-0 flex-sm-shrink-0 browse-container node-container type-").concat(null===(n=null==m?void 0:m.typeOfChildren)||void 0===n?void 0:n.toLowerCase())},i.createElement("legend",{className:"heading mb-0 w-100"},i.createElement("b",{className:"title"},m.typeOfChildren),e.isAdminView&&"PAGE"===m.typeOfChildren&&i.createElement(p.Button,{className:"ml-2",color:"primary",size:"sm",onClick:function(){return L(!F)}},F?"Grid View":"List View"),i.createElement("span",{className:"count"},"(".concat(m.children.length,")")),e.isAdminView&&x.length>0&&i.createElement("button",{type:"button",className:"btn",style:{marginLeft:"5px",paddingTop:"2px",paddingBottom:"0px"},onClick:function(){confirm("Are you sure you want to archive "+x.length+" image"+(x.length>1?"s":"")+"?")&&x.forEach((function(e){o.BrowseDao.archiveImage(e).then((function(t){t.data.archived?M((function(t){return a.__spreadArray(a.__spreadArray([],a.__read(t),!1),[e],!1)})):alert("Unable to archive image "+e)})).catch((function(){return alert("Unable to archive image ")}))}))}},"Archive selected")),i.createElement("div",{className:"browse-content"},i.createElement("div",{className:"oc-container"},i.createElement("div",{className:"".concat("PAGE"===m.typeOfChildren?"d-flex justify-content-start flex-wrap align-content-start":"oc-content")},"PAGE"!==m.typeOfChildren?m.children.map((function(n,a){var r,o=function(t){return e.selected.has(null==m?void 0:m.typeOfChildren)&&(t.name===e.selected.get(null==m?void 0:m.typeOfChildren)||t.date===e.selected.get(null==m?void 0:m.typeOfChildren))?"selected":""}(n);return i.createElement("div",{key:n.name,ref:"selected"===o?R:null,className:"browse-node btn-group-toggle text-nowrap ".concat(a%2==0?"even":"odd"," ").concat(o," ").concat("selected"===o&&e.total-2===e.columnNum?"active":""," ").concat(n.extra&&"NEWSPAPER"!==m.typeOfChildren?"extra":"")},i.createElement(s.Link,{className:"title-link end-icon-news",to:null==e.viewerUrl?"/browse".concat(e.url,"/").concat(n.name,"/"):"#","data-value":n.name,onClick:function(){e.width<700&&e.setLeftColumnIndex((function(e){return e+1})),e.setColumnLoading(!0),e.setUrl((function(){return"/"!==e.url?"".concat(e.url,"/").concat(n.name):"".concat(n.name)}))}},i.createElement("label",{role:"button",className:"rounded-0 d-flex"},i.createElement("input",{type:"radio",name:m.typeOfChildren,tabIndex:a,className:"d-none"}),"MONTH"===m.typeOfChildren?(r=n.name,["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(r)-1]):"DATE"===m.typeOfChildren?i.createElement("span",{className:"text-nowrap"},(0,t.dateFormat)(n.date)):i.createElement("span",{className:"text-wrap"},n.displayName?n.displayName:n.name),n.extra&&"NEWSPAPER"===m.typeOfChildren?i.createElement("span",{className:"publisher-link",title:"Recent years are available through the Publisher Extra subscription."}):null)),"NEWSPAPER"===m.typeOfChildren?i.createElement("a",{className:"title-info",href:"/paper/".concat(n.name.replace(/_\d+$/,""),"/").concat(n.id,"/"),title:"Learn more about this newspaper"},"i"):null,"DATE"===m.typeOfChildren&&e.isAdminView||"EDITION"===m.typeOfChildren&&e.isAdminView?i.createElement("a",{className:"edit-meta",href:"#",title:"Edit metadata under ".concat(e.url,"/").concat(n.name),onClick:function(){E({path:"".concat(e.url,"/").concat(n.name),authorized:e.isAdminView,fields:["date"]}),g(!0)}}):i.createElement(i.Fragment,null))})):m.children.map((function(t,n){return i.createElement("div",{key:n,className:"browse-page text-center p-2 m-2",style:I.indexOf(t.name)>-1?{backgroundColor:"#BB2429"}:{}},i.createElement("a",{className:"title-link",href:"/image/".concat(t.name,"/"),onClick:function(n){(0,d.sendBrowseEvent)({newspaper_country:e.selected.get("COUNTRY"),newspaper_state:e.selected.get("STATE"),newspaper_city:e.selected.get("CITY"),newspaper_name:e.selected.get("NEWSPAPER"),newspaper_year:e.selected.get("YEAR"),newspaper_month:e.selected.get("MONTH"),newspaper_date:e.selected.get("DATE"),content_id:t.name})}},i.createElement("img",{src:r.ImageUtil.makeThumbnailUrl({imageId:parseInt(t.name)},90,90)}),i.createElement("p",{className:"text-center"},i.createElement("small",{"data-title":t.displayName},"Page ",t.displayName.includes("PAGE")?t.displayName.split(" ").slice(1).join("").toLowerCase():t.displayName))),e.isAdminView?i.createElement(i.Fragment,null,F&&C&&C.filter((function(e){return e.imageId==t.name})).map((function(e){return i.createElement("div",null,i.createElement("ul",{key:e.imageId},i.createElement("li",null,e.title),e.contentSource&&i.createElement("li",null,e.contentSource),i.createElement("li",null,e.dateUploaded),i.createElement("li",null,e.wfmPath.length<10?e.wfmPath:e.wfmPath.split("/").slice(2).join("/"))))})),i.createElement("a",{href:"#",onClick:function(){E({path:"".concat(e.url,"/").concat(t.name),authorized:e.isAdminView,imageId:t.name}),g(!0)}},"Edit Metadata"),i.createElement("div",null,i.createElement("input",{type:"checkbox",className:"fn-checkbox-archive-image",checked:x&&x.indexOf(t.name)>-1,onChange:function(e){e.nativeEvent.shiftKey&&void 0!==T?m.children.filter((function(e,t){return t<=T&&t>=n||t>=T&&t<=n})).forEach((function(e){return k((function(t){var n=t.indexOf(e.name);return n>-1&&n!==T?(t.splice(n,1),a.__spreadArray([],a.__read(t),!1)):a.__spreadArray(a.__spreadArray([],a.__read(t),!1),[e.name],!1)}))})):k((function(e){var n=e.indexOf(t.name);return n>-1?(e.splice(n,1),a.__spreadArray([],a.__read(e),!1)):a.__spreadArray(a.__spreadArray([],a.__read(e),!1),[t.name],!1)}));O(n)}})," Archive")):i.createElement(i.Fragment,null))}))))),e.isAdminView?i.createElement(l.NewsModal,{id:e.url,close:function(){return g(!1)},visible:h},i.createElement(c.EditMetaData,a.__assign({},_))):i.createElement(i.Fragment,null))}},250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditMetaData=void 0;var a=n(3),i=n(1),r=n(5),o=n(108);t.EditMetaData=function(e){var t=a.__read(i.useState(),2),n=t[0],s=t[1],l=a.__read(i.useState(""),2),c=l[0],p=l[1],d=a.__read(i.useState(!0),2),m=d[0],u=d[1],h=a.__read(i.useState([]),2),g=h[0],f=h[1],b=a.__read(i.useState(!1),2),y=b[0],v=b[1];i.useEffect((function(){var e=void 0!==g.find((function(e){return"image-type"===e.name}));v(e)}),[g]);var _=function(e){p(e),setTimeout((function(){return p("")}),5e3)};return i.useEffect((function(){o.BrowseDao.getImageMetaDataMinimal(e.imageId).then((function(e){return f(e.data.metadata)}))}),[]),i.useEffect((function(){s((function(){var e={};return g.forEach((function(t){var n=t.name,a=t.value;e["edit-md-".concat(n)]=a})),e}))}),[g]),e.authorized?i.createElement("div",null,e.imageId?i.createElement(i.Fragment,null,i.createElement("h3",null,"Edit Page Metadata"),i.createElement("p",{className:"text-secondary2"},e.path)):i.createElement(i.Fragment,null,i.createElement("h3",null,"Edit metadata under"),i.createElement("h4",null,e.path)),!!c&&i.createElement(r.Alert,{color:"success"},c),e.imageId?i.createElement(i.Fragment,null,g.map((function(e){var t=e.displayName,n=e.name,r=e.value;return"date"===n?i.createElement(i.Fragment,null,i.createElement("div",{key:n,className:"input-row"},i.createElement("label",{className:"text-capitalize my-1"},"date"),i.createElement("br",null),i.createElement("input",{type:"text",name:"edit-md-date",id:"edit-md-date",placeholder:r,required:!0,pattern:"{literal}[0-9]{4}-[0-9]{2}-[0-9]{2}{/literal}",onChange:function(e){var t=e.target,n=t.name,i=t.value;return s((function(e){var t;return a.__assign(a.__assign({},e),((t={})[n]=i,t))}))}}))):i.createElement(i.Fragment,null,i.createElement("div",{key:n,className:"input-row my-1"},i.createElement("label",{className:"text-capitalize"},t),i.createElement("br",null),i.createElement("input",{type:"text",name:"edit-md-".concat(n),id:"edit-md-".concat(n),placeholder:r,required:!0,onChange:function(e){var t=e.target,n=t.name,i=t.value;return s((function(e){var t;return a.__assign(a.__assign({},e),((t={})[n]=i,t))}))}})))}))):i.createElement(i.Fragment,null,e.fields.map((function(e,t){return"date"===e?i.createElement("div",{key:t,className:"input-row my-1"},i.createElement("label",{className:"text-capitalize"},"date"),i.createElement("br",null),i.createElement("input",{type:"checkbox",onChange:function(){return u(!m)}}),i.createElement("input",{type:"text",name:"edit-md-date",id:"edit-md-date",placeholder:"yyyy-mm-dd",disabled:m,required:!0,pattern:"{literal}[0-9]{4}-[0-9]{2}-[0-9]{2}{/literal}",onChange:function(e){var t=e.target,n=t.name,i=t.value;return s((function(e){var t;return a.__assign(a.__assign({},e),((t={})[n]=i,t))}))}})):i.createElement("div",{key:t})}))),i.createElement(r.ModalFooter,{className:"mt-2"},!y&&i.createElement(r.Button,{color:"secondary",onClick:function(){s(a.__assign(a.__assign({},n),{"edit-md-image-type":"ExplicitContent"})),f(a.__spreadArray(a.__spreadArray([],a.__read(g),!1),[{name:"image-type",value:"ExplicitContent",displayName:"Image Type"}],!1)),v(!0)}},"Add Explicit"),i.createElement(r.Button,{id:"submit-btn",color:"primary",onClick:function(){if(n){var t="";Object.entries(n).forEach((function(e){var n=a.__read(e,2),i=n[0],r=n[1];t+="".concat(i,"=").concat(r,"&")})),e.imageId?t+="imageId=".concat(e.imageId):t+="path=".concat(e.path),o.BrowseDao.saveMetadata(t).then((function(e){return e.data.saved?_("Metadata has been saved! Please allow up to 10 minutes to process the changes!"):_("Oops, an error occurred.")})).catch((function(e){return _("Oops, an error occurred. ".concat(e))}))}else _("Must enter new data into a field to save.")}},"Save"))):i.createElement(i.Fragment,null,i.createElement("h3",null,"Forbidden"),i.createElement("p",null,"You are not authorized to view this form."))}},251:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useContainerDimensions=void 0;var a=n(3),i=n(1);t.useContainerDimensions=function(e){var t=a.__read(i.useState({width:0,height:0}),2),n=t[0],r=t[1];return i.useEffect((function(){var t=function(){return{width:e&&e.current.offsetWidth||0,height:e&&e.current.offsetHeight||0}},n=function(){r(t())};return e.current&&r(t()),window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}),[e]),n}},353:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReasonCheckbox=t.ReportIssueModal=void 0;var a=n(3),i=n(1),r=n(5),o=n(262),s=function(e){function n(t){var n=e.call(this,t)||this;return n.reasons=new Map([["incorrectType","Is not an ".concat(n.props.articleType)],["incorrectArticleText","Contains text from another article"],["incorrectBox","The article box is not correctly placed"],["highNumIncorrectWords","Contains a high number of incorrect words"]]),n.state={open:!1,reported:!1,errorMessage:null,selectedCheckboxes:new Set},n}return a.__extends(n,e),n.prototype.toggleOpen=function(){this.setState({open:!this.state.open})},n.prototype.submitReport=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:if(!(this.state.selectedCheckboxes.size>0))return[3,5];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,o.ArticleDao.reportIssue(this.props.pageId,this.props.articleId,this.props.articleType,Array.from(this.state.selectedCheckboxes))];case 2:return e.sent(),this.setState({open:!1,reported:!0,errorMessage:null}),[3,4];case 3:return e.sent(),this.setState({errorMessage:"An error occurred while submitting your feedback."}),[3,4];case 4:return[3,6];case 5:this.setState({errorMessage:"Please select at least one reason for reporting this article."}),e.label=6;case 6:return[2]}}))}))},n.prototype.handleChange=function(e){var t=this.state.selectedCheckboxes;t.has(e)?t.delete(e):t.add(e),this.setState({selectedCheckboxes:t,errorMessage:null})},n.prototype.render=function(){var e=this;return i.createElement(i.Fragment,null,this.state.reported?i.createElement("span",{className:"icon-news icon-check text-success yft"},"Thanks! Article reported."):i.createElement("button",{type:"button",className:"btn btn-link btn-sm p-0 border-0 align-baseline m-0",onClick:this.toggleOpen.bind(this)},"Report issue"),this.state.open&&i.createElement(r.Modal,{isOpen:this.state.open},i.createElement(r.ModalHeader,null,"Report this article"),i.createElement(r.ModalBody,null,i.createElement(r.Row,null,i.createElement(r.Col,null,i.createElement(r.FormGroup,{tag:"fieldset",className:"mx-0"},Array.from(this.reasons.entries()).map((function(n,a){return i.createElement(t.ReasonCheckbox,{key:a,label:n[1],checked:e.state.selectedCheckboxes.has(n[0]),handleChange:e.handleChange.bind(e,n[0])})}))),this.state.errorMessage&&i.createElement("p",{className:"error"},this.state.errorMessage),i.createElement("p",null,"The data you provide helps improve Newspapers.com obituary search. Because we rely on computer learning to find and select articles, errors are expected as we train the article engine. ",i.createElement("strong",null,"Your feedback is helpful."))))),i.createElement(r.ModalFooter,null,i.createElement(r.Button,{color:"t",onClick:this.toggleOpen.bind(this)},"Cancel"),i.createElement(r.Button,{color:"p",disabled:!(this.state.selectedCheckboxes.size>0),onClick:this.submitReport.bind(this)},"Send"))))},n}(i.Component);t.ReportIssueModal=s;t.ReasonCheckbox=function(e){return i.createElement(r.FormGroup,{check:!0},i.createElement(r.Label,{check:!0},i.createElement(r.Input,{type:"checkbox",checked:e.checked,onChange:e.handleChange}),e.label))}},42:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignInStore=t.SignInContext=void 0;var a=n(3),i=n(8),r=n(15),o=n(43),s=n(1);n(24).polyfill(),t.SignInContext=s.createContext(null);var l=function(){function e(e){this.ncom=e,this.id=e.user,this.setInitialState(),this.refreshUserData(!1)}return e.prototype.setCredentialTypePreference=function(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,o.setItem("credential_type",e)];case 1:return[2,t.sent()]}}))}))},e.prototype.getCredentialTypePreference=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n,i;return a.__generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),e=new URLSearchParams(window.document.location.search),t=e.get("type"),[4,o.getItem("credential_type")];case 1:return n=a.sent(),i=document.referrer,n===t||"newspapers"!==t&&"ancestry"!==t?[3,3]:[4,this.setCredentialTypePreference(t)];case 2:return a.sent(),[2,t];case 3:return!i||-1===i.indexOf(".ancestrydev.com")&&-1===i.indexOf(".ancestrystage.com")&&-1===i.indexOf(".ancestry.com")&&-1===i.indexOf(".ancestry.co.uk")&&-1===i.indexOf(".ancestry.com.au")&&-1===i.indexOf(".ancestry.ca")&&-1===i.indexOf(".ancestry.fr")&&-1===i.indexOf(".ancestry.de")?[3,5]:[4,this.setCredentialTypePreference("ancestry")];case 4:return a.sent(),[2,"ancestry"];case 5:return[2,"ancestry"===n?n:"newspapers"];case 6:return a.sent(),[2,"newspapers"];case 7:return[2]}}))}))},e.prototype.setInitialState=function(){return a.__awaiter(this,void 0,void 0,(function(){var e;return a.__generator(this,(function(t){switch(t.label){case 0:return this.credential_username="",this.tpaData=this.ncom.tpa,this.visible_login=!1,this.tpa_dropdown_visible=!1,this.memberinfo_dropdown_visible=!1,this.modal_footer_visible=!0,this.newspapersSignInLabel=1===this.ncom.product.id||this.ncom.product.open?"Newspapers.com":"".concat(this.ncom.product.name," Archive"),this.activity="",this.mode="SIGNIN",this.next_page=null,e=this,[4,this.getCredentialTypePreference()];case 1:return e.credential_type=t.sent(),[2]}}))}))},e.prototype.loadUserData=function(e){null!=e?(this.id=e.id,this.name=e.username,this.subscriptionDuration=e.subDuration,this.subscriptionType=e.subType,this.confirmed=e.confirmed,this.eligibleForFreeTrial=e.eligibleFT,this.email=e.email,this.type="non-subscriber"===e.subType||0===e.subType.length?"Registered":"Subscriber"):(this.id=0,this.name="",this.type="")},e.prototype.refreshUserData=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t;return a.__generator(this,(function(n){switch(n.label){case 0:return[4,r.AccountDao.getUserData()];case 1:return t=n.sent(),e?(null!==this.ncom.user&&t.id!==this.ncom.user||null==this.ncom.user&&t.id>0)&&window.location.reload():this.loadUserData(t),[2]}}))}))},e.prototype.setIsModalFooterVisible=function(e){this.modal_footer_visible=e},e.prototype.onSignIn=function(){this.visible_login=!1,"billing"===this.next_page?window.location.href="".concat(this.ncom.paths.site,"/account/billing/").concat(window.location.search):"REGISTER"===this.mode&&"registration_confirmation"===this.next_page?window.location.href="".concat(this.ncom.paths.site,"/register/confirmation/").concat(window.location.search):"REGISTER"===this.mode&&this.onRegister?this.onRegister():window.location.reload()},e.prototype.setNextPage=function(e){this.next_page=e},e.prototype.signout=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return[4,r.AccountDao.signout()];case 1:return e.sent(),o.config({name:"newspapers-search-v2",storeName:"newspapers_search_v2",version:1}),o.clear(),window.location.reload(),[2]}}))}))},e.prototype.setCredentialUsername=function(e){this.credential_username=e},e.prototype.setIsVisibleLogin=function(e){this.visible_login=e},e.prototype.setTpaDropdownVisible=function(e){this.tpa_dropdown_visible=e},e.prototype.setMemberinfoDropdownVisible=function(e){this.memberinfo_dropdown_visible=e},e.prototype.setActivity=function(e){this.activity=e},e.prototype.setMode=function(e){this.mode=e},e.prototype.setCredentialType=function(e){this.credential_type=e,this.setCredentialTypePreference(e)},e.prototype.setModalClose=function(e){this.onClose=e},e.prototype.setOnRegister=function(e){this.onRegister=e},e.prototype.onModalClose=function(){this.onClose&&this.onClose()},a.__decorate([i.observable],e.prototype,"id",void 0),a.__decorate([i.observable],e.prototype,"name",void 0),a.__decorate([i.observable],e.prototype,"type",void 0),a.__decorate([i.observable],e.prototype,"subscriptionDuration",void 0),a.__decorate([i.observable],e.prototype,"subscriptionType",void 0),a.__decorate([i.observable],e.prototype,"confirmed",void 0),a.__decorate([i.observable],e.prototype,"eligibleForFreeTrial",void 0),a.__decorate([i.observable],e.prototype,"email",void 0),a.__decorate([i.observable],e.prototype,"memberinfo_dropdown_visible",void 0),a.__decorate([i.observable],e.prototype,"tpa_dropdown_visible",void 0),a.__decorate([i.observable],e.prototype,"tpaData",void 0),a.__decorate([i.observable],e.prototype,"mode",void 0),a.__decorate([i.observable],e.prototype,"credential_username",void 0),a.__decorate([i.observable],e.prototype,"credential_type",void 0),a.__decorate([i.observable],e.prototype,"newspapersSignInLabel",void 0),a.__decorate([i.observable],e.prototype,"visible_login",void 0),a.__decorate([i.observable],e.prototype,"modal_footer_visible",void 0),a.__decorate([i.observable],e.prototype,"activity",void 0),a.__decorate([i.action],e.prototype,"setInitialState",null),a.__decorate([i.action],e.prototype,"loadUserData",null),a.__decorate([i.action],e.prototype,"refreshUserData",null),a.__decorate([i.action],e.prototype,"setIsModalFooterVisible",null),a.__decorate([i.action],e.prototype,"onSignIn",null),a.__decorate([i.action],e.prototype,"setNextPage",null),a.__decorate([i.action],e.prototype,"signout",null),a.__decorate([i.action],e.prototype,"setCredentialUsername",null),a.__decorate([i.action],e.prototype,"setIsVisibleLogin",null),a.__decorate([i.action],e.prototype,"setTpaDropdownVisible",null),a.__decorate([i.action],e.prototype,"setMemberinfoDropdownVisible",null),a.__decorate([i.action],e.prototype,"setActivity",null),a.__decorate([i.action],e.prototype,"setMode",null),a.__decorate([i.action],e.prototype,"setCredentialType",null),e}();t.SignInStore=l},44:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignInForm=void 0;var a=n(3),i=n(1),r=n(6),o=n(8),s=n(48),l=n(7),c=n(37),p=n(85),d=n(47),m=n(13),u=n(51),h=n(100),g=n(5),f=n(15),b=n(31),y=n(21);n(24).polyfill();var v=function(e){function t(t){var n,a,i=this;return(i=e.call(this,t)||this).state={terms:"gb"!==(null===(n=null===ncom||void 0===ncom?void 0:ncom.country_code)||void 0===n?void 0:n.toLowerCase()),marketing:"gb"!==(null===(a=null===ncom||void 0===ncom?void 0:ncom.country_code)||void 0===a?void 0:a.toLowerCase())},i.credential_password="",i.credential_password_strength={isValid:!1,score:0,msg:[]},i.is_credential_username_available=!1,i.is_credential_password_visible=!0,i.is_credential_password_plain_text=!1,i.facebookDao=new p.FacebookDao,i.link_third_party="none",i.link_step=null,i.login_error_level="danger",i.login_has_error=!1,i.login_error_message="",i.ancestry_usernames=[],i.ancestry_user_id="",i.facebook_id="",i.facebook_name="",i.facebook_access_token="",i.csrf_token="",i.register_options_visible=!0,i.is_ancestry_signing_in=!1,i.is_facebook_signing_in=!1,i.is_registering=!1,i}return a.__extends(t,e),t.prototype.isCredentialUsernameAnEmail=function(){return/^\w+([\.\+-]*\w+)*@\w+([\.\+-]*\w+)*(\.\w{2,6})+$/.test(this.props.signinStore.credential_username)},t.prototype.hasCredentials=function(){return this.props.signinStore.credential_username&&this.credential_password},t.prototype.generateRandomPassword=function(){this.credential_password=(0,d.getRandomPassword)()},t.prototype.setupLinkMode=function(e){this.props.signinStore.setMode(e.status),this.link_third_party=e.third_party,this.setLoginError({visible:!1}),"UNLINKED"===this.props.signinStore.mode?this.setLoginError({visible:!0,message:i.createElement(i.Fragment,null,i.createElement("strong",{className:"icon-warn"},"We found an existing ",this.props.signinStore.newspapersSignInLabel," account associated with this email."),i.createElement("br",null),"Sign in below with your ",i.createElement("strong",null,this.props.signinStore.newspapersSignInLabel," credentials")," to link your ",this.link_third_party," account—after your accounts are connected you can sign in using either account."),level:"warning"}):"NOT_FOUND"===this.props.signinStore.mode&&this.setLoginError({visible:!0,message:i.createElement(i.Fragment,null,i.createElement("strong",null,"Your ",this.link_third_party," account")," has not been linked to ",this.props.signinStore.newspapersSignInLabel,". You can create a ",this.props.signinStore.newspapersSignInLabel," account now, and it will be linked to your ",i.createElement("span",{className:"text-capitalize"},this.link_third_party)," account."),level:"none"}),this.clearCredentials(),this.props.signinStore.setCredentialType("newspapers"),this.is_credential_password_visible=!1,e.third_party_email?(this.props.signinStore.credential_username=e.third_party_email,this.is_credential_username_visible=!1):this.is_credential_username_visible=!0,e.ancestry_user_id&&(this.ancestry_user_id=e.ancestry_user_id),e.ncom_user&&(this.props.signinStore.credential_username=e.ncom_user.email,this.props.signinStore.credential_type="newspapers"),e.csrf_token&&(this.csrf_token=e.csrf_token.token)},t.prototype.checkEmailAvailability=function(){return a.__awaiter(this,void 0,void 0,(function(){var e;return a.__generator(this,(function(t){switch(t.label){case 0:return e=this,[4,f.AccountDao.checkEmailAvailability(this.props.signinStore.credential_username)];case 1:return e.is_credential_username_available=t.sent(),this.is_credential_username_available?this.setLoginError({visible:!1}):(this.credential_password="","REGISTER"===this.props.signinStore.mode?this.setLoginError({visible:!0,message:i.createElement(i.Fragment,null,"An account already exists for this email. Need help? ",i.createElement("a",{href:"/signin/?un=".concat(this.props.signinStore.credential_username)},"Sign in")," or ",i.createElement("a",{href:"/forgotpwd.php?un=".concat(this.props.signinStore.credential_username)},"recover your password"),"."),level:"warning"}):(this.link_step="signin",this.setLoginError({visible:!0,message:i.createElement(i.Fragment,null,"An account already exists for this email. Sign in below with your ",i.createElement("strong",null,this.props.signinStore.newspapersSignInLabel," credentials")," to link your ",i.createElement("span",{className:"text-capitalize"},this.link_third_party)," account—after your accounts are connected you can sign in using either account."),level:"warning"}))),[2,this.is_credential_username_available]}}))}))},t.prototype.register=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n,r=this;return a.__generator(this,(function(a){switch(a.label){case 0:return ncom.country.isEEA&&!this.state.terms?[2]:this.hasCredentials()&&this.isCredentialUsernameAnEmail()?this.credential_password.length<8?(this.setLoginError({visible:!0,message:i.createElement(i.Fragment,null,"Password must be at least 8 characters long")}),[2]):(this.setIsLoading(!0,!1),this.is_registering=!0,[4,this.checkEmailAvailability()]):(this.setLoginError({visible:!0,message:i.createElement("div",{className:"icon-warn"},"Missing email or password")}),[2]);case 1:if(!a.sent())return this.setIsLoading(!1,!1),[2];e="REGISTER"!==this.props.signinStore.mode,a.label=2;case 2:return a.trys.push([2,9,,10]),[4,h.RecaptchaDao.getToken("register")];case 3:return t=a.sent(),[4,f.AccountDao.register(this.props.signinStore.credential_username,this.credential_password,t,e,this.ancestry_user_id,this.facebook_id,this.facebook_access_token)];case 4:if(!((n=a.sent()).id>0))throw new Error("Account not created");a.label=5;case 5:if(a.trys.push([5,7,,8]),e&&!n.linked)throw new Error("Account was not linked");return this.props.signinStore.onSignIn(),[4,f.AccountDao.updateUserProperties({marketingemail:this.state.marketing})];case 6:return a.sent(),[3,8];case 7:return a.sent(),this.setLoginError({visible:!0,message:i.createElement(i.Fragment,null,"An account was created with email: ",this.props.signinStore.credential_username,". However, we were unable to link your ",this.props.signinStore.newspapersSignInLabel," account to ",this.link_third_party,". For your convenience, a password reset email has been sent. ",i.createElement("a",{href:"javascript:void(0)",onClick:function(){r.props.signinStore.onSignIn()}},"Continue to ",this.props.signinStore.newspapersSignInLabel,"."))}),[3,8];case 8:try{(0,y.sendRegistrationCompleteEvent)(this.ancestry_user_id?"ancestry":this.facebook_id?"facebook":"email","success"),dataLayer.push({event:"ncom_register",product:ncom.product.subdomain,register_destination:this.props.signinStore.next_page}),(0,b.sendEvent)("register",this.props.signinStore.next_page,ncom.product.subdomain)}catch(e){console.error(e)}return[3,10];case 9:return a.sent(),this.setLoginError({visible:!0,message:i.createElement("div",{className:"icon-error"},"Unable to create new account.")}),this.setIsLoading(!1,!1),[3,10];case 10:return[2]}}))}))},t.prototype.authenticate=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n,r;return a.__generator(this,(function(a){switch(a.label){case 0:if(!this.hasCredentials())return this.setLoginError({visible:!0,message:i.createElement("div",{className:"icon-error"},"Missing email or password"),level:"danger"}),[2];this.setLoginError({visible:!1}),this.setIsLoading(!0,!1),e=!1,a.label=1;case 1:return a.trys.push([1,4,,5]),[4,h.RecaptchaDao.getToken("signin")];case 2:return t=a.sent(),[4,c.UserAuthDao.authenticate(this.props.signinStore.credential_username,this.credential_password,t)];case 3:return e=a.sent(),[3,5];case 4:return n=a.sent(),r=i.createElement("div",{className:"icon-error"},"There is a problem with your email/password. ",i.createElement("a",{href:"/forgotpwd.php"},"Forgot your password?")),n&&n.response&&401!==n.response.status&&(r=n.response.data&&n.response.data.message?n.response.data.message:i.createElement("div",{className:"icon-error"},"There was a problem with signing in. Please try again.")),this.setCredentialPassword(""),this.setLoginError({visible:!0,message:r}),(0,y.sendLoginEvent)("email","failed"),[3,5];case 5:return!e||"SIGNIN"!==this.props.signinStore.mode&&"REGISTER"!==this.props.signinStore.mode?!e||"UNLINKED"!==this.props.signinStore.mode&&"NOT_FOUND"!==this.props.signinStore.mode?this.setIsLoading(!1,!1):this.linkThirdParty():((0,y.sendLoginEvent)("email","success"),this.props.signinStore.onSignIn()),[2]}}))}))},t.prototype.linkThirdParty=function(){return a.__awaiter(this,void 0,void 0,(function(){var e;return a.__generator(this,(function(t){switch(t.label){case 0:e=!1,t.label=1;case 1:return t.trys.push([1,6,,7]),"ancestry"===this.link_third_party&&this.ancestry_user_id?[4,c.UserAuthDao.linkAncestry(this.ancestry_user_id,this.csrf_token)]:[3,3];case 2:return e=t.sent(),[3,5];case 3:return"facebook"===this.link_third_party&&this.facebook_access_token?[4,c.UserAuthDao.linkFacebook(this.facebook_id,this.facebook_access_token,this.csrf_token)]:[3,5];case 4:e=t.sent(),t.label=5;case 5:return[3,7];case 6:return t.sent(),[3,7];case 7:return e?this.props.signinStore.onSignIn():"none"!=this.link_third_party&&this.setLoginError({visible:!0,message:"Unable to connect your ".concat(this.link_third_party," account")}),[2]}}))}))},t.prototype.authenticateFacebook=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n,i;return a.__generator(this,(function(a){switch(a.label){case 0:this.setIsLoading(!0,!0),e=!1,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,c.UserAuthDao.authenticateFacebook(this.facebook_id,this.facebook_access_token)];case 2:return(t=a.sent()).linked?(e=!0,(0,y.sendLoginEvent)("facebook","success")):(this.setupLinkMode(t),(0,y.sendRegistrationInitiatedEvent)("facebook","email verification")),[3,4];case 3:return n=a.sent(),(0,y.sendLoginEvent)("facebook","failed"),i="There is a problem with your facebook account.",n&&n.response&&401!==n.response.status&&(i=n.response.data&&n.response.data.message?n.response.data.message:i),this.setLoginError({visible:!0,message:i}),[3,4];case 4:return!e||"SIGNIN"!==this.props.signinStore.mode&&"REGISTER"!==this.props.signinStore.mode?this.setIsLoading(!1,!0):(this.clearCredentials(),this.props.signinStore.onSignIn()),[2]}}))}))},t.prototype.clearCredentials=function(){this.props.signinStore.setCredentialUsername(""),this.setCredentialPassword(""),this.is_credential_password_plain_text=!1},t.prototype.setCredentialPassword=function(e){this.credential_password=e},t.prototype.setIsLoading=function(e,t){t?this.is_facebook_signing_in=e:this.is_credential_signing_in=e},t.prototype.setLoginError=function(e){this.login_has_error=e.visible,this.login_error_message=e.message?e.message:i.createElement(i.Fragment,null),this.login_error_level=e.level?e.level:"danger"},t.prototype.facebookLogout=function(){this.facebook_id="",this.facebook_access_token="",this.facebook_name="",this.facebook_email="",this.facebook_has_signed_in=!1,this.facebookDao.logout()},t.prototype.setLinkStep=function(e){this.link_step=e,this.props.signinStore.setIsModalFooterVisible("register"!==e)},t.prototype.setRegisterVisibleOptions=function(e){this.register_options_visible=e,e&&this.clearCredentials()},t.prototype.setIsCredentialPasswordPlainText=function(e){this.is_credential_password_plain_text=e},t.prototype.setCredentialPasswordStrength=function(){return a.__awaiter(this,void 0,void 0,(function(){var e;return a.__generator(this,(function(t){switch(t.label){case 0:return e=this,[4,(0,d.getPasswordStrengthScore)(this.credential_password)];case 1:return e.credential_password_strength=t.sent(),[2]}}))}))},t.prototype.onBlurEmail=function(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return("REGISTER"===this.props.signinStore.mode&&"newspapers"===this.props.signinStore.credential_type||"NOT_FOUND"===this.props.signinStore.mode&&"register"===this.link_step)&&this.isCredentialUsernameAnEmail()?[4,this.checkEmailAvailability()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.onChangeEmail=function(e){this.props.signinStore.setCredentialUsername(e.target.value)},t.prototype.onChangePassword=function(e){var t=this;this.setCredentialPassword(e.target.value),("REGISTER"===this.props.signinStore.mode||"NOT_FOUND"===this.props.signinStore.mode&&"register"===this.link_step)&&(this.typingTimeout&&clearTimeout(this.typingTimeout),this.typingTimeout=setTimeout((function(){t.setCredentialPasswordStrength()}),1e3))},t.prototype.onClickSubmit=function(e){e.preventDefault(),this.authenticate()},t.prototype.onAncestryLogin=function(e){e.linked?this.props.signinStore.onSignIn():(this.setupLinkMode(e),(0,y.sendRegistrationInitiatedEvent)("ancestry","email verification"))},t.prototype.onAncestryCancel=function(){this.is_ancestry_signing_in=!1},t.prototype.onAncestryClick=function(){this.is_ancestry_signing_in=!0,this.props.signinStore.setCredentialType("ancestry")},t.prototype.onFacebookLogin=function(e,t,n){e&&(this.facebook_id=n.user.id,this.facebook_access_token=n.authResponse.accessToken,this.facebook_name=n.user.name,this.facebook_email=n.user.email,this.facebook_has_signed_in=!0),e&&t&&this.authenticateFacebook()},t.prototype.onFacebookLogout=function(e){e.stopPropagation(),this.facebookLogout()},t.prototype.onToggleCredentialType=function(e){this.props.signinStore.setCredentialType("ancestry"===this.props.signinStore.credential_type?"newspapers":"ancestry")},t.prototype.onKeyUp=function(e){e.preventDefault(),"Enter"===e.key&&("NOT_FOUND"===this.props.signinStore.mode&&"register"===this.link_step||"REGISTER"===this.props.signinStore.mode&&"newspapers"===this.props.signinStore.credential_type?this.register():("SIGNIN"===this.props.signinStore.mode&&"newspapers"===this.props.signinStore.credential_type||"UNLINKED"===this.props.signinStore.mode||"NOT_FOUND"===this.props.signinStore.mode&&"signin"===this.link_step)&&this.authenticate())},t.prototype.selectUsername=function(e){this.props.signinStore.setCredentialUsername(e),this.authenticate()},t.prototype.setConnectStep=function(e){this.setLoginError({visible:!1}),this.setLinkStep(e),"signin"===e?(this.setCredentialPassword(""),this.setLoginError({visible:!0,message:i.createElement(i.Fragment,null,i.createElement("strong",null,"Sign in below with your ",this.props.signinStore.newspapersSignInLabel," credentials")," to link your ",this.link_third_party," account—after your accounts are connected you can sign in using either account."),level:"none"})):"register"===e?(this.generateRandomPassword(),this.setLoginError({visible:!0,message:i.createElement(i.Fragment,null,i.createElement("strong",null,"To continue, ",this.props.signinStore.newspapersSignInLabel)," will use your ",i.createElement("span",{className:"text-capitalize"},this.link_third_party)," account information to create an account."),level:"none"})):null===e&&this.setLoginError({visible:!0,message:i.createElement(i.Fragment,null,i.createElement("strong",null,"Your ",i.createElement("span",{className:"text-capitalize"},this.link_third_party)," account has not been linked to ",this.props.signinStore.newspapersSignInLabel,".")," You can create a ",this.props.signinStore.newspapersSignInLabel," account now, and it will be linked to your ",i.createElement("span",{className:"text-capitalize"},this.link_third_party)," account."),level:"none"})},t.prototype.onRegisterOptionChoice=function(e){this.setRegisterVisibleOptions(!1),this.props.signinStore.setCredentialType(e),(0,y.sendRegistrationInitiatedEvent)("email","email verification")},t.prototype.onChangeHandler=function(e){var t;this.setState(((t={})[e.target.name]=e.target.checked,t))},t.prototype.render=function(){var e,t,n,a=this,r=this.props,o=!0,c=!0,p=!1,h=!1,f=!0,b=!1;return"SIGNIN"===this.props.signinStore.mode&&"ancestry"===this.props.signinStore.credential_type?(o=!1,c=!1):"NOT_FOUND"===this.props.signinStore.mode&&null==this.link_step?(o=!1,c=!1,f=!1):"NOT_FOUND"===this.props.signinStore.mode&&"register"===this.link_step?(f=!1,b=!0,c=this.is_credential_password_visible,o=this.is_credential_username_visible,h=this.credential_password.length>0):"REGISTER"===this.props.signinStore.mode&&this.register_options_visible?(o=!1,c=!1,f=!1):"REGISTER"!==this.props.signinStore.mode||this.register_options_visible||"newspapers"!==this.props.signinStore.credential_type||(f=!1,b=!0,p=!0,h=this.credential_password.length>0),i.createElement(g.Container,{fluid:!0,onKeyUp:this.onKeyUp.bind(this)},r.showTitle&&i.createElement(g.Row,null,i.createElement(g.Col,{className:"text-center",sm:12},i.createElement("h1",{className:"clr1 mb-3 h5"},"Sign in ","newspapers"===this.props.signinStore.credential_type?" to ".concat(this.props.signinStore.newspapersSignInLabel):"using your Ancestry account"))),i.createElement(l.NewsAlert,{visible:this.login_has_error,color:this.login_error_level,message:this.login_error_message}),"NOT_FOUND"===this.props.signinStore.mode&&null===this.link_step&&i.createElement(i.Fragment,null,i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7",className:"text-center"},i.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return a.setConnectStep("register")}},"Create ",this.props.signinStore.newspapersSignInLabel," Account"))),i.createElement("p",{className:"alert"},i.createElement("strong",null,"If you already have a ",i.createElement("span",null,this.props.signinStore.newspapersSignInLabel)," account"),", please sign in to connect to your ",i.createElement("span",{className:"text-capitalize"},this.link_third_party)," account."),i.createElement(g.FormGroup,null,i.createElement(g.Col,{className:"text-center col-12"},i.createElement("button",{type:"button",className:"btn btn-link",onClick:function(){return a.setConnectStep("signin")}},i.createElement("strong",null,"Connect using existing ",this.props.signinStore.newspapersSignInLabel," account"))))),o&&i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7"},"REGISTER"===this.props.signinStore.mode&&!this.register_options_visible&&"newspapers"===this.props.signinStore.credential_type&&i.createElement("h2",{className:"text-center mt-3 text-muted h5"},"Create your account"),i.createElement("label",{htmlFor:"username",className:"sr-only"},"Enter your Email"),i.createElement(g.Input,{type:"email",name:"username",id:"username",formNoValidate:!0,maxLength:128,tabIndex:21,placeholder:"Enter your email",onBlur:this.onBlurEmail.bind(this),onChange:this.onChangeEmail.bind(this),value:this.props.signinStore.credential_username}))),c&&i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7"},i.createElement("label",{htmlFor:"password",className:"sr-only"},"Enter password"),i.createElement(g.Input,{type:this.is_credential_password_plain_text?"text":"password",name:"password",id:"password",tabIndex:22,placeholder:"Password",onChange:this.onChangePassword.bind(this),value:this.credential_password}),"SIGNIN"===this.props.signinStore.mode&&i.createElement("p",{className:"m-0"},i.createElement("small",null,i.createElement("a",{href:"/forgotpwd.php".concat(this.props.signinStore.credential_username?"?un="+this.props.signinStore.credential_username:""),className:"text-muted"},"Forgot your password?"))))),p&&i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7"},i.createElement(l.Checkbox,{name:"Show Password",checked:this.is_credential_password_plain_text,onChange:function(e){a.setIsCredentialPasswordPlainText(e.target.checked)}}),h&&i.createElement(d.PasswordStrength,{strength:this.credential_password_strength}))),f&&i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7"},"newspapers"===this.props.signinStore.credential_type?i.createElement(l.SignInButton,{tabIndex:23,register:"REGISTER"===this.props.signinStore.mode,showIcon:!0,newspapersSignInLabel:this.props.signinStore.newspapersSignInLabel,link:"NOT_FOUND"===this.props.signinStore.mode||"UNLINKED"===this.props.signinStore.mode,site:this.props.signinStore.credential_type,onClick:this.onClickSubmit.bind(this),isSigningIn:this.is_credential_signing_in,disabled:this.is_credential_signing_in}):i.createElement(u.AncestryLogin,{onAuthenticated:this.onAncestryLogin.bind(this),onCancel:this.onAncestryCancel.bind(this),onClick:this.onAncestryClick.bind(this)},i.createElement("button",{type:"button",tabIndex:24,className:"btn icon-news btn-si acom-btn icon-acom"},i.createElement("span",null,this.is_ancestry_signing_in?"Signing in...":"Sign in with Ancestry"))),"REGISTER"!==this.props.signinStore.mode&&"signin"===this.link_step&&!this.is_credential_signing_in&&i.createElement("a",{tabIndex:0,href:"#",onClick:function(){return a.setConnectStep(null)},className:"btn-link btn mt-2"},"Go back"),"REGISTER"===this.props.signinStore.mode&&!this.is_credential_signing_in&&i.createElement("a",{tabIndex:0,href:"#",onClick:function(){return a.setRegisterVisibleOptions(!0)},className:"btn-link btn mt-2"},"Go back"))),b&&i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:12,md:8},i.createElement(l.TermsAndConditions,{buttonText:"REGISTER"===this.props.signinStore.mode?"Register":"Save and Continue",ancestryTermsAndConditionsUrl:this.props.signinStore.ncom.ancestry.termsAndConditionsUrl,ancestryPrivacyStatementUrl:this.props.signinStore.ncom.ancestry.privacyStatementUrl,terms:null===(e=this.state)||void 0===e?void 0:e.terms,marketing:null===(t=this.state)||void 0===t?void 0:t.marketing,isAmerica:!(null===(n=null===ncom||void 0===ncom?void 0:ncom.country)||void 0===n?void 0:n.isEEA),onChangeHandler:this.onChangeHandler.bind(this)}))),"NOT_FOUND"===this.props.signinStore.mode&&"register"===this.link_step&&i.createElement(i.Fragment,null,i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:"11",className:"text-center"},i.createElement(l.NewsButton,{className:"icon-news icon-lock",color:"primary",onClick:this.register.bind(this),disabledLabel:"Saving...",disabled:this.is_credential_signing_in},"Save & Continue")," ",!this.is_credential_signing_in&&"NOT_FOUND"===this.props.signinStore.mode&&i.createElement("a",{href:"#",tabIndex:25,onClick:function(){return a.setConnectStep(null)},className:"btn-link btn"},"Go back")))),"SIGNIN"===this.props.signinStore.mode&&i.createElement(i.Fragment,null,i.createElement(g.Row,{className:"justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7",className:"text-center text-muted mb-2"},"-OR-")),i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7"},"ancestry"===this.props.signinStore.credential_type&&i.createElement(l.SignInButton,{tabIndex:24,register:!1,showIcon:!0,newspapersSignInLabel:this.props.signinStore.newspapersSignInLabel,link:!1,site:"newspapers",onClick:this.onToggleCredentialType.bind(this),isSigningIn:!1,disabled:this.is_credential_signing_in}),"newspapers"===this.props.signinStore.credential_type&&i.createElement(u.AncestryLogin,{onAuthenticated:this.onAncestryLogin.bind(this),onCancel:this.onAncestryCancel.bind(this),onClick:this.onAncestryClick.bind(this)},i.createElement("button",{tabIndex:24,className:"btn icon-news btn-si acom-btn icon-acom"},i.createElement("span",null,this.is_ancestry_signing_in?"Signing in...":"Sign in with Ancestry"))))),!this.props.signinStore.ncom.country.isEEA&&i.createElement(m.ErrorBoundary,{FallbackComponent:l.FallbackBlank},i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7",className:"text-center"},i.createElement(s.FacebookLogin,{onLogin:this.onFacebookLogin.bind(this),onError:this.setLoginError.bind(this),disabled:this.is_credential_signing_in},i.createElement("div",{className:(this.facebook_has_signed_in?"react-fbsignedin":"react-fbsignedout")+(this.is_credential_signing_in?" disabledbtn":"mx-auto")},i.createElement("a",{tabIndex:25,className:"fb-signin-btn"},i.createElement("span",null),this.is_facebook_signing_in?"Signing in...":"Sign in with Facebook"),this.facebook_has_signed_in&&i.createElement("p",{className:"text-muted"},i.createElement("span",{className:"react-fbsignedin-notuser"}," (",i.createElement("a",{href:"#",onClick:this.onFacebookLogout.bind(this)},"Not ",this.facebook_name,"? Click Here"),")")))))))),"REGISTER"===this.props.signinStore.mode&&!this.register_options_visible&&"newspapers"===this.props.signinStore.credential_type&&i.createElement(i.Fragment,null,i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7"},i.createElement(l.NewsButton,{"data-cy":"register-btn",className:"icon-news icon-lock",color:"primary",onClick:this.register.bind(this),disabledLabel:this.is_credential_signing_in?"Saving...":"Register",disabled:this.is_credential_signing_in||!(this.credential_password_strength.isValid&&this.props.signinStore.credential_username.length>0)||!this.state.terms},"Register")," ",!this.is_credential_signing_in&&i.createElement("a",{href:"#",onClick:function(){return a.setRegisterVisibleOptions(!0)},className:"btn-link btn"},"Go back")))),"REGISTER"===this.props.signinStore.mode&&this.register_options_visible&&i.createElement(i.Fragment,null,i.createElement("p",{className:"text-muted text-center mt-2"},"Choose one of the following options below:"),i.createElement(g.FormGroup,{row:!0,className:"mt-2 justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7",className:"text-center"},i.createElement(l.SignInButton,{tabIndex:24,register:!0,"data-cy":"sign-in-btn",showIcon:!1,newspapersSignInLabel:this.props.signinStore.newspapersSignInLabel,link:!1,site:"newspapers",onClick:function(){a.onRegisterOptionChoice("newspapers")},isSigningIn:!1,disabled:this.is_credential_signing_in}))),i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7",className:"text-center"},i.createElement(u.AncestryLogin,{onAuthenticated:this.onAncestryLogin.bind(this),onCancel:this.onAncestryCancel.bind(this),onClick:this.onAncestryClick.bind(this)},i.createElement("button",{type:"button",tabIndex:24,"data-cy":"acom-sign-in-btn",className:"btn icon-news btn-si acom-btn icon-acom"},i.createElement("span",null,this.is_ancestry_signing_in?"Signing in...":"Continue with Ancestry"))))),!this.props.signinStore.ncom.country.isEEA&&i.createElement(m.ErrorBoundary,{FallbackComponent:l.FallbackBlank},i.createElement(g.FormGroup,{row:!0,className:"justify-content-center"},i.createElement(g.Col,{xs:"12",sm:"8",lg:"7",className:"text-center"},i.createElement(s.FacebookLogin,{onLogin:this.onFacebookLogin.bind(this),onError:this.setLoginError.bind(this),disabled:this.is_credential_signing_in},i.createElement("div",{className:(this.facebook_has_signed_in?"react-fbsignedin":"react-fbsignedout")+(this.is_credential_signing_in?" disabledbtn":"")},i.createElement("button",{type:"button",tabIndex:25,className:"fb-signin-btn mx-auto"},i.createElement("span",null),this.is_facebook_signing_in?"Signing in...":"Continue with Facebook"),this.facebook_has_signed_in&&i.createElement("p",{className:"text-muted"},i.createElement("span",{className:"react-fbsignedin-notuser"}," (",i.createElement("a",{href:"#",onClick:this.onFacebookLogout.bind(this)},"Not ",this.facebook_name,"? Click Here"),")")))))))),"REGISTER"===this.props.signinStore.mode&&"billing"===this.props.signinStore.next_page&&i.createElement("div",{className:"text-muted text-center"},"Step 1 of 2"),("REGISTER"===this.props.signinStore.mode&&!this.register_options_visible||"NOT_FOUND"===this.props.signinStore.mode&&"register"===this.link_step)&&this.is_registering&&i.createElement("img",{height:"1",width:"1",src:"https://trk.lockerdome.com/ldpix.gif?ldc=8299429950130945_newspapers_lead"}))},a.__decorate([o.observable],t.prototype,"link_step",void 0),a.__decorate([o.observable],t.prototype,"register_options_visible",void 0),a.__decorate([o.observable],t.prototype,"ancestry_usernames",void 0),a.__decorate([o.observable],t.prototype,"ancestry_user_id",void 0),a.__decorate([o.observable],t.prototype,"link_third_party",void 0),a.__decorate([o.observable],t.prototype,"is_credential_username_visible",void 0),a.__decorate([o.observable],t.prototype,"is_credential_username_available",void 0),a.__decorate([o.observable],t.prototype,"credential_password",void 0),a.__decorate([o.observable],t.prototype,"credential_password_strength",void 0),a.__decorate([o.observable],t.prototype,"is_credential_password_visible",void 0),a.__decorate([o.observable],t.prototype,"is_credential_password_plain_text",void 0),a.__decorate([o.observable],t.prototype,"is_credential_signing_in",void 0),a.__decorate([o.observable],t.prototype,"is_facebook_signing_in",void 0),a.__decorate([o.observable],t.prototype,"is_ancestry_signing_in",void 0),a.__decorate([o.observable],t.prototype,"login_has_error",void 0),a.__decorate([o.observable],t.prototype,"login_error_message",void 0),a.__decorate([o.observable],t.prototype,"login_error_level",void 0),a.__decorate([o.observable],t.prototype,"facebook_has_signed_in",void 0),a.__decorate([o.observable],t.prototype,"facebook_id",void 0),a.__decorate([o.observable],t.prototype,"facebook_name",void 0),a.__decorate([o.observable],t.prototype,"facebook_email",void 0),a.__decorate([o.observable],t.prototype,"facebook_access_token",void 0),a.__decorate([o.observable],t.prototype,"csrf_token",void 0),a.__decorate([o.observable],t.prototype,"is_registering",void 0),a.__decorate([o.action],t.prototype,"generateRandomPassword",null),a.__decorate([o.action],t.prototype,"setupLinkMode",null),a.__decorate([o.action],t.prototype,"checkEmailAvailability",null),a.__decorate([o.action],t.prototype,"register",null),a.__decorate([o.action],t.prototype,"authenticate",null),a.__decorate([o.action],t.prototype,"linkThirdParty",null),a.__decorate([o.action],t.prototype,"authenticateFacebook",null),a.__decorate([o.action],t.prototype,"clearCredentials",null),a.__decorate([o.action],t.prototype,"setCredentialPassword",null),a.__decorate([o.action],t.prototype,"setIsLoading",null),a.__decorate([o.action],t.prototype,"setLoginError",null),a.__decorate([o.action],t.prototype,"facebookLogout",null),a.__decorate([o.action],t.prototype,"setLinkStep",null),a.__decorate([o.action],t.prototype,"setRegisterVisibleOptions",null),a.__decorate([o.action],t.prototype,"setIsCredentialPasswordPlainText",null),a.__decorate([o.action],t.prototype,"setCredentialPasswordStrength",null),a.__decorate([o.action],t.prototype,"onAncestryCancel",null),a.__decorate([o.action],t.prototype,"onAncestryClick",null),t=a.__decorate([r.observer],t)}(i.Component);t.SignInForm=v},47:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PasswordStrength=t.getPasswordStrengthScore=t.getRandomPassword=void 0;var a=n(3),i=n(1),r=n(37);function o(e){for(var t="abcdefghijklmnopqrstuvwxyz!@#$%^&*()-+<>ABCDEFGHIJKLMNOP1234567890",n="",a=0;a<e;a++){var i=Math.floor(Math.random()*t.length);n+=t.charAt(i)}return n}function s(e){return!!/.{8,}/.test(e)&&(!!/\d/.test(e)&&!!/[^0-9]/.test(e))}t.getRandomPassword=function(){var e="",t=0;do{e=o(20),t++}while(!1===s(e)||t<100);return e},t.getPasswordStrengthScore=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n,i;return a.__generator(this,(function(a){switch(a.label){case 0:if(t=[],n=0,/.{8,}/.test(e)||t.push("Must be at least 8 characters"),/\d/.test(e)||t.push("Must contain at least 1 number"),/[^0-9]/.test(e)||t.push("Must contain at least 1 letter or special character"),0===t.length&&(n=1),0===n)return[2,{isValid:!1,score:n,msg:t}];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,r.UserAuthDao.validatePassword(e)];case 2:return(i=a.sent()).FailureReasonCode&&(t=i.FailureReasonCode.map((function(e){return i.FailureReasonCode_locale[e].LocaleString}))),[2,{isValid:i.IsValid,score:i.ComplexityScore,msg:t}];case 3:return a.sent(),[2,{isValid:!0,score:1,msg:t}];case 4:return[2]}}))}))};t.PasswordStrength=function(e){var t=0;e.strength.isValid&&(t=e.strength.score>0?e.strength.score:1);var n="score_".concat(t);return 0===e.strength.msg.length&&e.strength.score>=0?null:i.createElement("div",{id:"field-tool",className:"field-tool small"},i.createElement("div",{id:"pwd_msg",className:n},i.createElement("span",{className:"score_0 text-danger"},0===e.strength.score&&0===e.strength.msg.length?"Checking your password strength...":"Your password: ",i.createElement("ul",null,e.strength.msg.length>0&&e.strength.msg.map((function(e,t){return i.createElement("li",{key:"pw_strength_error_".concat(t)},e)}))))))}},48:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FacebookLogin=void 0;var a=n(3),i=n(1),r=n(6),o=function(e){function t(t){var n=e.call(this,t)||this;return n.initializeFacebookLogin=function(){window.FB&&(n.setState({facebook_setup_failed:!1}),n.FB=window.FB,n.checkLoginStatus())},n.checkLoginStatus=function(){n.FB.getLoginStatus(n.facebookLoginHandler)},n.facebookLogin=function(){if(!n.props.disabled){if(n.userClicked=!0,window.FB&&!n.FB&&n.initializeFacebookLogin(),!n.FB)return n.setState({facebook_setup_failed:!0}),void n.props.onError({visible:!0,level:"warning",message:"Facebook failed to load. Check your Content Blocking or Cookie Consent settings."});n.FB.getLoginStatus((function(e){"connected"===e.status?n.facebookLoginHandler(e):n.FB.login(n.facebookLoginHandler.bind(n),{scope:"public_profile,email"})}))}},n.facebookLoginHandler=function(e){var t=n.userClicked;"connected"===e.status?n.FB.api("/me",{fields:"name,email"},(function(i){var r=a.__assign(a.__assign({},e),{user:i});n.props.onLogin(!0,t,r)})):n.props.onLogin(!1,t),n.userClicked=!1},n.state={facebook_setup_failed:!1},n.userClicked=!1,n.initializeFacebookLogin(),n}return a.__extends(t,e),t.prototype.componentDidMount=function(){document.addEventListener("FBObjectReady",this.initializeFacebookLogin)},t.prototype.componentWillUnmount=function(){document.removeEventListener("FBObjectReady",this.initializeFacebookLogin)},t.prototype.render=function(){var e=this.props.children;return i.createElement("div",{onClick:this.facebookLogin.bind(this),role:"button",className:"text-center"},!this.state.facebook_setup_failed&&e)},t=a.__decorate([r.observer],t)}(i.Component);t.FacebookLogin=o},5:function(e,t){e.exports=Reactstrap},50:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignInModal=void 0;var a=n(3),i=n(1),r=n(6),o=n(7),s=n(44),l=n(5),c=function(e){function t(t){return e.call(this,t)||this}return a.__extends(t,e),t.prototype.onClickClose=function(e){this.props.signinStore.setIsVisibleLogin(!this.props.signinStore.visible_login),this.props.signinStore.setInitialState(),this.props.signinStore.onModalClose()},t.prototype.onClickSignUp=function(e){e.preventDefault(),this.props.signinStore.setMode("REGISTER"),this.props.signinStore.setCredentialType("newspapers")},t.prototype.onClickSignIn=function(e){e.preventDefault(),this.props.signinStore.setMode("SIGNIN"),this.props.signinStore.setCredentialType("newspapers")},t.prototype.getHeader=function(){var e="Sign in ".concat("newspapers"===this.props.signinStore.credential_type?"to ".concat(this.props.signinStore.newspapersSignInLabel):"using your Ancestry account"," ").concat(this.props.signinStore.activity);return"REGISTER"===this.props.signinStore.mode&&(e="Register with ".concat(this.props.signinStore.newspapersSignInLabel," ").concat(this.props.signinStore.activity)),e},t.prototype.getFooter=function(){return"REGISTER"===this.props.signinStore.mode?i.createElement("p",{className:"help-block text-center m-0"},"Already have a ",this.props.signinStore.newspapersSignInLabel," account? ",i.createElement("a",{href:"/signin/",onClick:this.onClickSignIn.bind(this)},i.createElement("b",null,"Sign In"))):i.createElement(i.Fragment,null,i.createElement("p",{className:"help-block text-center m-0"},"Don’t have a ",this.props.signinStore.newspapersSignInLabel," account? ",i.createElement("a",{href:"/choose-a-plan/",onClick:this.onClickSignUp.bind(this)},i.createElement("b",null,"Register"))))},t.prototype.render=function(){return i.createElement(o.NewsModal,{id:"SignInModal",visible:this.props.signinStore.visible_login,header:this.getHeader(),footer:this.props.signinStore.modal_footer_visible&&i.createElement(l.Col,{sm:12},this.getFooter()),close:this.onClickClose.bind(this)},i.createElement(s.SignInForm,{signinStore:this.props.signinStore,showTitle:!1}))},t=a.__decorate([r.observer],t)}(i.Component);t.SignInModal=c},51:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AncestryLogin=void 0;var a=n(3),i=n(1),r=n(6),o=n(55);try{(0,o.stringStartsWith)()}catch(e){}var s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return a.__extends(t,e),t.prototype.getAncestrySSOUrl=function(){return"".concat(ncom.paths.site,"/auth/ancestry?state=").concat(document.location.hostname.startsWith("go.")?"go":ncom.product.subdomain)},t.prototype.getWindowSpecs=function(){var e={width:500,height:550,centerscreen:!0,chrome:!0,dialog:!0,alwaysRaised:!0},t=function(e,t){var n=[];for(var a in e)n.push(["".concat(a,"=").concat(e[a])]);return n.join(t)}(e,","),n=null!=window.screenLeft?window.screenLeft:screen.left,a=null!=window.screenTop?window.screenTop:screen.top,i=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,r=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,o=i/2-e.width/2+n,s=r/2-e.height/2+a;return"".concat(t,",left=").concat(o,",top=").concat(s)},t.prototype.ancestryLogin=function(e){var t=this,n=window.open(this.getAncestrySSOUrl(),"Ancestry Sign in",this.getWindowSpecs()),a=setInterval((function(){n.closed&&(clearInterval(a),t.props.onCancel())}),1e3);window.addEventListener("message",(function(e){(-1!==document.location.hostname.indexOf(ncom.cookieDomain.www)&&-1!==e.origin.indexOf(ncom.cookieDomain.www)||e.origin===document.location.origin)&&"linked"in e.data&&(t.props.onAuthenticated(e.data),n.close())})),"function"==typeof this.props.onClick&&this.props.onClick(e)},t.prototype.render=function(){return i.createElement("div",{onClick:this.ancestryLogin.bind(this)},this.props.children)},t=a.__decorate([r.observer],t)}(i.Component);t.AncestryLogin=s},52:function(e,t){e.exports=d3},53:function(e,t){e.exports=ReactDOM},56:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClipPublication=t.ClipImageSearch=t.ClipImage=t.StatelessClipping=t.SearchStatelessClipping=t.HomeStatelessClipping=void 0;var a=n(1),i=n(88),r=n(20),o=n(62),s=n(7),l=n(13),c=n(63),p=n(5);t.HomeStatelessClipping=function(e){var n=e.clipping,i=e.onClick,r=e.onClickSTA,l="/clip/".concat(n.clipping_id,"/").concat(n.title?(0,s.getUrlTitle)(n.title,40):(0,s.getUrlTitle)(n.publication.name,40),"/"),c="/paper/".concat(n.publication.name);return a.createElement(p.Row,{className:"py-3 border-bottom"},a.createElement(p.Col,{md:5},a.createElement("a",{href:l},a.createElement(t.ClipImageSearch,{clipping:n}))),a.createElement(p.Col,{md:7,className:"d-flex flex-column justify-content-center"},a.createElement("h5",{"data-cy":"clipping-title",className:"card-title h6 mb-0"},a.createElement("a",{href:l,className:n.title?"text-secondary2":"text-muted font-italic"},n.title?n.title.slice(0,120):"Untitled clipping")),a.createElement("div",{className:"card-text","data-cy":"clipping-text"},a.createElement(t.ClipPublication,{visible:n.page_title!=o.Page.NEWSPAGE&&n.page_title!=o.Page.TITLE,publicationId:n.page_publication_id,publicationName:n.publication.name,publicationLocation:n.publication.location,onClick:function(){return location.href=c}}),a.createElement(d,{visible:n.page_title!==o.Page.NEWSPAGE,date:n.page_date,pageNumber:n.page_title})),a.createElement("div",{className:"flex-row align-items-center mt-2"},a.createElement("a",{role:"button",onClick:r,className:"save-to-ancestry rounded-pill text-light text-decoration-none small px-2 mr-1 border-0"},a.createElement("span",{className:"icon-news icon-acom align-middle","aria-hidden":"true"}),"Save To Ancestry"),a.createElement("a",{role:"button",onClick:i,className:"save-to-ancestry bg-primary rounded-pill text-decoration-none text-light small px-2 border-0"},a.createElement("span",{className:"icon-news icon-share align-middle","aria-hidden":"true"}),"Share"))))};t.SearchStatelessClipping=function(e){var n=e.user&&e.clipping.user_id===e.user,r=e.clipping,p="clipping_"+r.clipping_id,m="/clip/".concat(r.clipping_id,"/").concat(r.title?(0,s.getUrlTitle)(r.title,40):(0,s.getUrlTitle)(r.publication.name,40),"/");return a.createElement("div",{className:"card ml-0".concat(e.glow?" glowfade":""),id:p},a.createElement("div",{className:"row no-gutters"},a.createElement("div",{"data-cy":"clipping-img",className:"card-img-wrap ".concat(e.fullWidth?"col-12":"col-5"," col-md-4")},a.createElement("a",{href:m,onClick:e.onClick,className:"card-img-link d-block text-center text-sm-left m-md-2 "},a.createElement(t.ClipImageSearch,{clipping:r})),a.createElement("div",{"data-cy":"clip-icon",className:"icon-news icon-clip position-absolute clip-noted m-sm-2 m-1 rounded text-muted",title:"Clipping"})),a.createElement("div",{className:"".concat(e.fullWidth?"col-12":"col-7"," col-md-8 ")},a.createElement("div",{className:"card-body p-3"},a.createElement("h5",{"data-cy":"clipping-title",className:"card-title h6"},a.createElement("a",{href:m,onClick:e.onClick,className:"text-secondary2"},(0,c.highlight)(r.title.slice(0,120),e.searchKeyword))),a.createElement("div",{className:"card-text","data-cy":"clipping-text"},a.createElement(t.ClipPublication,{visible:e.pageName!=o.Page.NEWSPAGE&&e.pageName!=o.Page.TITLE,publicationId:r.page_publication_id,publicationName:r.publication.name,publicationLocation:r.publication.location,onClick:e.onClick}),a.createElement(d,{visible:e.pageName!==o.Page.NEWSPAGE,date:r.page_date,pageNumber:r.page_title})),a.createElement("div",{className:"clipTagWrap"},a.createElement("span",{className:"clipTagBorder"}),a.createElement(b,{tags:e.clipping.tags,onClick:e.onClickTag})),e.searchKeyword&&!(0,c.hasHighlight)(r.title,e.searchKeyword)&&a.createElement("span",{className:"ocr-match icon-news icon-view clip-util-icon h5 align-middle",title:"Match found in clipping text"}),a.createElement("div",{className:"clip-info px-3 py-0"},a.createElement(u,{visible:e.displayAuthor,userId:r.user_id,userName:r.user_username,onClick:e.onClickAuthor}),e.displayEdited&&r.createdUTC&&r.modifiedUTC&&r.createdUTC.length>0&&r.modifiedUTC.length>0&&a.createElement(g,{createdUTC:r.createdUTC,modifiedUTC:r.modifiedUTC}))),a.createElement(l.ErrorBoundary,{FallbackComponent:s.FallbackOops},null!=e.reclipClipping&&null!=e.onUpdate&&null!=e.onClickShare&&null!=e.onDelete&&a.createElement("div",{className:"card-footer clip-actions px-3 pt-1 pb-0"},!n&&!e.clipping.page_archived&&e.user&&a.createElement(i.ClippingModal,{id:"modal-clipping-reclip-".concat(e.reclipClipping.clipping_id),title:"Reclip",icon:"clip",clipping:e.reclipClipping,onCreate:e.onCreate,mode:"create"}),n&&a.createElement(i.ClippingModal,{id:"modal-clipping-edit-".concat(e.clipping.clipping_id),title:"Edit",icon:"edit",clipping:e.clipping,onUpdate:e.onUpdate,onDelete:e.onDelete,mode:"update"}),a.createElement(h,{visible:!r.is_public}),a.createElement(s.Icon,{visible:!e.clipping.page_archived&&e.clipping.is_public,icon:"share",title:"Share",onClick:e.onClickShare}))))))};t.StatelessClipping=function(e){var n=e.user&&e.clipping.user_id===e.user,r=e.clipping,p="clipping_"+r.clipping_id,m="/clip/".concat(r.clipping_id,"/").concat(r.title?(0,s.getUrlTitle)(r.title,40):(0,s.getUrlTitle)(r.publication.name,40),"/");return a.createElement("div",{className:"card h-100".concat(e.glow?" glowfade":""),id:p},a.createElement("div",{className:"card-img-wrap ".concat(e.fullWidth?"":"col-5 col-md-4")},a.createElement("a",{href:m,onClick:e.onClick,className:"card-img-link bg-light"},a.createElement(t.ClipImage,{clipping:r}))),a.createElement("div",{className:"card-body px-2 pt-2 pb-1 d-flex flex-column"},e.searchKeyword&&!(0,c.hasHighlight)(r.title,e.searchKeyword)&&a.createElement("span",{className:"ocr-match icon-news icon-view clip-util-icon",title:"Match found in clipping text"}),r.title&&a.createElement("h5",{className:"card-title h6"},a.createElement("a",{href:m,onClick:e.onClick,className:"text-secondary2"},(0,c.highlight)(r.title.slice(0,120),e.searchKeyword))),!r.title&&n&&a.createElement("h5",{"data-cy":"clipping-title",className:"card-title h6 mb-1"},a.createElement(i.ClippingModal,{id:"modal-clipping-edit-".concat(e.clipping.clipping_id),title:"Edit",clipping:e.clipping,onUpdate:e.onUpdate,onDelete:e.onDelete,mode:"update"})),a.createElement("div",{"data-cy":"clipping-text",className:"card-text"},a.createElement(t.ClipPublication,{visible:e.pageName!=o.Page.NEWSPAGE&&e.pageName!=o.Page.TITLE,publicationId:r.page_publication_id,publicationName:r.publication.name,publicationLocation:r.publication.location,onClick:e.onClick}),a.createElement(d,{visible:e.pageName!==o.Page.NEWSPAGE,date:r.page_date,pageNumber:r.page_title})),a.createElement("div",{className:"clipTagWrap"},a.createElement("span",{className:"clipTagBorder"}),a.createElement(b,{tags:e.clipping.tags,onClick:e.onClickTag})),a.createElement("div",{className:"text-small mt-auto pt-3"},!n&&a.createElement(u,{visible:e.displayAuthor,userId:r.user_id,userName:r.user_username,onClick:e.onClickAuthor}),r.createdUTC&&r.modifiedUTC&&r.createdUTC.length>0&&r.modifiedUTC.length>0&&a.createElement(g,{createdUTC:r.createdUTC,modifiedUTC:r.modifiedUTC}))),a.createElement("div",{className:"card-footer d-flex justify-content-center bg-white clip-info px-2 py-0 text-small"},a.createElement(l.ErrorBoundary,{FallbackComponent:s.FallbackOops},null!=e.reclipClipping&&null!=e.onUpdate&&null!=e.onClickShare&&null!=e.onDelete&&a.createElement("div",{className:"clip-actions ml-auto text-muted h5 my-0"},!n&&!e.clipping.page_archived&&e.user&&a.createElement(i.ClippingModal,{id:"modal-clipping-reclip-".concat(e.reclipClipping.clipping_id),title:"Reclip",icon:"clip p-1 text-muted btn-outline-light border-0",clipping:e.reclipClipping,onCreate:e.onCreate,mode:"create"}),n&&a.createElement(i.ClippingModal,{id:"modal-clipping-edit-".concat(e.clipping.clipping_id),title:"Edit",icon:"edit p-1 text-muted btn-outline-light border-0",clipping:e.clipping,onUpdate:e.onUpdate,onDelete:e.onDelete,mode:"update"}),a.createElement(s.Icon,{"data-cy":"clipping-share",visible:!e.clipping.page_archived,onClick:e.onClickShare,icon:"share p-1 text-muted btn-outline-light border-0",title:"Share"}),a.createElement(h,{visible:!r.is_public})))))};t.ClipImage=function(e){return a.createElement("img",{className:"card-img-top bg-secondary",src:(0,s.getThumbnailUrl)(ncom.paths.image,e.clipping.page_id,{rect:e.clipping.rectangle,cache:ncom.user&&e.clipping.user_id===ncom.user}),alt:"".concat(e.clipping.title?e.clipping.title:"Clipping from this paper- id:"+e.clipping.page_id)})};t.ClipImageSearch=function(e){return a.createElement("img",{className:"img-fluid rounded bg-secondary",src:(0,s.getThumbnailUrl)(ncom.paths.image,e.clipping.page_id,{rect:e.clipping.rectangle,cache:ncom.user&&e.clipping.user_id===ncom.user}),alt:"".concat(e.clipping.title?e.clipping.title:"Clipping from this paper- id:"+e.clipping.page_id)})};t.ClipPublication=function(e){if(!e.visible)return null;var t="/paper/".concat((0,s.getUrlTitle)(e.publicationName,45),"/").concat(e.publicationId,"/");return a.createElement("div",{className:"text-small"},a.createElement("div",{"data-cy":"publication-title",className:"disc-info-title text-muted"},a.createElement("a",{className:"disc-info-link",href:t,title:e.publicationName,onClick:e.onClick},e.publicationName)),a.createElement("div",{className:"disc-info text-muted"},e.publicationLocation))};var d=function(e){if(!e.visible)return null;var t=(0,r.format)((0,r.parseISO)(e.date),"EEE, MMM dd, yyyy");return a.createElement("div",{className:"disc-info text-muted text-small"},t," · Page ",e.pageNumber.replace(/page/i,""))},m=function(e){var t="/usericon.php?id="+e.userId+"&user="+(ncom.user?ncom.user:0)+"&institution="+(ncom.institution?ncom.institution.id:-1)+"&size=30";return a.createElement("img",{src:t,alt:"",className:"float-left mr-2 my-1 rounded"})},u=function(e){return e.visible?a.createElement("button",{className:"author btn btn-link p-0",role:"button",onClick:e.onClick},a.createElement(m,{userId:e.userId,userName:e.userName}),a.createElement("small",null,e.userName)):null},h=function(e){return e.visible?a.createElement("span",{className:"clip-private",title:"Private: Other members won't see this clipping."},a.createElement("span",{className:"icon-news icon-lock","aria-hidden":"true"})):null},g=function(e){return e.modifiedUTC!==e.createdUTC?a.createElement("div",{className:"text-muted"},"Edited ",y(e.modifiedUTC)):a.createElement("div",{className:"text-muted"},"Clipped ",y(e.createdUTC))},f=function(e){var t="";switch(e.value){case"obituary":t="icon-obit";break;case"marriage":t="icon-marriage"}return a.createElement(p.Button,{className:"badge badge-pill badge-secondary text-muted icon-news ".concat(t," tag mr-1"),onClick:function(){e.onClick&&e.onClick(e.value)}},e.value)},b=function(e){return null==e.tags?null:a.createElement(a.Fragment,null,e.tags.split(",").map((function(t,n){return a.createElement(f,{value:t,key:n,onClick:e.onClick})})))},y=function(e){var t=(0,r.parseISO)(e);return(0,r.differenceInDays)(new Date,t)>1?(0,r.format)(t,"dd MMM yyyy"):(0,r.formatDistanceToNow)(t,{addSuffix:!0})}},578:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),i=n(1),r=n(83),o=n(19),s=n(42),l=n(54),c=n(90),p=n(49),d=n(22),m=n(583),u=n(608),h=n(609),g=n(610),f=n(110),b=n(86),y=n(611),v=n(5),_=n(7),E=n(612),w=n(613),C=n(13),S=n(614),N=new s.SignInStore(ncom),x=(0,o.observer)((function(e){var t,n,r,o,s,b,x,k,P,I=i.useContext(c.ViewerContext),M=i.useRef(null),D=a.__read(i.useState(window.innerWidth),2),T=D[0],O=D[1],A=a.__read(i.useState(window.innerHeight-56),2),F=A[0],L=A[1],R=a.__read(i.useState(0),2),B=R[0],V=R[1],z=a.__read(i.useState(0),2),G=z[0],U=z[1];return i.useEffect((function(){I.initializeViewer(M.current,{height:F,width:T}),I.loadImage(I.page.id,!1),I.initializeShortcuts(),I.initializePopState()}),[]),i.useEffect((function(){var e,t=function(){clearTimeout(e),e=setTimeout((function(){O(window.innerWidth),L(window.innerHeight-56),U(0),V(0),I.viewer&&I.viewer.setZoom(I.zoom)}),300)};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[]),i.useEffect((function(){I.viewer&&I.viewer.resize({width:T,height:F})}),[T,F]),i.useEffect((function(){I.viewer&&I.updateViewer({height:F,width:T})}),[I.thumbnail,I.fullResolutionLayerImageTiles,I.hasLoadedTile,I.imageLayer,I.articles,I.clippings,I.focus,I.selectedSegment,I.editSegment,I.hits,I.selectedHit,I.overlappingSegments,I.imageSettings,I.highlightSegment,I.waitForSegmentOrHitBeforeLoadingTiles,I.ocr]),i.createElement(d.BrowserRouter,null,i.createElement(d.Routes,null,i.createElement(d.Route,{path:"/image/*",element:i.createElement(p.RedwoodBase,{ncom:ncom,signinStore:N,activeHeaderLink:"",hideAll:I.hideNavigationHeader,onChangeNavcheck:function(e){e||I.toggleNavigationHeader(!1)},minimal:!0,hideFooter:!0},i.createElement(C.ErrorBoundary,{FallbackComponent:_.FallbackOops},i.createElement(E.HeaderBar,null)),I.alert&&i.createElement(v.Alert,{style:{zIndex:2e3,top:"56px"},color:I.alert.color,className:"text-center"},I.alert.message,i.createElement(_.CloseButton,{onClick:function(e){I.setAlert(null)}})),i.createElement("div",{id:"viewer",style:{top:I.alert?106:56,bottom:G,left:B,right:0},ref:M},null===I.editSegment&&i.createElement("div",{className:"d-none d-md-block shadow information-pane-tab position-absolute".concat(I.showInformationPane?" opened":"")},i.createElement("button",{type:"button",className:"btn btn-white px-1 py-3 icon-news rounded-0 icon-chevron".concat(I.showInformationPane?"-left":""),"aria-label":I.showInformationPane?"Hide sidebar":"Show sidebar",onClick:function(){0===I.informationPaneLayers.length?I.addInformationPaneLayer("default"):I.setShowInformationPane(!I.showInformationPane)}})),i.createElement(C.ErrorBoundary,{FallbackComponent:_.FallbackOops},(null===(t=I.image)||void 0===t?void 0:t.canView)&&i.createElement(g.ViewerControls,null)),i.createElement(C.ErrorBoundary,{FallbackComponent:_.FallbackOops},(null===(n=I.image)||void 0===n?void 0:n.canView)&&null===I.editSegment&&!(null===(r=I.image)||void 0===r?void 0:r.archived)&&!(window.innerWidth<l.BREAKPOINT_MD&&I.informationPaneLayers.length)&&i.createElement(u.PaginationBar,null)),null!=I.shareClipping&&!(null===(o=I.image)||void 0===o?void 0:o.archived)&&!(null===(s=I.image)||void 0===s?void 0:s.explicit)&&i.createElement(f.ShareClipping,{id:I.shareClipping.clipping.clipping_id,clipping:I.shareClipping.clipping,setId:function(e){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(t){return I.setShareClipping(null),e>0&&I.setShareClippingById(e),[2]}))}))},updateClipping:function(e,t){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(n){switch(n.label){case 0:return[4,I.updateClipping(e,t,!1)];case 1:return n.sent(),I.setShareClipping(t),[2]}}))}))},sourceEmail:N.email?N.email:"",initialName:I.shareClipping.initialName})),i.createElement(C.ErrorBoundary,{FallbackComponent:_.FallbackOops},(null===(b=I.image)||void 0===b?void 0:b.canView)&&i.createElement(m.InformationPane,null)),i.createElement(C.ErrorBoundary,{FallbackComponent:_.FallbackOops},(null===(x=I.image)||void 0===x?void 0:x.canView)&&!(null===(k=I.image)||void 0===k?void 0:k.archived)&&i.createElement(h.PaginationPane,null)),i.createElement(C.ErrorBoundary,{FallbackComponent:_.FallbackBlank},i.createElement(y.SubscriptionDenyModal,{visible:I.showDeny,denies:I.deny?I.deny.subscriptionDeny:[],showOtherOptions:!!I.deny&&I.deny.showChooseAPlanLink,denyFromLocation:I.denyFromLocation,image:I.image})),i.createElement(C.ErrorBoundary,{FallbackComponent:_.FallbackBlank},i.createElement(S.ConfirmEmailModal,{visible:I.showConfirm,imageId:I.image.imageId})),i.createElement(C.ErrorBoundary,{FallbackComponent:_.FallbackBlank},(null===(P=I.image)||void 0===P?void 0:P.explicit)&&I.showExplicitWarningModal&&i.createElement(w.ExplicitWarningModal,{item:"page",onAllow:function(){I.setAllowExplicitImageLoading()},onDeny:function(){history.go(-1)}})))})))}));r.createRoot(document.getElementById("root")).render(i.createElement(b.NcomContext.Provider,{value:ncom},i.createElement(s.SignInContext.Provider,{value:N},i.createElement(c.ViewerContext.Provider,{value:new c.ViewerStore(ncom,N)},i.createElement(x,null)))))},579:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getImageUrl=t.getLayerImageUrls=void 0;function a(e,t,n,a,i,r,o,s){var l=i-o,c=r-a,p=Math.floor(o/s.zoom),d=Math.floor(a/s.zoom),m=Math.ceil(l/s.zoom),u=Math.ceil(c/s.zoom),h=[["id",s.page.toString()],["width",l.toString()],["height",c.toString()],["crop",[p,d,m,u].join(",")],["brightness",s.brightness.toString()],["contrast",s.contrast.toString()],["invert",s.invert?"1":"0"],["ts","1"],["cacheable","1"],["iat",s.iat]];return t&&h.push(["user",t.toString()]),n&&h.push(["institutionId",n.toString()]),"".concat(e,"/img/img?").concat(h.map((function(e){return e.join("=")})).join("&"))}t.getLayerImageUrls=function(e,t,n,i,r,o,s,l,c){var p=Math.round(i.height*r),d=Math.round(i.width*r),m=Math.ceil(d/384),u=Math.ceil(p/384),h=Array.apply(null,Array(m)).map((function(){})),g=Array.apply(null,Array(u)).map((function(){})),f={page:i.id,tileHeight:Math.ceil(p/u),tileWidth:Math.ceil(d/m),zoom:r,width:d,height:p,brightness:o,contrast:s,invert:l,iat:c},b=[];return g.forEach((function(i,o){h.forEach((function(i,s){var l=s*f.tileWidth,c=o*f.tileHeight,p=Math.min(l+f.tileWidth,f.width),d=Math.min(c+f.tileHeight,f.height),m=p-l+1,u=d-c+1;b.push({src:a(e,t,n,c,p,d,l,f),x:l,y:c,width:m,height:u,zoom:r})}))})),b},t.getImageUrl=a},580:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),i=n(52),r=n(8),o=n(32),s=n(54),l=function(e){switch(e.type){case"obituary":return"#b21a31";case"marriage":return"#d237b5";default:return e.selected?"#f4b62a":"#1e99e3"}},c=function(){function e(e,t,n,a){this.el=e,this.dimensions=t,this.props=n,this.handlers=a,this.transform=i.zoomIdentity;var r=t.width,o=t.height,s=this;this.allowViewportImageTileLoading=!1,this.zoom=i.zoom().scaleExtent([n.minZoom,n.maxZoom]).on("zoom",(function(){var e=i.event;s.viewer.attr("transform",e.transform),s.transform=e.transform,a.onZoom(e.transform.k),s.updateImageLayerZoom(e.transform.k),s.checkLoadTiles(),s.updatePropsZoom(e.transform.k),s.updateHeaderText(),s.updateSegments(),s.updateCropView()})).on("start",(function(){i.select("#svg-viewer").style("cursor","grabbing")})).on("end",(function(){i.select("#svg-viewer").style("cursor","grab")})),this.loading=i.select(e).append("div").attr("id","viewer-loading").attr("class","h-100 w-100 m-3 m-md-5 border border-dark bg-dark opacity-50 d-flex align-items-center justify-content-center position-absolute"),this.loading.append("div").attr("class","spinner-border text-secondary m-4").attr("role","status").append("span").attr("class","sr-only").text("Loading..."),this.svg=i.select(e).append("svg").attr("id","svg-viewer").attr("role","group").attr("aria-labelledby","paper-title page-ocr").attr("tabindex","0").attr("width",r).attr("height",o).style("cursor","grab").call(this.zoom).on("wheel.zoom",(function(){var e=i.event,t=Math.abs(e.deltaX),n=Math.abs(e.deltaY),a=i.zoomTransform(s.viewer);return i.event.ctrlKey?s.zoom.scaleBy(s.svg,a.k-.01*e.deltaY):t>n?s.zoom.translateBy(s.svg,2*-e.deltaX/a.k,0):t<n&&s.zoom.translateBy(s.svg,0,2*-e.deltaY/a.k),s.checkLoadTiles(),e.preventDefault&&e.preventDefault()})).on("keydown",(function(e){var t=i.event.keyCode,n=i.zoomTransform(s.viewer);37==t?s.zoom.translateBy(s.svg,30/n.k,0):39==t?s.zoom.translateBy(s.svg,-30/n.k,0):38==t?s.zoom.translateBy(s.svg,0,30/n.k):40==t&&s.zoom.translateBy(s.svg,0,-30/n.k),s.checkLoadTiles()})),this.title=this.svg.append("title"),this.ocr=this.svg.append("desc").attr("id","paper-desc"),this.viewer=this.svg.append("g"),this.header=this.viewer.append("g").attr("id","header"),this.thumbnailLayer=this.viewer.append("g").attr("id","thumbnail-layer").attr("role","presentation"),this.imageLayers=this.viewer.append("g").attr("id","image-layers").attr("role","img").attr("aria-label","Digital image of newspaper page"),this.activeImageLayer=null,this.activeImageLayerZoom=null,this.previousImageLayers=new Map,this.initializeImageLayers(),this.segmentLayer=this.viewer.append("g").attr("id","segment-layer").attr("aria-label","Toggle sidebar information").attr("role","button"),this.hitsLayer=this.viewer.append("g").attr("id","hits-layer").attr("role","mark"),this.maskLayer=this.viewer.append("g").attr("id","mask-layer").attr("role","presentation"),this.cropLayer=this.viewer.append("g").attr("id","crop-layer").attr("role","presentation"),this.buttonLayer=this.viewer.append("g").attr("id","button-layer").attr("aria-label","Close highlighted region").attr("role","button"),this.update(t,n)}return e.prototype.initializeImageLayers=function(){var e=this;[.25,.5,1].forEach((function(t){e.imageLayers.append("g").attr("id","image-layer-".concat(1/t)).attr("transform","scale(".concat(1/t,")")),e.previousImageLayers.set(t,"image-layer-".concat(1/t))}))},e.prototype.updatePropsZoom=function(e){var t=this.props;t.zoom=e,this.props=t},e.prototype.updateDimensions=function(e){this.dimensions=e},e.prototype.updateProps=function(e){this.props=e},e.prototype.updateHeaderText=function(){this.title.text(this.props.headerText);var e=this.header.selectAll("text").data([{display:this.props.headerText}]);e.exit().remove(),e.enter().append("text").merge(e).attr("x","0").attr("y","-50").text((function(e){return e.display})).attr("fill","white").attr("id","paper-title").style("font-size","4.5em")},e.prototype.updateOcr=function(){null===this.props.ocr?this.ocr.text("Loading"):this.ocr.text("The following text was pulled by a computer and may not be accurate. ".concat(this.props.ocr))},e.prototype.updateImages=function(){var e=this,t=this,n=this.props;if(n.thumbnail){var r=this.thumbnailLayer.selectAll("image").data([n.thumbnail]);r.exit().remove(),r.enter().append("image").merge(r).attr("x",0).attr("y",0).attr("width",(function(e){return e.width})).attr("height",(function(e){return e.height})).attr("href",(function(e){return e.href})).on("load",(function(){t.loading.remove()})).on("error",(function(){t.loading.remove()}))}if(this.props.tiles&&this.props.tiles.length>0){this.imageLayers.style("filter","contrast(".concat(100+this.props.tileImageSettings.contrast,"%) brightness(").concat(100+this.props.tileImageSettings.brightness,"%) invert(").concat(this.props.tileImageSettings.invert?"1":"0",")"));var o=this.props.tiles[0].zoom,s=this.props.tiles.map((function(t){return a.__assign(a.__assign({},t),{loaded:e.props.hasLoadedTile.has(t.src)})}));null!==this.activeImageLayerZoom&&this.activeImageLayerZoom===o||(this.previousImageLayers.set(this.activeImageLayerZoom,this.activeImageLayer),this.previousImageLayers.has(o)?(this.activeImageLayer=this.previousImageLayers.get(o),this.activeImageLayerZoom=o):this.activeImageLayer="image-layer-".concat(o),this.activeImageLayerZoom=o),i.select("#".concat(this.activeImageLayer)).selectAll("image").data(s).enter().append("image").attr("id",(function(e,t){return"l-".concat(1/e.zoom,"-t-").concat(t)})).attr("x",(function(e){return e.x})).attr("y",(function(e){return e.y})).attr("width",(function(e){return e.width})).attr("height",(function(e){return e.height})).on("click",(function(){t.handlers.onSegment(null,null)}))}},e.prototype.updateHits=function(){var e=this,t=this.hitsLayer.selectAll("rect").data(null!==this.props.hits.hits?this.props.hits.hits.map((function(t){var n=e.props.selectedHit;return a.__assign(a.__assign({},t),{selected:n.x===t.x&&n.y===t.y&&n.height===t.height&&n.width===t.width})})):[]);t.exit().remove(),t.enter().append("rect").merge(t).attr("x",(function(e){return e.x})).attr("y",(function(e){return e.y})).attr("width",(function(e){return e.width})).attr("height",(function(e){return e.height})).attr("class",(function(e){return"".concat(e.selected?"active":""," hit")}))},e.prototype.updateSegments=function(){var e=this,t=this;if(null!=this.props.articles&&null!=this.props.clippings){var n=this.props.articles.marriages.map((function(n){var a=n.id;return{id:a,rectangle:n.rectangle,type:"marriage",selected:e.props.selectedSegment&&a===e.props.selectedSegment.id,highlight:e.props.overlappingSegments&&e.props.overlappingSegments.marriages.has(n.id)||e.props.highlightSegment&&a===e.props.highlightSegment.id,zoom:t.props.zoom}})).concat(this.props.articles.obituaries.map((function(n){var a=n.id;return{id:a,rectangle:n.rectangle,type:"obituary",selected:e.props.selectedSegment&&a===e.props.selectedSegment.id,highlight:e.props.overlappingSegments&&e.props.overlappingSegments.obituaries.has(n.id)||e.props.highlightSegment&&a===e.props.highlightSegment.id,zoom:t.props.zoom}}))).concat(this.props.clippings.map((function(n){var a=n.clipping_id,i=n.rectangle;return{id:a.toString(),rectangle:i,type:"clipping",selected:e.props.selectedSegment&&a.toString()===e.props.selectedSegment.id,highlight:e.props.overlappingSegments&&e.props.overlappingSegments.clippings.has(n.clipping_id)||e.props.highlightSegment&&a.toString()===e.props.highlightSegment.id,zoom:t.props.zoom}})));this.props.focus&&(n=n.concat([this.props.focus].map((function(n){return{id:"focus",rectangle:n,type:"focus",selected:e.props.selectedSegment&&"focus"===e.props.selectedSegment.id,highlight:!1,zoom:t.props.zoom}}))));var r=this.segmentLayer.selectAll("rect").data(n);r.exit().remove(),r.enter().append("rect").attr("id",(function(e){return"s-".concat(e.id)})).merge(r).attr("x",(function(e){return e.rectangle.x})).attr("y",(function(e){return e.rectangle.y})).attr("width",(function(e){return e.rectangle.width})).attr("height",(function(e){return e.rectangle.height})).attr("fill","none").style("pointer-events","visible").style("cursor","zoom-in").style("stroke",(function(e){return l(e)})).style("stroke-width",(function(e){return e.selected||e.highlight?Math.floor(5/e.zoom):0})).on("click",(function(e){i.event.stopPropagation();var n=i.mouse(this);t.handlers.onSegment(e,{x:Math.floor(n[0]),y:Math.floor(n[1])})})).on("mouseover",(function(e){var n=i.select(this);t.props.selectedSegment||e.selected||e.highlight||(n.transition().duration(250).style("stroke-width",Math.floor(3/e.zoom)),t.updateMask(e))})).on("mouseout",(function(e){var n=i.select(this);t.props.selectedSegment||e.selected||e.highlight||(n.transition().duration(250).style("stroke-width",0),t.updateMask(null))}));var o=[];this.props.selectedSegment&&o.push(a.__assign(a.__assign({},this.props.selectedSegment),{selected:!0,zoom:this.props.zoom}));var s=this.buttonLayer.selectAll("g, rect, line").data(o);s.exit().remove();var c=function(e){return Math.ceil(28/e)},p=function(e){return Math.ceil(8/e)},d=function(e){return Math.floor(3/e)},m=this.props.selectedSegment;m&&"focus"!==m.type&&s.enter().append("g").merge(s).append("rect").attr("x",(function(e){return e.rectangle.x+e.rectangle.width})).attr("y",(function(e){return e.rectangle.y})).attr("width",(function(e){return c(e.zoom)})).attr("height",(function(e){return c(e.zoom)})).attr("fill",(function(e){return l(e)})).style("cursor","pointer").on("click",(function(){i.select("#s-".concat(m.id)).style("stroke-width",0),t.handlers.onSegment(null,null)})).select((function(){return this.parentNode})).append("line").attr("x1",(function(e){return e.rectangle.x+e.rectangle.width+p(e.zoom)})).attr("y1",(function(e){return e.rectangle.y+p(e.zoom)})).attr("x2",(function(e){return e.rectangle.x+e.rectangle.width+c(e.zoom)-p(e.zoom)})).attr("y2",(function(e){return e.rectangle.y+c(e.zoom)-p(e.zoom)})).on("click",(function(){i.select("#s-".concat(m.id)).style("stroke-width",0),t.handlers.onSegment(null,null)})).style("cursor","pointer").style("stroke","white").style("stroke-width",(function(e){return d(e.zoom)})).select((function(){return this.parentNode})).append("line").attr("x1",(function(e){return e.rectangle.x+e.rectangle.width+c(e.zoom)-p(e.zoom)})).attr("y1",(function(e){return e.rectangle.y+p(e.zoom)})).attr("x2",(function(e){return e.rectangle.x+e.rectangle.width+p(e.zoom)})).attr("y2",(function(e){return e.rectangle.y+c(e.zoom)-p(e.zoom)})).on("click",(function(){i.select("#s-".concat(m.id)).style("stroke-width",0),t.handlers.onSegment(null,null)})).style("cursor","pointer").style("stroke","white").style("stroke-width",(function(e){return d(e.zoom)})).select((function(){return this.parentNode}))}},e.prototype.updateCropView=function(){var e=this,t=i.drag().on("start",(function(){i.event.stopPropagation&&i.event.stopPropagation()})).on("drag",(function(){var t=i.event,n=(0,r.toJS)(e.props.editSegment),o=Math.max(0,Math.min(e.props.layer.width-n.rectangle.width,n.rectangle.x+Math.ceil(t.dx))),s=Math.max(0,Math.min(e.props.layer.height-n.rectangle.height,n.rectangle.y+Math.ceil(t.dy)));n.rectangle=a.__assign(a.__assign({},n.rectangle),{x:o,y:s}),e.handlers.onEditSegment(n)})),n=this.cropLayer.selectAll("rect").data(this.props.editSegment?[this.props.editSegment]:[]);n.exit().remove(),n.enter().append("rect").call(t).merge(n).attr("x",(function(e){return e.rectangle.x})).attr("y",(function(e){return e.rectangle.y})).attr("width",(function(e){return e.rectangle.width})).attr("height",(function(e){return e.rectangle.height})).attr("fill","none").style("pointer-events","visible").style("stroke-dasharray","10, 10").style("stroke","white").style("stroke-width",Math.floor(3/e.props.zoom)).style("cursor","move");var o=i.drag().on("start",(function(){i.event.stopPropagation&&i.event.stopPropagation()})).on("drag",(function(t){var n=i.event,a=(0,r.toJS)(e.props.editSegment),o=a.rectangle.x,s=a.rectangle.y,l=a.rectangle.x+a.rectangle.width,c=a.rectangle.y+a.rectangle.height;if("nw"==t.corner)o=Math.max(0,n.x),s=Math.max(0,n.y);else if("se"==t.corner)l=Math.min(n.x,e.props.layer.width),c=Math.min(n.y,e.props.layer.height);else if("ne"==t.corner){var p=Math.max(25,n.x-o),d=Math.max(25,c-n.y);o=Math.max(0,n.x)-p,s=Math.max(0,n.y),l=Math.min(n.x,e.props.layer.width),c=Math.min(n.y+d,e.props.layer.height)}else if("sw"==t.corner){p=Math.max(25,l-n.x),d=Math.max(25,n.y-s);o=Math.max(0,n.x),s=Math.max(0,n.y-d),l=Math.min(n.x+p,e.props.layer.width),c=Math.min(n.y,e.props.layer.height)}var m=Math.floor(60/e.props.zoom),u=Math.max(m,Math.min(e.props.layer.width,l-o)),h=Math.max(m,Math.min(e.props.layer.height,c-s)),g=Math.max(0,Math.min(e.props.layer.width-u,o)),f=Math.max(0,Math.min(e.props.layer.height-h,s));a.rectangle={x:g,y:f,width:u,height:h},e.handlers.onEditSegment(a)})),s=Math.ceil(24/this.props.zoom),l=this.cropLayer.selectAll("circle").data(this.props.editSegment?[{cx:this.props.editSegment.rectangle.x,cy:this.props.editSegment.rectangle.y,r:s,corner:"nw"},{cx:this.props.editSegment.rectangle.x+this.props.editSegment.rectangle.width,cy:this.props.editSegment.rectangle.y,r:s,corner:"ne"},{cx:this.props.editSegment.rectangle.x,cy:this.props.editSegment.rectangle.y+this.props.editSegment.rectangle.height,r:s,corner:"sw"},{cx:this.props.editSegment.rectangle.x+this.props.editSegment.rectangle.width,cy:this.props.editSegment.rectangle.y+this.props.editSegment.rectangle.height,r:s,corner:"se"}]:[]);l.exit().remove(),l.enter().append("circle").call(o).merge(l).attr("cx",(function(e){return e.cx})).attr("cy",(function(e){return e.cy})).attr("r",(function(e){return e.r})).attr("fill","#268cd8").style("pointer-events","visible").style("cursor",(function(e){return"".concat(e.corner,"-resize")})).style("opacity",.8).style("stroke","white").style("stroke-width",Math.floor(1/e.props.zoom))},e.prototype.updateMask=function(e){var t=this;if(e||this.props.editSegment||this.props.selectedSegment||this.props.highlightSegment){var n=e||this.props.editSegment||this.props.selectedSegment||this.props.highlightSegment,a=[{x:0,y:0,height:n.rectangle.y,width:this.props.layer.width},{x:n.rectangle.x+n.rectangle.width,y:n.rectangle.y,height:n.rectangle.height,width:this.props.layer.width-n.rectangle.width-n.rectangle.x},{x:0,y:n.rectangle.y+n.rectangle.height,height:this.props.layer.height-n.rectangle.height-n.rectangle.y,width:this.props.layer.width},{x:0,y:n.rectangle.y,height:n.rectangle.height,width:n.rectangle.x}],r=this.maskLayer.selectAll("rect").data(a);r.exit().remove(),r.enter().append("rect").merge(r).attr("x",(function(e){return e.x})).attr("y",(function(e){return e.y})).attr("width",(function(e){return e.width})).attr("height",(function(e){return e.height})).attr("fill","black").style("opacity",null!==this.props.selectedSegment&&"focus"===this.props.selectedSegment.type||e?.2:.5).on("click",(function(){null===t.props.editSegment&&(i.select("#s-".concat(n.id)).style("stroke-width",0),t.handlers.onSegment(null,null))}))}else this.maskLayer.selectAll("rect").remove()},e.prototype.position=function(){var e=this;this.allowViewportImageTileLoading=!1;var t=0,n=!0,a=this.props;if(this.zoom.scaleExtent([a.minZoom,a.maxZoom]),this.props.thumbnail){var i=1/a.zoom*500,r=1/a.zoom*a.translateExtentLeftPadding;this.zoom.translateExtent([[-r/2,-i/2],[a.thumbnail.width+i,a.thumbnail.height+i]])}this.props.selectedSegment?this.props.selectedSegment!==this.lastPositionedSegmentOrHit&&(t=500,this.positionToSegment(this.props.selectedSegment.rectangle,window.innerWidth>=s.BREAKPOINT_MD?.6:.8,t),this.lastPositionedSegmentOrHit=this.props.selectedSegment):this.props.selectedHit?this.props.selectedHit!==this.lastPositionedSegmentOrHit&&(t=500,this.positionToRectangle(this.props.selectedHit,.5,.9,t),this.lastPositionedSegmentOrHit=this.props.selectedHit):this.props.zoom!=this.transform.k?(t=250,this.zoom.scaleTo(this.svg.transition().duration(t),this.props.zoom),n=!1):n=!1,this.allowViewportImageTileLoading||setTimeout((function(){(!e.props.waitForSegmentOrHitBeforeLoadingTiles||e.props.waitForSegmentOrHitBeforeLoadingTiles&&n)&&(e.props.waitForSegmentOrHitBeforeLoadingTiles&&e.handlers.onClearWaitForSegmentOrHitBeforeLoadingTiles(),e.allowViewportImageTileLoading=!0,e.checkLoadTiles())}),t)},e.prototype.positionToRectangle=function(e,t,n,a){var r=e.x,o=e.y,l=e.x+e.width,c=e.y+e.height,p=Math.min(t,n/Math.max((l-r)/this.dimensions.width,(c-o)/this.dimensions.height));this.zoom.transform(this.svg.transition().duration(a),i.zoomIdentity.translate(this.dimensions.width/2,this.dimensions.height/2).scale(p).translate(-(r+l)/2+(this.props.informationPaneOpen&&window.innerWidth>=s.BREAKPOINT_MD?450:0),-(o+c)/2))},e.prototype.positionToSegment=function(e,t,n){var a=e.x,r=e.y,o=e.x+e.width,l=(e.y,e.height,this.dimensions.width-(this.props.informationPaneOpen&&window.innerWidth>=s.BREAKPOINT_MD?450:0)),c=t/Math.max(e.width/l),p=(a+o)/2,d=this.props.informationPaneOpen&&window.innerWidth>=s.BREAKPOINT_MD?1/c*225:0,m=1/c*(this.dimensions.height/2-24);this.zoom.transform(this.svg.transition().duration(n),i.zoomIdentity.translate(this.dimensions.width/2,this.dimensions.height/2).scale(c).translate(-(p-d),-(r+m)))},e.prototype.update=function(e,t){this.updateDimensions(e),this.updateProps(t),this.updateOcr(),this.updateImages(),this.updateHits(),this.updateHeaderText(),this.updateSegments(),this.updateCropView(),this.updateMask(),this.position(),this.checkLoadTiles()},e.prototype.resize=function(e){this.dimensions=e,this.svg.attr("width",e.width).attr("height",e.height),this.checkLoadTiles()},e.prototype.setZoom=function(e){this.props.zoom=e,this.zoom.scaleTo(this.svg.transition().duration(250),this.props.zoom)},e.prototype.updateImageLayerZoom=function(e){this.props.tiles&&this.props.layer&&null!==this.props.articles&&null!=this.props.clippings&&this.allowViewportImageTileLoading&&(e>=.8?this.handlers.onRequestLayer(1):e>=.4?this.handlers.onRequestLayer(.5):this.handlers.onRequestLayer(.25))},e.prototype.checkLoadTiles=function(){if(this.props.tiles&&this.props.tiles.length>0&&this.props.layer&&null!==this.props.articles&&null!=this.props.clippings&&(null!=this.props.selectedSegment&&this.loadImageTilesForArea(this.props.selectedSegment.rectangle),null!=this.props.selectedHit&&this.loadImageTilesForArea(this.props.selectedHit),this.allowViewportImageTileLoading)){var e=this.getViewport();this.loadImageTilesForArea(e)}},e.prototype.loadImageTilesForArea=function(e){var t=this;this.props.tiles.forEach((function(n,a){if(!t.props.hasLoadedTile.has(n.src)){var r=new o.Rectangle(e.x,e.y,e.width,e.height,0),s=1/n.zoom,l=new o.Rectangle(n.x*s,n.y*s,n.width*s,n.height*s,0);if(null!==o.Rectangle.intersect(r,l))null!==document.getElementById("l-".concat(1/n.zoom,"-t-").concat(a))&&(i.select("#l-".concat(1/n.zoom,"-t-").concat(a)).attr("href",n.src),t.handlers.onTileLoad(n.src))}}))},e.prototype.getViewport=function(){var e=Math.abs(Math.min(Math.floor(this.transform.x/this.transform.k),0)),t=Math.abs(Math.min(Math.floor(this.transform.y/this.transform.k),0));return{x:e,y:t,width:Math.min(Math.floor(this.dimensions.width/this.transform.k),this.props.layer.width-e),height:Math.min(Math.floor(this.dimensions.height/this.transform.k),this.props.layer.height-t)}},e.prototype.getViewportClippingRectangle=function(){var e=this.getViewport(),t=Math.floor(e.width/4);return{x:Math.floor(e.x+e.width/2-t/2),y:Math.floor(e.y+e.height/8),width:t,height:Math.floor(t*(1400/900))}},e.prototype.unload=function(){this.viewer.selectAll("g").remove(),this.header=this.viewer.append("g").attr("id","header"),this.thumbnailLayer=this.viewer.append("g").attr("id","thumbnail-layer"),this.imageLayers=this.viewer.append("g").attr("id","image-layers"),this.activeImageLayer=null,this.activeImageLayerZoom=null,this.previousImageLayers=new Map,this.initializeImageLayers(),this.segmentLayer=this.viewer.append("g").attr("id","segment-layer"),this.hitsLayer=this.viewer.append("g").attr("id","hits-layer"),this.maskLayer=this.viewer.append("g").attr("id","mask-layer"),this.cropLayer=this.viewer.append("g").attr("id","clipping-layer")},e}();t.default=c},583:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InformationPane=void 0;var a=n(3),i=n(1),r=n(19),o=n(90),s=n(5),l=n(584),c=n(585),p=n(604),d=n(605),m=n(606),u=n(7),h=n(54),g=n(607),f=n(86),b=n(79),y=n(32),v=n(341),_=n(20),E=n(13);t.InformationPane=(0,r.observer)((function(e){var t=i.useContext(o.ViewerContext);switch(t.selectedSegment?t.selectedSegment.type:t.editSegment?"clipping":""){case"clipping":t.editSegment?"#deecf4":""}var n=(0,r.observer)((function(){var e=t.currentInformationPaneLayer;if(("Segment"===e||"default"===e)&&null!=t.selectedSegment)switch(t.selectedSegment.type){case"obituary":return i.createElement(I,null);case"marriage":return i.createElement(M,null);case"clipping":return i.createElement(l.ClippingView,null);case"focus":return i.createElement(P,null)}return"PrintSaveView"===e?i.createElement(g.PrintSaveView,null):"Segment"===e&&t.editSegment?i.createElement(l.ClippingView,null):"ReportAProblem"===e?i.createElement(k,{pageId:t.page.id,onClose:function(){t.removeInformationPaneLayer("ReportAProblem")}}):"KeyboardShortcuts"===e?i.createElement(x,null):"ImageSettings"===e?i.createElement(N,null):i.createElement(w,null)}));return i.createElement("div",{id:"viewer-information-pane",role:"dialog","aria-modal":"false","aria-labelledby":"paperIDLabel",className:"bg-white shadow ".concat(t.showInformationPane?"open":"")},i.createElement("div",{className:"d-flex flex-column h-100 px-md-3 pt-md-1 pb-md-1 pb-md-3"},!(null!==t.editSegment&&"Segment"===t.currentInformationPaneLayer)&&i.createElement("div",{className:"text-right border-bottom p-2 mx-md-n3"},i.createElement(u.CloseButton,{id:"information-pane-close-btn",onClick:function(){var e=t.currentInformationPaneLayer;"Segment"===e?window.innerWidth<h.BREAKPOINT_MD?setTimeout((function(){t.setSelectedSegment(null)}),300):(t.setOverlappingSegments(null),t.setSelectedSegment(null)):"PrintSaveView"===e?window.innerWidth<h.BREAKPOINT_MD?(t.setShowInformationPane(!1),setTimeout((function(){t.setPrintFullOrPartChoice(null),t.setEditSegment(null)}),300)):(t.setPrintFullOrPartChoice(null),t.setEditSegment(null)):t.shiftInformationPaneLayer(!0)}},t.informationPaneLayers.length>1?i.createElement(i.Fragment,null,i.createElement("span",{className:"sr-only"},"Go back"),i.createElement("span",{"aria-hidden":"true",className:"pt-1 d-block",title:"Go back",dangerouslySetInnerHTML:{__html:"&larrhk;"}})):null)),!("ImageSettings"==t.currentInformationPaneLayer||"KeyboardShortcuts"===t.currentInformationPaneLayer||"PrintSaveView"===t.currentInformationPaneLayer||"Segment"===t.currentInformationPaneLayer&&t.editSegment&&window.innerWidth<h.BREAKPOINT_MD)&&i.createElement(E.ErrorBoundary,{FallbackComponent:u.FallbackOops},i.createElement(S,{paperTitle:t.image.publicationTitle,paperLocation:t.image.location,paperUrl:t.image.publicationUrl,date:t.image.date})),i.createElement(E.ErrorBoundary,{FallbackComponent:u.FallbackOops},i.createElement(n,null))))}));var w=(0,r.observer)((function(e){var t=i.useContext(o.ViewerContext),n=1;return i.createElement(i.Fragment,null,i.createElement("div",{className:"overflow-auto"},i.createElement(E.ErrorBoundary,{FallbackComponent:u.FallbackOops},i.createElement(D,{title:"Obituaries",icon:"obit",articles:t.filteredObituaries.map((function(e){var t="Obituary";try{t="".concat(e.extraction.self.GivenName[0]," ").concat(e.extraction.self.Surname[0])}catch(e){}return{id:e.id,type:"obituary",title:t,rectangle:e.rectangle}})),onClick:function(e){var n=e.id,a=e.rectangle,i=e.type;t.setSelectedSegment({id:n,rectangle:a,type:i})},onHover:function(e){if(e){var n=e.id,a=e.rectangle,i=e.type;t.setHighlightSegment({id:n,rectangle:a,type:i})}else t.setHighlightSegment(null)}})),i.createElement(E.ErrorBoundary,{FallbackComponent:u.FallbackOops},i.createElement(D,{title:"Marriages",icon:"marriage",articles:t.filteredMarriages.map((function(e){var t="Marriage Article";try{t="".concat(e.marriage.self.surname," / ").concat(e.marriage.spouse.surname)}catch(e){}return{id:e.id,type:"marriage",title:t,rectangle:e.rectangle}})),onClick:function(e){var n=e.id,a=e.rectangle,i=e.type;t.setSelectedSegment({id:n,rectangle:a,type:i})},onHover:function(e){if(e){var n=e.id,a=e.rectangle,i=e.type;t.setHighlightSegment({id:n,rectangle:a,type:i})}else t.setHighlightSegment(null)}})),i.createElement(E.ErrorBoundary,{FallbackComponent:u.FallbackOops},i.createElement(D,{title:"Clippings",icon:"clip",articles:t.filteredClippings.map((function(e,t){return{id:e.clipping_id.toString(),type:"clipping",title:e.title?e.title:i.createElement(i.Fragment,null,i.createElement("span",{className:"font-italic"},"Untitled clipping ",n++)),rectangle:e.rectangle}})),onClick:function(e){var n=e.id,a=e.rectangle,i=e.type;t.setSelectedSegment({id:n,rectangle:a,type:i})},onHover:function(e){if(e){var n=e.id,a=e.rectangle,i=e.type;t.setHighlightSegment({id:n,rectangle:a,type:i})}else t.setHighlightSegment(null)}}))),i.createElement("footer",{className:"text-small text-center py-3 text-muted mt-auto"},i.createElement(C,null),i.createElement("p",{className:"m-0"},i.createElement("a",{className:"text-muted",href:"#",role:"button",color:"link",onClick:function(e){e.preventDefault(),t.addInformationPaneLayer("ReportAProblem")}},i.createElement(u.Icon,{icon:"flag"})," Report a problem with this page")),i.createElement("p",{className:"m-0"},i.createElement("a",{className:"text-muted",href:"#",role:"button",onClick:function(e){e.preventDefault(),t.addInformationPaneLayer("KeyboardShortcuts")}},i.createElement("span",{"aria-label":"Press ⌘ and / to open keyboard shortcuts"},"⌘ + /")," Keyboard Shortcuts "),i.createElement("span",{"aria-hidden":"true"},"·")," Copyright © ",(new Date).getFullYear()," Newspapers.com")))})),C=function(e){var t=i.useContext(o.ViewerContext);if(!t.attribution.attributionList.length)return null;var n=t.attribution.attributionList[0],a=n.displayName?n.displayName:n.name,r="Leave Newspapers.com and Visit ".concat(a);return"blb_attribution.tpl"===n.template?i.createElement("div",{className:"text-center p-3"},i.createElement("p",null,i.createElement("a",{href:n.url,target:"_blank",title:r},i.createElement("img",{src:"/i/LS_BLB.png",width:160,height:115,alt:"Content provided by: THE BRITISH LIBRARY BOARD. ALL RIGHTS RESERVED.",title:r}))),i.createElement("p",null,"The ownership rights that subsist in the work or reproduction remain the property either of the British Library Board or individual persons. The work or reproduction may not be used, sold, licensed, transferred, copied or reproduced in whole or in part in any manner or form or in or on any media to any person without the prior written consent of the ",i.createElement("a",{href:"http://www.bl.uk",target:"_blank"},"British Library"),".")):i.createElement("div",{className:"text-center p-3"},i.createElement("h4",{className:"text-muted h6"},"Newspapers made available courtesy of"),i.createElement("p",null,i.createElement("a",{href:n.url,target:"_blank",title:r},i.createElement("img",{src:"/rs/contentprovider/icon/small/".concat(n.id,"/260"),title:r}))),i.createElement("p",null,i.createElement("a",{href:n.url,target:"_blank"},a)))},S=function(e){var t=e.paperTitle,n=e.paperLocation,a=e.paperUrl,r=e.date;return i.createElement("div",{className:"border-bottom pb-3 pl-3 pl-md-0"},i.createElement("h1",{className:"h5 pt-3 mb-1",id:"paperIDLabel"},i.createElement("a",{href:a},t)),i.createElement("p",{className:"mb-0"},i.createElement("small",null,i.createElement("b",null,n," ",i.createElement("span",{"aria-hidden":"true"},"·")," ",(0,_.format)((0,_.parseISO)(r),"EEEE, MMMM dd, yyyy")))))},N=(0,r.observer)((function(e){var t=i.useContext(o.ViewerContext),n=t.imageSettings;return i.createElement(i.Fragment,null,i.createElement(s.ModalBody,null,i.createElement("h3",{className:"border-bottom pb-3 mb-3 h6"},"Image Settings"),i.createElement(s.Form,null,i.createElement(s.FormGroup,null,i.createElement(s.Label,{htmlFor:"brightness"},"Brightness: ",t.imageSettings.brightness),i.createElement("input",{id:"brightness",className:"form-control-range",type:"range",min:"-100",max:"100",value:n.brightness,onChange:function(e){t.setBrightness(parseInt(e.target.value))}})),i.createElement(s.FormGroup,null,i.createElement(s.Label,{htmlFor:"contrast"},"Contrast: ",t.imageSettings.contrast),i.createElement("input",{id:"contrast",className:"form-control-range",type:"range",min:"-100",max:"100",value:n.contrast,onChange:function(e){t.setContrast(parseInt(e.target.value))}})),i.createElement("div",{className:"form-row align-items-center"},i.createElement(s.FormGroup,{check:!0},i.createElement(s.Label,{check:!0},i.createElement(s.Input,{type:"checkbox",checked:n.invert,onChange:function(e){t.setInvert(e.target.checked)}}),"Invert")),i.createElement("button",{className:"btn btn-outline-primary btn-sm ml-auto rounded-pill",type:"reset",disabled:0===n.brightness&&0===n.contrast&&!n.invert,onClick:function(){t.setBrightness(0),t.setContrast(0),t.setInvert(!1)}},"Reset Settings")))),i.createElement(s.ModalFooter,null,i.createElement("button",{className:"btn btn-primary rounded-pill",type:"button",onClick:function(){t.shiftInformationPaneLayer(!0)}},"Done")))})),x=(0,r.observer)((function(e){i.useContext(o.ViewerContext);var t=navigator.userAgent.toUpperCase().indexOf("MAC OS")>=0;return i.createElement("div",{className:"".concat(t?"mac":"")},i.createElement("h4",{className:"mb-3 mx-n3 p-3 h6 border-bottom"},"Keyboard Shortcuts"),i.createElement("div",{className:"row mb-3 text-small no-gutters"},i.createElement("div",{className:"col-6"},i.createElement("dl",{className:"row no-gutters"},i.createElement("dt",{className:"col-5 py-2 pr-1 text-right"},"Next Page:")," ",i.createElement("dd",{className:"col-7 py-2 pr-1"},i.createElement("code",{className:"key cmd","aria-label":"Control or Command key"}),i.createElement("code",{className:"key text-dark","aria-label":"Right arrow"},i.createElement("span",{"aria-hidden":"true"},"→"))),i.createElement("dt",{className:"col-5 py-2 pr-1 text-right"},"Previous Page:")," ",i.createElement("dd",{className:"col-7 py-2 pr-1"},i.createElement("code",{className:"key cmd","aria-label":"Control or Command key"}),i.createElement("code",{className:"key text-dark","aria-label":"Left arrow"},i.createElement("span",{"aria-hidden":"true"},"←"))),i.createElement("dt",{className:"col-5 py-2 pr-1 text-right"},"Zoom in:")," ",i.createElement("dd",{className:"col-7 py-2 pr-1"},i.createElement("code",{className:"key cmd","aria-label":"Control or Command key"}),i.createElement("code",{className:"key"},"+")),i.createElement("dt",{className:"col-5 py-2 pr-1 text-right"},"Zoom out:")," ",i.createElement("dd",{className:"col-7 py-2 pr-1"},i.createElement("code",{className:"key cmd","aria-label":"Control or Command key"}),i.createElement("code",{className:"key"},"-")),i.createElement("dt",{className:"col-5 py-2 pr-1 text-right"},"Find:")," ",i.createElement("dd",{className:"col-7 py-2 pr-1"},i.createElement("code",{className:"key cmd","aria-label":"Control or Command key"}),i.createElement("code",{className:"key"},"f")))),i.createElement("div",{className:"col-6"},i.createElement("dl",{className:"row no-gutters"},i.createElement("dt",{className:"col-5 py-2 pr-1 text-right"},"Info panel:")," ",i.createElement("dd",{className:"col-7 py-2 pr-1"},i.createElement("code",{className:"key cmd","aria-label":"Control or Command key"}),i.createElement("code",{className:"key"},"i")),i.createElement("dt",{className:"col-5 py-2 pr-1 text-right"},"Clip:")," ",i.createElement("dd",{className:"col-7 py-2 pr-1"},i.createElement("code",{className:"key cmd","aria-label":"Control or Command key"}),i.createElement("code",{className:"key"},"shift"),i.createElement("code",{className:"key"},"c")),i.createElement("dt",{className:"col-5 py-2 pr-1 text-right"},"Print or Save:")," ",i.createElement("dd",{className:"col-7 py-2 pr-1"},i.createElement("code",{className:"key cmd","aria-label":"Control or Command key"}),i.createElement("code",{className:"key"},"p")," or ",i.createElement("code",{className:"key"},"s")),i.createElement("dt",{className:"col-5 py-2 pr-1 text-right"},"Share:")," ",i.createElement("dd",{className:"col-7 py-2 pr-1"},i.createElement("code",{className:"key cmd","aria-label":"Control or Command key"}),i.createElement("code",{className:"key"},"shift"),i.createElement("code",{className:"key"},"s"))))),i.createElement("p",{className:"text-muted text-small"},"Type ",i.createElement("code",{className:"key cmd","aria-label":"Control or Command key"}),i.createElement("code",{className:"key"},"/")," to see this help box again. Visit our ",i.createElement("strong",null,i.createElement("a",{href:"/basics/#h-view"},"Help Page"))," for more tips about using the viewer."))})),k=function(e){var t=a.__read(i.useState(""),2),n=t[0],r=t[1],o=a.__read(i.useState(!1),2),l=o[0],c=o[1],p=a.__read(i.useState(!1),2),d=p[0],m=p[1];return i.createElement(i.Fragment,null,i.createElement("div",{className:"modal-body px-0 pt-0 flex-grow-0"},i.createElement("h5",{className:"mb-3 mx-n3 p-3 h6 border-bottom"},i.createElement(u.Icon,{icon:"flag","aria-hidden":"true"}),"Report a Problem"),i.createElement("label",{htmlFor:"reportText"},"Why are you reporting this image?"),i.createElement("textarea",{id:"reportText","aria-describedby":"noteReport",disabled:l||d,placeholder:"Enter details...",cols:22,rows:3,className:"form-control",onChange:function(e){r(e.target.value)}}),i.createElement("small",{className:"form-text text-muted",id:"noteReport"},"Example: offensive content, copyrighted material, image problem.")),i.createElement("div",{className:"modal-footer"},i.createElement("button",{className:"btn btn-primary btn-sm rounded-pill order-2",onClick:function(){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return c(!0),[4,v.ViewerDao.reportImage(e.pageId,n)];case 1:return t.sent(),c(!1),m(!0),setTimeout((function(){e.onClose(),m(!1),r("")}),4e3),[2]}}))}))},disabled:d||l,type:"button"},"Report This"),i.createElement("button",{type:"button",className:"border nosize order-1 rounded-pill btn btn-white btn-sm",onClick:function(){e.onClose()}},"Cancel")),d&&i.createElement(s.Alert,{color:"success"},"Thank you. Your report has been submitted for review."))},P=(0,r.observer)((function(e){var t=i.useContext(o.ViewerContext);return i.createElement("div",null,i.createElement("h2",null,"Choose an option"),i.createElement(s.ModalFooter,null,i.createElement(s.Button,{color:"secondary",className:"icon-only py-2 rounded-pill",onClick:function(){t.beginPrintSave()}},i.createElement(u.Icon,{icon:"print",title:"Clip","aria-hidden":"true"}),"Print / Save"),i.createElement(s.Button,{color:"acom",className:"icon-only py-2 save-to-ancestry rounded-pill",onClick:function(){t.createClipping("save-to-ancestry")}},i.createElement(u.Icon,{icon:"acom",title:"Clip","aria-hidden":"true"}),"Save to Ancestry"),i.createElement(s.Button,{color:"primary",className:"btn btn-primary py-2 rounded-pill",onClick:function(){t.createClipping(null)}},i.createElement(u.Icon,{icon:"clip",title:"Clip","aria-hidden":"true"}),"Clip")))})),I=(0,r.observer)((function(e){var t=i.useContext(o.ViewerContext),n=i.useContext(f.NcomContext);if(null===t.selectedSegment)return null;var r=t.articles.obituaries.find((function(e){return e.id===t.selectedSegment.id}));if(null===r)return null;var s=null!==t.clippings?t.clippings.find((function(e){return n.user===e.user_id&&e.article_id===t.selectedSegment.id})):void 0,l=!!s,d=new p.ObituaryStore(t.image.imageId,r),m=function(){return a.__awaiter(void 0,void 0,void 0,(function(){var e,n;return a.__generator(this,(function(a){switch(a.label){case 0:return t.checkCreateClippingRights("")?(e=t.selectedSegment.rectangle,[4,t.getDefaultSettings()]):[2];case 1:return a.sent(),[4,b.ClippingDao.create({page_id:t.page.id,article_id:t.selectedSegment.id,rectangle:new y.Rectangle(e.x,e.y,e.width,e.height,0),title:"Obituary for ".concat(d.name.value),body:"",tags:"obituary",is_public:t.defaultOpenSetting,is_notify:t.defaultNotifySetting,brightness:t.imageSettings.brightness,contrast:t.imageSettings.contrast,invert:t.imageSettings.invert},t.iat)];case 2:return n=a.sent(),t.addClipping(n),t.setSelectedSegment({id:n.clipping_id.toString(),rectangle:e,type:"clipping"}),[2,n]}}))}))};return i.createElement(c.default,{viewer:t,store:d,hasClipped:l,onClickClip:function(){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return l?(t.setSelectedSegment({id:s.clipping_id.toString(),rectangle:s.rectangle,type:"clipping"}),[3,3]):[3,1];case 1:return[4,m()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},onClickSTA:function(){return a.__awaiter(void 0,void 0,void 0,(function(){var e;return a.__generator(this,(function(n){switch(n.label){case 0:return l?(t.setSelectedSegment({id:s.clipping_id.toString(),rectangle:s.rectangle,type:"clipping"}),t.loadSaveToAncestry(s),[3,3]):[3,1];case 1:return[4,m()];case 2:e=n.sent(),t.loadSaveToAncestry(e),n.label=3;case 3:return[2]}}))}))},onModalContentChanged:function(){},onToggleCorrectionMode:function(){},onUpdateViewerData:function(){}})})),M=(0,r.observer)((function(e){var t=i.useContext(o.ViewerContext),n=i.useContext(f.NcomContext);if(null===t.selectedSegment)return null;var r=t.articles.marriages.find((function(e){return e.id===t.selectedSegment.id}));if(null===r)return null;var s=null!==t.clippings?t.clippings.find((function(e){return n.user===e.user_id&&e.article_id===t.selectedSegment.id})):void 0,l=!!s,c=new d.MarriageStore(t.image.imageId,r),p=function(){return a.__awaiter(void 0,void 0,void 0,(function(){var e,n;return a.__generator(this,(function(a){switch(a.label){case 0:return t.checkCreateClippingRights("")?(e=t.selectedSegment.rectangle,[4,t.getDefaultSettings()]):[2];case 1:return a.sent(),[4,b.ClippingDao.create({page_id:t.page.id,article_id:t.selectedSegment.id,rectangle:new y.Rectangle(e.x,e.y,e.width,e.height,0),title:"Marriage of ".concat(c.selfSurname.value," / ").concat(c.spouseSurname.value),body:"",tags:"marriage",is_public:t.defaultOpenSetting,is_notify:t.defaultNotifySetting,brightness:t.imageSettings.brightness,contrast:t.imageSettings.contrast,invert:t.imageSettings.invert},t.iat)];case 2:return n=a.sent(),t.addClipping(n),t.setSelectedSegment({id:n.clipping_id.toString(),rectangle:e,type:"clipping"}),[2,n]}}))}))};return i.createElement(m.default,{viewer:t,store:c,hasClipped:l,onClickClip:function(){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return l?(t.setSelectedSegment({id:s.clipping_id.toString(),rectangle:s.rectangle,type:"clipping"}),[3,3]):[3,1];case 1:return[4,p()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},onClickSTA:function(){return a.__awaiter(void 0,void 0,void 0,(function(){var e;return a.__generator(this,(function(n){switch(n.label){case 0:return l?(t.setSelectedSegment({id:s.clipping_id.toString(),rectangle:s.rectangle,type:"clipping"}),t.loadSaveToAncestry(s),[3,3]):[3,1];case 1:return[4,p()];case 2:e=n.sent(),t.loadSaveToAncestry(e),n.label=3;case 3:return[2]}}))}))},onModalContentChanged:function(){},onToggleCorrectionMode:function(){},onUpdateViewerData:function(){}})})),D=function(e){return e.articles.length?i.createElement(i.Fragment,null,i.createElement("h2",{className:"h6 border-bottom py-3 mb-0 pl-3 pl-md-0"},i.createElement(u.Icon,{icon:e.icon,"aria-hidden":"true"}),e.title," ",i.createElement(s.Badge,{pill:!0,color:"danger",className:"mx-1"},e.articles.length)),i.createElement(s.ListGroup,{flush:!0},e.articles.map((function(t){return i.createElement(s.ListGroupItem,{key:t.id,tag:"button",type:"button",className:"text-left btn-link",onClick:function(){e.onClick(t)},onMouseOver:function(){e.onHover(t)},onMouseOut:function(){e.onHover(null)}},t.title)})))):null}},584:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClippingView=void 0;var a=n(3),i=n(1),r=n(19),o=n(90),s=n(78),l=n(32),c=n(54),p=n(7),d=n(5),m=n(79),u=n(32),h=n(8),g=n(86),f=n(342);t.ClippingView=(0,r.observer)((function(e){var t,n,r=i.useContext(o.ViewerContext),b=i.useContext(g.NcomContext),y=a.__read(i.useState(!1),2),v=y[0],_=y[1],E=a.__read(i.useState(!1),2),w=E[0],C=E[1],S=null!==r.editSegment;i.useEffect((function(){r.getDefaultSettings()}),[]);var N=null;if(r.selectedSegment||r.setEditSegment){if(null===(N=null!==r.clippings?r.clippings.find((function(e){return r.selectedSegment&&e.clipping_id.toString()===r.selectedSegment.id||r.editSegment&&e.clipping_id.toString()===r.editSegment.id})):null))return null;N=(0,h.toJS)(N)}var x=a.__read(i.useState(window.innerWidth<c.BREAKPOINT_MD?1:2),2),k=x[0],P=x[1],I=a.__read(i.useState(N||new l.Clipping(-1)),2),M=I[0],D=I[1],T=function(){_(!v)},O=i.createElement(i.Fragment,null,i.createElement(p.Icon,{icon:"clip","aria-hidden":"true"}),N&&1===k?"Adjust your clipping image":N&&2===k?"Edit your Clipping":"Create a Clipping");if(null!==r.postCreationAction)switch(r.postCreationAction){case"save-to-ancestry":O=i.createElement("span",null,"Select an area to Save to Ancestry");break;case"share":O=i.createElement("span",null,"Select an area to share");break;case"print-or-save":O=i.createElement("span",null,"Select an area to print or save")}var A={default:"Save",saving:"Saving…",className:"rounded-pill",color:"primary"};if(v)A={default:"Remove",saving:"Deleting…",className:"rounded-pill",color:"primary"};else if(S&&"new"===r.editSegment.id)switch(A={default:"Save Clipping",saving:"Saving Clipping…",className:"rounded-pill",color:"primary"},r.postCreationAction){case"save-to-ancestry":A.default="Save to Ancestry",A.className="save-to-ancestry rounded-pill",A.color="";break;case"share":A.default="Clip & Share",A.className="rounded-pill";break;case"print-or-save":A.default="Continue",A.className="rounded-pill"}else S&&(A={default:"Save",saving:"Saving…",className:"rounded-pill",color:"primary"});var F=N?"/clip/".concat(N.clipping_id,"/").concat(N.title?(0,p.getUrlTitle)(N.title,40):(0,p.getUrlTitle)(N.publication.name,40),"/"):"",L=!!(null==N?void 0:N.article_id),R=null,B=null,V=null;return L&&(B=r.articles?r.articles.marriages.find((function(e){return e.id===N.article_id})):void 0,V=r.articles?r.articles.obituaries.find((function(e){return e.id===N.article_id})):void 0,B?R="marriage":V?R="obituary":L=!1),i.createElement("div",{className:"overflow-auto ".concat(2===k?"hv-50":"px-3")},!S&&N&&i.createElement(i.Fragment,null,i.createElement("h2",{className:"border-bottom py-2 h6"},i.createElement(p.Icon,{icon:"clip","aria-hidden":"true"}),"Clipping"),i.createElement(d.Row,{className:"align-items-center pb-2",noGutters:!0},i.createElement(d.Col,{sm:"7"},i.createElement("a",{href:F,className:N.title?"":"font-italic"},N.title?N.title:"Untitled clipping"),N.body&&i.createElement("p",{className:"text-truncate mb-0 text-small",title:N.body},N.body)),i.createElement(d.Col,{xs:"auto",className:"ml-auto"},N.user_id===b.user&&i.createElement(d.Button,{color:"white",className:"icon-news icon-edit border rounded-pill mr-2",size:"sm",onClick:function(){var e=r.selectedSegment;r.setSelectedSegment(null),r.setEditSegment(a.__assign(a.__assign({},e),{source:null}))}},"Edit"),i.createElement(d.Button,{color:"white",className:"border rounded-pill",size:"sm",onClick:function(){location.href=F}},"View Clip ↗"))),L&&i.createElement(d.Row,{noGutters:!0,className:"border-top align-items-center"},i.createElement(d.Col,{className:"py-2"},i.createElement("span",{className:"text-uppercase mr-2 text-small text-muted"},"Article Type:"),i.createElement(p.Icon,{icon:"marriage"===R?"marriage":"obituary"===R?"obit":"",className:"marriage"===R?"text-pink":"text-primary2","aria-hidden":"true"}),i.createElement("span",{className:"text-capitalize"},R)),i.createElement(d.Col,{xs:"auto",className:"ml-auto py-2"},i.createElement(d.Button,{size:"sm",color:"white",className:"rounded-pill border",onClick:function(){V?r.setSelectedSegment({id:V.id,rectangle:V.rectangle,type:"obituary"}):B&&r.setSelectedSegment({id:B.id,rectangle:B.rectangle,type:"marriage"})}},"Show Article Facts"))),N.tags&&i.createElement(d.Row,{noGutters:!0,className:"border-top"},i.createElement(d.Col,{xs:12,className:"py-2"},i.createElement("p",{className:"text-muted mb-0"},i.createElement("span",{className:"text-small text-muted text-uppercase"},"Tags:")," ",N.tags.split(",").map((function(e){return i.createElement(d.Badge,{pill:!0,className:"ml-1"},e)})),"  ",N.user_id===b.user&&i.createElement(d.Button,{color:"white",className:"px-2 py-0 border rounded-pill ml-2",size:"sm","aria-label":"Add a tag",onClick:function(){var e=r.selectedSegment;r.setSelectedSegment(null),r.setEditSegment(a.__assign(a.__assign({},e),{source:null}))}},i.createElement("b",{"aria-hidden":"true"},"+"))))),i.createElement(d.Row,{noGutters:!0,className:"border-top"},i.createElement(d.Col,{className:"text-small text-muted py-2"},i.createElement("span",{className:"text-uppercase mr-2"},"Clipped by:"),i.createElement("a",{className:"avatar mr-sm-2",onClick:null,role:"button"},i.createElement("img",{src:"".concat(b.paths.site,"/usericon.php?id=").concat(N.user_id,"&amp;size=54"),alt:"Your member photo",className:"rounded-circle",width:"36"}),i.createElement("b",{className:"text-muted ml-2"},N.user_username)))),i.createElement(d.ModalFooter,{className:"px-0"},r.isReadingSupported&&i.createElement(d.Button,{size:"sm",color:"secondary",className:"rounded-pill",title:"Speak clipping",onClick:function(){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(e){return r.readSegment(),[2]}))}))}},i.createElement("img",{src:"/i/voice-search.svg",width:"12",alt:"",className:"mr-2","aria-hidden":"true"}),null===r.isReading?"Speak":r.isReading?"Pause":"Resume"),!(null===(t=r.image)||void 0===t?void 0:t.archived)&&i.createElement(d.Button,{size:"sm",color:"primary",className:"icon-news icon-share rounded-pill",title:"Share a clipping",onClick:function(){r.setShareClipping(N)}}," Share"),!(null===(n=r.image)||void 0===n?void 0:n.archived)&&i.createElement("button",{className:"btn btn-sm icon-news icon-acom save-to-ancestry rounded-pill",title:"Save clipping to Ancestry",onClick:function(){r.loadSaveToAncestry(N)}}," Save to Ancestry"))),S&&1===k&&i.createElement(i.Fragment,null,i.createElement("h3",{className:"my-2 py-2 h6 pl-3 pl-sm-0"},O),i.createElement("div",{className:"modal-footer px-0"},i.createElement(p.NewsModalFooter,{saving:!1,cancelButtonClassName:"rounded-pill",buttonText:"Continue",savingButtonText:"Loading...",saveButtonClassName:"rounded-pill",saveButtonColor:"primary",onClose:v?T:function(){var e=r.editSegment;"new"!==e.id?(r.setEditSegment(null),r.setSelectedSegment(e)):window.innerWidth<c.BREAKPOINT_MD?(r.setShowInformationPane(!1),setTimeout((function(){r.setEditSegment(null)}),300)):r.setEditSegment(null)},onSave:function(){P(2)}}))),S&&2===k&&i.createElement(i.Fragment,null,i.createElement("h3",{className:"my-2 py-2 h6 pl-3 pl-sm-0 border-bottom"},O),i.createElement("div",{className:"my-1 mb-5 pb-5 mb-md-0 pb-md-0"},r.checkedDefaultSettings?i.createElement(s.ClippingForm,{showImage:!1,showTags:!0,deletePageVisible:v,clipping:N,defaultSettings:{is_public:r.defaultOpenSetting||"share"===r.postCreationAction,is_notify:r.defaultNotifySetting,brightness:r.imageSettings.brightness,contrast:r.imageSettings.contrast,invert:r.imageSettings.invert},onChange:function(e){D(e)}}):i.createElement("p",{className:"text-muted text-center",role:"status"},"Loading…")),i.createElement("div",{className:"modal-footer px-sm-0 bg-white w-100 fixed-footer"},i.createElement(p.NewsModalFooter,{saving:w,cancelButtonClassName:"rounded-pill",buttonText:A.default,savingButtonText:A.saving,saveButtonClassName:A.className,saveButtonColor:A.color,onClose:v?T:function(){var e=r.editSegment;"new"!==e.id?(r.setEditSegment(null),r.setSelectedSegment(e)):window.innerWidth<c.BREAKPOINT_MD?(r.setShowInformationPane(!1),setTimeout((function(){r.setEditSegment(null)}),300)):r.setEditSegment(null)},onSave:function(){return a.__awaiter(void 0,void 0,void 0,(function(){var e,t,n,o,s;return a.__generator(this,(function(a){switch(a.label){case 0:C(!0),e="",a.label=1;case 1:return a.trys.push([1,8,,9]),v?(e="delete",[4,m.ClippingDao.delete(N)]):[3,3];case 2:return a.sent(),r.removeClipping(N.clipping_id),r.setEditSegment(null),[3,7];case 3:return"new"!==r.editSegment.id?[3,5]:(e="create",o=r.editSegment.rectangle,M.page_id=r.image.imageId,M.rectangle=new u.Rectangle(o.x,o.y,o.width,o.height,0),M.brightness=r.imageSettings.brightness,M.contrast=r.imageSettings.contrast,M.invert=r.imageSettings.invert,f.LocalStorageDao.addRecentTags(M.tags),[4,m.ClippingDao.create(M,r.fcfToken)]);case 4:return t=a.sent(),n=r.postCreationAction,r.addClipping(t),r.setEditSegment(null),r.setSelectedSegment({id:t.clipping_id.toString(),rectangle:o,type:"clipping"}),"save-to-ancestry"===n?r.loadSaveToAncestry(t):"share"===n?r.setShareClipping(t,null):"print-or-save"===n&&r.setPrintFullOrPartChoice({mode:"part"}),[3,7];case 5:return e="update",o=r.editSegment.rectangle,M.rectangle=new u.Rectangle(o.x,o.y,o.width,o.height,0),M.brightness=r.imageSettings.brightness,M.contrast=r.imageSettings.contrast,M.invert=r.imageSettings.invert,[4,m.ClippingDao.update(N,M,!0)];case 6:s=a.sent(),r.setEditSegment(null),r.removeClipping(N.clipping_id),r.addClipping(s),r.setSelectedSegment({id:s.clipping_id.toString(),rectangle:o,type:"clipping"}),a.label=7;case 7:return[3,9];case 8:return a.sent(),r.setAlert({color:"danger",message:i.createElement(i.Fragment,null,"Sorry, we are unable to ",e," your clipping at this time. Please try again later.")}),[3,9];case 9:return C(!1),[2]}}))}))}},i.createElement(d.Button,{type:"button",color:"outline-danger",size:"sm",onClick:T,className:"mr-auto order-0 rounded-pill ".concat(S&&"new"!==r.editSegment.id&&!v?"":" d-none"),tabIndex:0},i.createElement(p.Icon,{icon:"del"}),"Remove"),window.innerWidth<c.BREAKPOINT_MD&&i.createElement(d.Button,{color:"white",size:"sm",className:"rounded-pill border mr-auto",onClick:function(){P(1)}},"Adjust Image")))))}))},585:function(e,t,n){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0}),t.Alternates=t.CorrectionModal=t.Relatives=void 0;var i=n(3),r=n(1),o=n(6),s=n(8),l=n(5),c=n(343);n(352);var p=n(7),d=n(353),m=n(262),u=n(20),h=n(195),g=n(31);var f=new Map([["name","Name"],["maidenName","Maiden Name"],["gender","Gender"],["age","Age"],["birthDate","Birth Date"],["birthPlace","Birth Place"],["residencePlace","Residence"],["marriageDate","Marriage Date"],["marriagePlace","Marriage Place"],["deathDate","Died"],["deathPlace","Death Place"],["burialDate","Burial Date"],["burialPlace","Burial Place"]]),b=new Map([["name","Names"],["maidenName","Maiden Names"],["age","Ages"],["birthDate","Birth Dates"],["birthPlace","Birth Places"],["residencePlace","Residences"],["marriageDate","Marriage Dates"],["marriagePlace","Marriage Places"],["deathDate","Death Dates"],["deathPlace","Death Places"],["burialDate","Burial Dates"],["burialPlace","Burial Places"]]),y=function(e){function t(t){var n=e.call(this,t)||this,a=!1;try{a=null!=new URLSearchParams(window.document.location.search).get("add-alternate-info-btn")}catch(e){}return n.state={visibleAddAlternateInfoButton:a},n}return i.__extends(t,e),t.prototype.onClickSTA=function(e){this.props.onClickSTA()},t.prototype.onClickClip=function(e){this.props.onClickClip()},t.prototype.onUpdateViewerData=function(){this.props.onUpdateViewerData(this.props.store.obitId,(0,s.toJS)(this.props.store.corrections))},t.prototype.toggleCorrectionMode=function(e){ncom.user&&("link"!==e&&"button"!==e||(0,g.sendEvent)("viewer-obituary","click",e),this.props.store.toggleCorrectionMode(),this.props.onToggleCorrectionMode(this.props.store.correctionMode))},t.prototype.componentDidMount=function(){this.props.onModalContentChanged()},t.prototype.componentDidUpdate=function(){this.props.onModalContentChanged()},t.prototype.render=function(){var e=this,t=this.props.store.name,n=this.props.store.gender,a=this.props.store.age,i=this.props.store.maidenName,o=this.props.store.birthDate,s=this.props.store.birthPlace,c=this.props.store.residencePlace,m=this.props.store.marriageDate,u=this.props.store.marriagePlace,h=this.props.store.deathDate,g=this.props.store.deathPlace,f=this.props.store.burialDate,b=this.props.store.burialPlace,y=function(e,t){var n=e.value?e.value:"",a=t.value?t.value:"";return n&&a?r.createElement(r.Fragment,null,n.substring(0,4),"–",a.substring(0,4)):null}(o,h);return this.props.store.correctionMode?r.createElement(r.Fragment,null,r.createElement("div",{className:"obituary_header position-relative"},r.createElement("p",{className:"correction alert alert-warning correction"},"Add alternate info by selecting a fact below.")),r.createElement(l.ModalBody,{className:"flex-shrink-1 flex-grow-0 pt-0 px-0"},r.createElement(S,{store:this.props.store,onUpdateViewerData:this.onUpdateViewerData.bind(this)}),this.obituaryFields(t,i,n,a,o,s,c,m,u,h,g,f,b),!(t.value&&n.value&&i.value&&o.value&&s.value&&c.value&&m.value&&u.value&&h.value&&g.value&&f.value&&b.value)&&r.createElement(l.Row,null,r.createElement(l.Col,{className:"text-center my-2"},r.createElement("a",{role:"button",className:"btn btn-link btn-sm",href:"",onClick:function(t){t.preventDefault(),e.props.store.toggleCorrectionModal(),e.props.store.setModalType("add")}},r.createElement("span",{className:"icon-news icon-plus"})," Add additional fact")))),r.createElement(l.ModalFooter,{className:"tbuttonbar flxd"},r.createElement(l.Button,{className:"rounded-pill",color:"primary",onClick:this.toggleCorrectionMode.bind(this,"done")},"Done"))):r.createElement(r.Fragment,null,r.createElement("h6",{className:"border-bottom py-3 pl-3 pl-md-0"},r.createElement(p.Icon,{icon:"obit","aria-hidden":"true"}),"Obituary"),r.createElement(l.Row,{className:"obituary_header position-relative",noGutters:!0},r.createElement(l.Col,{xs:3,sm:4,className:"text-right p-0 m-0"},n.value&&r.createElement("span",{"aria-label":"Gender: ".concat(n.value),className:"mr-n3 obituary_self_gender icon-obit-".concat(n.value)})),r.createElement(l.Col,{className:"m-0 pl-4"},r.createElement("h3",{className:"obituary_self_name h5 text-secondary2 text-left mb-1 ".concat(t.value?"":"font-italic")},t.value?t.value:"Unnamed Obituary"),r.createElement("p",{className:"obituary_self_lifespan text-left m-0 pb-1"},y," ",void 0!==a.value&&r.createElement(r.Fragment,null,"(Aged ",a.value,")")))),r.createElement(l.ModalBody,{className:"flex-shrink-1 flex-grow-0 pt-0 overflow-auto"},this.obituaryFields(t,i,n,a,o,s,c,m,u,h,g,f,b)),r.createElement(l.Row,{className:"bg-white border-top position-relative",noGutters:!0},r.createElement(l.Col,null,this.props.store.hasAlternates&&r.createElement(l.Row,{noGutters:!0},r.createElement(l.Col,{xs:{offset:1,size:11},className:"pl-1"},r.createElement("small",null,r.createElement("p",{className:"text-muted pt-2 pr-2 m-0 text-right"},r.createElement("b",null,"*")," – Alternate fact")))),r.createElement(l.Row,{className:"obituary_disclaimer",noGutters:!0},r.createElement(l.Col,{xs:1,className:"py-3 py-sm-2 px-1 text-center"},r.createElement("span",{className:"icon-news text-muted icon-help pull-left large align-middle"})),r.createElement(l.Col,{xs:11,className:"pl-1"},r.createElement("small",null,r.createElement("p",{className:"text-muted py-2 m-0"},"These facts were pulled from this record by a computer and may not be accurate.",ncom.user&&r.createElement(r.Fragment,null," ",r.createElement("button",{id:"add-alternate-info-link",type:"button",onClick:this.toggleCorrectionMode.bind(this,"link"),className:"btn btn-link btn-sm p-0 border-0 align-baseline m-0"},"Add or update information")," · ",r.createElement(d.ReportIssueModal,{pageId:this.props.store.pageId,articleId:this.props.store.obitId,articleType:"obituary"})))))))),r.createElement(l.ModalFooter,null,ncom.user&&this.state.visibleAddAlternateInfoButton&&r.createElement(l.Button,{outline:!0,color:"dark",id:"add-alternate-info-btn",className:"py-2 float-left btn-sm rounded-pill",onClick:this.toggleCorrectionMode.bind(this,"button")},"Add or update information"),this.props.viewer.isReadingSupported&&r.createElement(l.Button,{color:"secondary",className:"rounded-pill",onClick:function(){e.props.viewer.readSegment()}},r.createElement("img",{src:"/i/voice-search.svg",width:"12",alt:"",className:"mr-2","aria-hidden":"true"})," ",null===this.props.viewer.isReading?"Speak":this.props.viewer.isReading?"Pause":"Resume"),r.createElement(l.Button,{color:"acom",className:"save-to-ancestry rounded-pill",onClick:this.onClickSTA.bind(this)},r.createElement(p.Icon,{icon:"acom","aria-hidden":"true"}),"Save to Ancestry"),r.createElement(l.Button,{title:this.props.hasClipped?"View your clipping":"Clip this obituary",color:"primary",className:"btn rounded-pill",onClick:this.onClickClip.bind(this)},r.createElement(p.Icon,{icon:"clip","aria-hidden":"true"}),this.props.hasClipped?"Clipping":"Clip")))},t.prototype.obituaryFields=function(e,t,n,a,o,s,l,c,p,d,m,u,h){var g=this.props.store.relatives,f=i.__spreadArray([],i.__read(g.values()),!1).filter((function(e){return"parents"===e.relationship})),b=i.__spreadArray([],i.__read(g.values()),!1).filter((function(e){return"spouses"===e.relationship})),y=i.__spreadArray([],i.__read(g.values()),!1).filter((function(e){return"siblings"===e.relationship})),E=i.__spreadArray([],i.__read(g.values()),!1).filter((function(e){return"children"===e.relationship}));return r.createElement(r.Fragment,null,r.createElement("div",{className:"obituary_self_facts"},this.props.store.correctionMode&&this.props.store.submittedFields.length>0&&r.createElement("p",{className:"text-success text-center mb-1"},r.createElement("span",{className:"icon-news icon-check"},"Alternate facts in ",r.createElement("b",null,"bold and green"))),e.value&&r.createElement(_,{type:"name",field:e,submitted:this.props.store.submittedFields.includes("givenName")||this.props.store.submittedFields.includes("surname")||this.props.store.submittedFields.includes("suffix"),correctionMode:this.props.store.correctionMode,correctionType:"personal",alternatesPopupVisible:this.props.store.alternatesOpen&&"name"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"name")}),t.value&&r.createElement(_,{type:"maidenName",field:t,submitted:this.props.store.submittedFields.includes("maidenName"),correctionMode:this.props.store.correctionMode,correctionType:"personal",alternatesPopupVisible:this.props.store.alternatesOpen&&"maidenName"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"maidenName")}),n.value&&this.props.store.correctionMode&&r.createElement(_,{type:"gender",field:n,submitted:this.props.store.submittedFields.includes("gender"),correctionMode:this.props.store.correctionMode,correctionType:"personal",alternatesPopupVisible:!1,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:null}),o.value&&r.createElement(_,{type:"birthDate",field:o,submitted:this.props.store.submittedFields.includes("birthDate"),correctionMode:this.props.store.correctionMode,correctionType:"birth",alternatesPopupVisible:this.props.store.alternatesOpen&&"birthDate"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"birthDate")}),s.value&&r.createElement(_,{type:"birthPlace",field:s,submitted:this.props.store.submittedFields.includes("birthPlace"),correctionMode:this.props.store.correctionMode,correctionType:"birth",alternatesPopupVisible:this.props.store.alternatesOpen&&"birthPlace"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"birthPlace")}),l.value&&r.createElement(_,{type:"residencePlace",field:l,submitted:this.props.store.submittedFields.includes("residencePlace"),correctionMode:this.props.store.correctionMode,correctionType:"residence",alternatesPopupVisible:this.props.store.alternatesOpen&&"residencePlace"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"residencePlace")}),c.value&&r.createElement(_,{type:"marriageDate",field:c,submitted:this.props.store.submittedFields.includes("marriageDate"),correctionMode:this.props.store.correctionMode,correctionType:"marriage",alternatesPopupVisible:this.props.store.alternatesOpen&&"marriageDate"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"marriageDate")}),p.value&&r.createElement(_,{type:"marriagePlace",field:p,submitted:this.props.store.submittedFields.includes("marriagePlace"),correctionMode:this.props.store.correctionMode,correctionType:"marriage",alternatesPopupVisible:this.props.store.alternatesOpen&&"marriagePlace"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"marriagePlace")}),d.value&&r.createElement(_,{type:"deathDate",field:d,submitted:this.props.store.submittedFields.includes("deathDate"),correctionMode:this.props.store.correctionMode,correctionType:"death",alternatesPopupVisible:this.props.store.alternatesOpen&&"deathDate"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"deathDate")}),m.value&&r.createElement(_,{type:"deathPlace",field:m,submitted:this.props.store.submittedFields.includes("deathPlace"),correctionMode:this.props.store.correctionMode,correctionType:"death",alternatesPopupVisible:this.props.store.alternatesOpen&&"deathPlace"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"deathPlace")}),void 0!==a.value&&r.createElement(_,{type:"age",field:a,submitted:this.props.store.submittedFields.includes("age"),correctionMode:this.props.store.correctionMode,correctionType:"death",alternatesPopupVisible:this.props.store.alternatesOpen&&"age"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"age")}),u.value&&r.createElement(_,{type:"burialDate",field:u,submitted:this.props.store.submittedFields.includes("burialDate"),correctionMode:this.props.store.correctionMode,correctionType:"burial",alternatesPopupVisible:this.props.store.alternatesOpen&&"burialDate"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"burialDate")}),h.value&&r.createElement(_,{type:"burialPlace",field:h,submitted:this.props.store.submittedFields.includes("burialPlace"),correctionMode:this.props.store.correctionMode,correctionType:"burial",alternatesPopupVisible:this.props.store.alternatesOpen&&"burialPlace"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"burialPlace")})),!this.props.store.correctionMode&&(f.length>0||b.length>0||y.length>0||E.length>0)&&r.createElement("div",{className:"obituary_names_mentioned mt-2 pb-2 border-top"},r.createElement("h4",{className:"h6 text-center py-2 text-muted border-bottom text-uppercase"},"Names Mentioned"),r.createElement(v,{label:"Parents",relatives:f,correctionMode:this.props.store.correctionMode,correctionType:"relatives",toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store)}),r.createElement(v,{label:"Spouses",relatives:b,correctionMode:this.props.store.correctionMode,correctionType:"relatives",toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store)}),r.createElement(v,{label:"Siblings",relatives:y,correctionMode:this.props.store.correctionMode,correctionType:"relatives",toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store)}),r.createElement(v,{label:"Children",relatives:E,correctionMode:this.props.store.correctionMode,correctionType:"relatives",toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store)})))},t=i.__decorate([o.observer],t)}(r.Component);t.default=y;var v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={show:!1},n.onClickShowMore=n.onClickShowMore.bind(n),n}return i.__extends(t,e),t.prototype.onClickShowMore=function(e){e.preventDefault(),this.setState({show:!0})},t.prototype.render=function(){var e,t=this;if(this.props.relatives&&this.props.relatives.length>0){var n=(e=this.props.relatives,e.map((function(e){return n="",n+=void 0!==(t=e).givenName?t.givenName:"",n+=void 0!==t.surname?" ".concat(t.surname):"";var t,n})).filter((function(e){return e.length>0})));if(n.length>0){var a=this.state.show?n.length:2,i=n.slice(0,a).join(", ");return r.createElement(l.FormGroup,{row:!0,role:this.props.correctionMode?"button":"",className:this.props.correctionMode?"m-0 icon-news alert-warning border-bottom":"m-0 icon-news",onClick:this.props.correctionMode?function(e){e.preventDefault(),t.props.toggleCorrectionModal(),t.props.setCorrectionType(t.props.correctionType)}:null},r.createElement(l.Col,{xs:3,sm:4,className:"text-right text-uppercase text-muted pt-0 py-1 pr-0 pl-0 "},r.createElement("small",null,this.props.label)),r.createElement(l.Col,{xs:9,sm:8},i),!this.state.show&&n.length>2&&r.createElement(l.Col,{xs:{size:7,offset:3},sm:{size:8,offset:4},className:"pb-2 pt-0 mt-n1"},r.createElement("a",{href:"#",onClick:this.onClickShowMore,className:"text-uppercase"},r.createElement("small",null,"View ",n.length-2," more"))))}return null}return null},t}(r.Component);t.Relatives=v;var _=function(e){var t="birthDate"===e.type||"marriageDate"===e.type||"deathDate"===e.type||"burialDate"===e.type;return r.createElement(l.FormGroup,{role:"button",row:!0,className:e.correctionMode?e.submitted?"m-0 icon-news text-success font-weight-bold alert-warning border-bottom":"m-0 icon-news alert-warning border-bottom":"m-0 icon-news",onClick:e.correctionMode?function(t){t.preventDefault(),e.toggleCorrectionModal(),e.setCorrectionType(e.correctionType)}:null,"aria-label":e.correctionMode?"Click to add an alternate to this fact":""},r.createElement(l.Col,{xs:3,sm:4,className:"text-right text-uppercase text-muted pt-0 py-1 pr-0 pl-0"},r.createElement("small",null,f.get(e.type))),r.createElement(l.Col,{xs:9,sm:8,className:"py-1 pr-4"},t?(0,h.getDisplayDate)(e.field.value):e.field.value,e.field.alternates&&e.field.alternates.length>0&&r.createElement(r.Fragment,null,r.createElement("b",{title:"Alternate fact"},"*"),!e.correctionMode&&r.createElement(r.Fragment,null,r.createElement("a",{className:"text-muted icon-more-dots more-options",onClick:e.alternatesPopupVisible?null:e.handleAlternatesClick.bind(a),title:"Alternate fact details",role:"button"}),e.alternatesPopupVisible&&r.createElement(I,{type:e.type,original:e.field.extractedValue,alternates:e.field.alternates,handleClick:e.handleAlternatesClick})))))},E=/^[A-Za-z \-\'\"\.,']*$/,w=/^[A-Za-z\.]*$/,C=/^[0-9A-Za-z \-\'\"\.,']*$/,S=function(e){function t(t){var n=e.call(this,t)||this;return n.defaultInputStatus={message:"",type:"invalid"},n.state={submitting:!1,errorMessage:null,firstName:n.props.store.givenName.value,lastName:n.props.store.surname.value,maidenName:n.props.store.maidenName.value,suffix:n.props.store.suffix.value,gender:n.props.store.gender.value,age:n.props.store.age.value,birthDate:n.props.store.birthDate.value,birthPlace:n.props.store.birthPlace.value,residencePlace:n.props.store.residencePlace.value,marriageDate:n.props.store.marriageDate.value,marriagePlace:n.props.store.marriagePlace.value,deathDate:n.props.store.deathDate.value,deathPlace:n.props.store.deathPlace.value,burialDate:n.props.store.burialDate.value,burialPlace:n.props.store.burialPlace.value,relatives:n.props.store.relatives,selectedReasons:new Set,feedback:{firstName:n.defaultInputStatus,lastName:n.defaultInputStatus,maidenName:n.defaultInputStatus,suffix:n.defaultInputStatus,age:n.defaultInputStatus,birthPlace:n.defaultInputStatus,residencePlace:n.defaultInputStatus,marriagePlace:n.defaultInputStatus,deathPlace:n.defaultInputStatus,burialPlace:n.defaultInputStatus,relatives:new Map}},n.setInitialFromState(),n}return i.__extends(t,e),t.prototype.setInitialFromState=function(){this.initial={firstName:this.state.firstName,lastName:this.state.lastName,maidenName:this.state.maidenName,suffix:this.state.suffix,gender:this.state.gender,age:this.state.age,birthDate:this.state.birthDate,birthPlace:this.state.birthPlace,residencePlace:this.state.residencePlace,marriageDate:this.state.marriageDate,marriagePlace:this.state.marriagePlace,deathDate:this.state.deathDate,deathPlace:this.state.deathPlace,burialDate:this.state.burialDate,burialPlace:this.state.burialPlace,relatives:this.state.relatives}},t.prototype.setStateFromInitial=function(){this.setState({firstName:this.initial.firstName,lastName:this.initial.lastName,maidenName:this.initial.maidenName,suffix:this.initial.suffix,gender:this.initial.gender,age:this.initial.age,birthDate:this.initial.birthDate,birthPlace:this.initial.birthPlace,residencePlace:this.initial.residencePlace,marriageDate:this.initial.marriageDate,marriagePlace:this.initial.marriagePlace,deathDate:this.initial.deathDate,deathPlace:this.initial.deathPlace,burialDate:this.initial.burialDate,burialPlace:this.initial.burialPlace,relatives:this.initial.relatives})},t.prototype.handleInputChange=function(e){var t;this.setState(((t={})[e.target.name]="age"===e.target.name?parseInt(e.target.value):e.target.value,t))},t.prototype.handleDateChange=function(e,t){var n;(0,u.isDate)(e)&&(0,u.isValid)(e)&&this.setState(((n={})[t]=e?(0,u.format)(e,"yyyy-MM-dd"):"",n))},t.prototype.handleRelativeInputChange=function(e,t,n){var a=this.state.relatives;if(a.has(t)){var i=a.get(t);"givenName"===n?i.givenName=e.target.value:"surname"===n?i.surname=e.target.value:"relationship"===n&&(i.relationship=e.target.value),this.setState({relatives:a})}},t.prototype.validateInput=function(e){var t=e.target.name,n=e.target.value,a=this.state.feedback;"firstName"===t||"lastName"===t||"maidenName"===t?E.test(n)&&n.length>=0&&n.length<=50?a[t]={type:"valid"}:a[t]={message:"Please enter a valid name.",type:"invalid"}:"suffix"===t?w.test(n)&&n.length>=0&&n.length<=20?a[t]={type:"valid"}:a[t]={message:"Please enter a valid suffix.",type:"invalid"}:"age"===t?n&&Number(n)>=0&&Number(n)<=150?a[t]={type:"valid"}:a[t]={message:"Please enter a valid age.",type:"invalid"}:"birthPlace"!==t&&"residencePlace"!==t&&"marriagePlace"!==t&&"deathPlace"!==t&&"burialPlace"!==t||(C.test(n)&&n.length>=0&&n.length<=100?a[t]={type:"valid"}:a[t]={message:"Please enter a valid place.",type:"invalid"}),this.setState({feedback:a})},t.prototype.validateRelativeInput=function(e,t,n){var a=this.state.feedback,i=e.target.value,r={};a.relatives.has(t)&&(r=a.relatives.get(t)),"givenName"!==n&&"surname"!==n||(E.test(i)&&i.length>=0&&i.length<=50?r[n]={type:"valid"}:r[n]={message:"Please enter a valid name.",type:"invalid"}),a.relatives.set(t,r),this.setState({feedback:a})},t.prototype.handleReasonChange=function(e){var t=this.state.selectedReasons;t.has(e)?t.delete(e):t.add(e),this.setState({selectedReasons:t})},t.prototype.handleCorrectionTypeChange=function(e){this.props.store.setCorrectionType(e.target.value)},t.prototype.hasCorrections=function(){return this.state.firstName!==this.initial.firstName||this.state.lastName!==this.initial.lastName||this.state.maidenName!==this.initial.maidenName||this.state.suffix!==this.initial.suffix||this.state.gender!==this.initial.gender||this.state.age!==this.initial.age||this.state.birthDate!==this.initial.birthDate||this.state.birthPlace!==this.initial.birthPlace||this.state.residencePlace!==this.initial.residencePlace||this.state.marriageDate!==this.initial.marriageDate||this.state.marriagePlace!==this.initial.marriagePlace||this.state.deathDate!==this.initial.deathDate||this.state.deathPlace!==this.initial.deathPlace||this.state.burialDate!==this.initial.burialDate||this.state.burialPlace!==this.initial.burialPlace},t.prototype.isFormValid=function(){return!(this.state.feedback.firstName.message&&"invalid"===this.state.feedback.firstName.type||this.state.feedback.lastName.message&&"invalid"===this.state.feedback.lastName.type||this.state.feedback.maidenName.message&&"invalid"===this.state.feedback.maidenName.type||this.state.feedback.suffix.message&&"invalid"===this.state.feedback.suffix.type||this.state.feedback.age.message&&"invalid"===this.state.feedback.age.type||this.state.feedback.birthPlace.message&&"invalid"===this.state.feedback.birthPlace.type||this.state.feedback.residencePlace.message&&"invalid"===this.state.feedback.residencePlace.type||this.state.feedback.marriagePlace.message&&"invalid"===this.state.feedback.marriagePlace.type||this.state.feedback.deathPlace.message&&"invalid"===this.state.feedback.deathPlace.type||this.state.feedback.burialPlace.message&&"invalid"===this.state.feedback.burialPlace.type)},t.prototype.getCorrected=function(){var e={self:{}};return this.state.firstName!==this.initial.firstName&&(e.self.givenName=this.state.firstName),this.state.lastName!==this.initial.lastName&&(e.self.surname=this.state.lastName),this.state.maidenName!==this.initial.maidenName&&(e.self.maidenName=this.state.maidenName),this.state.suffix!==this.initial.suffix&&(e.self.suffix=this.state.suffix),this.state.gender!==this.initial.gender&&(e.self.gender=this.state.gender),this.state.age!==this.initial.age&&(e.self.age=this.state.age),this.state.birthDate!==this.initial.birthDate&&(e.self.birthDate=this.state.birthDate),this.state.birthPlace!==this.initial.birthPlace&&(e.self.birthPlace=this.state.birthPlace),this.state.residencePlace!==this.initial.residencePlace&&(e.self.residencePlace=this.state.residencePlace),this.state.marriageDate!==this.initial.marriageDate&&(e.self.marriageDate=this.state.marriageDate),this.state.marriagePlace!==this.initial.marriagePlace&&(e.self.marriagePlace=this.state.marriagePlace),this.state.deathDate!==this.initial.deathDate&&(e.self.deathDate=this.state.deathDate),this.state.deathPlace!==this.initial.deathPlace&&(e.self.deathPlace=this.state.deathPlace),this.state.burialDate!==this.initial.burialDate&&(e.self.burialDate=this.state.burialDate),this.state.burialPlace!==this.initial.burialPlace&&(e.self.burialPlace=this.state.burialPlace),e},t.prototype.handleSubmit=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,n,a;return i.__generator(this,(function(i){switch(i.label){case 0:if(e.preventDefault(),!this.hasCorrections())return this.setState({errorMessage:"Nothing has been corrected yet."}),[2];if(!ncom.user)return this.setState({errorMessage:"You must be logged in to submit a correction."}),[2];this.setState({submitting:!0}),i.label=1;case 1:return i.trys.push([1,3,,4]),t=this.getCorrected(),n={extractionKey:this.props.store.extractionKey,corrected:t,reason:this.state.selectedReasons.size>0?Array.from(this.state.selectedReasons):void 0},[4,m.ArticleDao.addObitCorrection(this.props.store.pageId,this.props.store.obitId,n)];case 2:return a=i.sent(),this.props.store.addSubmittedFields(t),this.props.store.addCorrection(ncom.user,a),this.props.onUpdateViewerData(),this.setInitialFromState(),this.resetAndClose(),[3,4];case 3:return i.sent(),this.setState({errorMessage:"An error occurred while saving your changes."}),[3,4];case 4:return this.setState({submitting:!1}),[2]}}))}))},t.prototype.cancel=function(){this.setStateFromInitial(),this.resetAndClose()},t.prototype.resetAndClose=function(){this.setState({errorMessage:null,selectedReasons:new Set,feedback:{firstName:this.defaultInputStatus,lastName:this.defaultInputStatus,maidenName:this.defaultInputStatus,suffix:this.defaultInputStatus,age:this.defaultInputStatus,birthPlace:this.defaultInputStatus,residencePlace:this.defaultInputStatus,marriagePlace:this.defaultInputStatus,deathPlace:this.defaultInputStatus,burialPlace:this.defaultInputStatus,relatives:new Map}}),this.props.store.setCorrectionType(null),this.props.store.setModalType("edit"),this.props.store.toggleCorrectionModal()},t.prototype.render=function(){var e=null,t=null;return"personal"===this.props.store.correctionType?(e=r.createElement(N,{firstName:this.state.firstName?this.state.firstName:"",lastName:this.state.lastName?this.state.lastName:"",maidenName:this.state.maidenName?this.state.maidenName:"",suffix:this.state.suffix?this.state.suffix:"",gender:this.state.gender?this.state.gender:"Unknown",handleOnChange:this.handleInputChange.bind(this),handleOnBlur:this.validateInput.bind(this),feedback:this.state.feedback}),t=new Map([["spelling","Spelling is wrong"],["notTranscribed","Missing from transcription"],["other","Other"]])):"birth"===this.props.store.correctionType?(e=r.createElement(x,{eventType:"birth",eventDateLabel:"Birthdate",eventPlaceLabel:"Birth Place",eventDateString:this.state.birthDate?this.state.birthDate:"",eventPlace:this.state.birthPlace?this.state.birthPlace:"",handleOnChange:this.handleInputChange.bind(this),handleDateChange:this.handleDateChange.bind(this),handleOnBlur:this.validateInput.bind(this),placeValid:"valid"===this.state.feedback.birthPlace.type,placeInvalid:!(!this.state.feedback.birthPlace.message||"invalid"!==this.state.feedback.birthPlace.type)}),t=new Map([["spelling","Spelling is wrong"],["dates","Dates are incorrect in the obituary"],["notTranscribed","Missing from transcription"],["other","Other"]])):"residence"===this.props.store.correctionType?(e=r.createElement(l.FormGroup,{row:!0},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted py-2 pr-sm-2"},"Residence:"),r.createElement(l.Col,{sm:8,className:"px-sm-1"},r.createElement(l.Input,{type:"text",name:"residencePlace",id:"residencePlace",value:this.state.residencePlace?this.state.residencePlace:"",onChange:this.handleInputChange.bind(this),onBlur:this.validateInput.bind(this),valid:"valid"===this.state.feedback.residencePlace.type,invalid:!(!this.state.feedback.residencePlace.message||"invalid"!==this.state.feedback.residencePlace.type)}))),t=new Map([["spelling","Spelling is wrong"],["notTranscribed","Missing from transcription"],["other","Other"]])):"marriage"===this.props.store.correctionType?(e=r.createElement(x,{eventType:"marriage",eventDateLabel:"Marriage Date",eventPlaceLabel:"Marriage Place",eventDateString:this.state.marriageDate?this.state.marriageDate:"",eventPlace:this.state.marriagePlace?this.state.marriagePlace:"",handleOnChange:this.handleInputChange.bind(this),handleDateChange:this.handleDateChange.bind(this),handleOnBlur:this.validateInput.bind(this),placeValid:"valid"===this.state.feedback.marriagePlace.type,placeInvalid:!(!this.state.feedback.marriagePlace.message||"invalid"!==this.state.feedback.marriagePlace.type)}),t=new Map([["spelling","Spelling is wrong"],["dates","Dates are incorrect in the obituary"],["notTranscribed","Missing from transcription"],["other","Other"]])):"death"===this.props.store.correctionType?(e=r.createElement(r.Fragment,null,r.createElement(x,{eventType:"death",eventDateLabel:"Death Date",eventPlaceLabel:"Death Place",eventDateString:this.state.deathDate?this.state.deathDate:"",eventPlace:this.state.deathPlace?this.state.deathPlace:"",handleOnChange:this.handleInputChange.bind(this),handleDateChange:this.handleDateChange.bind(this),handleOnBlur:this.validateInput.bind(this),placeValid:"valid"===this.state.feedback.deathPlace.type,placeInvalid:!(!this.state.feedback.deathPlace.message||"invalid"!==this.state.feedback.deathPlace.type)}),void 0!==this.state.age&&r.createElement(l.FormGroup,{row:!0},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted py-2 pr-sm-2"},"Age:"),r.createElement(l.Col,{sm:3,className:"px-sm-1"},r.createElement(l.Input,{type:"number",name:"age",id:"age",value:this.state.age,onChange:this.handleInputChange.bind(this),onBlur:this.validateInput.bind(this),valid:"valid"===this.state.feedback.age.type,invalid:!(!this.state.feedback.age.message||"invalid"!==this.state.feedback.age.type)})))),t=new Map([["spelling","Spelling is wrong"],["dates","Dates are incorrect in the obituary"],["notTranscribed","Missing from transcription"],["other","Other"]])):"burial"===this.props.store.correctionType?(e=r.createElement(x,{eventType:"burial",eventDateLabel:"Burial Date",eventPlaceLabel:"Burial Place",eventDateString:this.state.burialDate?this.state.burialDate:"",eventPlace:this.state.burialPlace?this.state.burialPlace:"",handleOnChange:this.handleInputChange.bind(this),handleDateChange:this.handleDateChange.bind(this),handleOnBlur:this.validateInput.bind(this),placeValid:"valid"===this.state.feedback.burialPlace.type,placeInvalid:!(!this.state.feedback.burialPlace.message||"invalid"!==this.state.feedback.burialPlace.type)}),t=new Map([["spelling","Spelling is wrong"],["dates","Dates are incorrect in the obituary"],["notTranscribed","Missing from transcription"],["other","Other"]])):"relatives"===this.props.store.correctionType&&(e=r.createElement(k,{relatives:this.props.store.relatives,feedback:this.state.feedback,handleOnChange:this.handleRelativeInputChange.bind(this),handleOnBlur:this.validateRelativeInput.bind(this)}),t=new Map([["relation","Relation is wrong"],["spelling","Spelling is wrong"]])),"add"===this.props.store.correctionModalType&&(t=new Map([["notTranscribed","This fact was not transcribed from the article"],["notMentioned","Additional information not mentioned in obituary"]])),r.createElement(r.Fragment,null,this.props.store.correctionModalOpen&&r.createElement(l.Modal,{isOpen:this.props.store.correctionModalOpen,size:"lg"},r.createElement(l.Form,{onSubmit:this.handleSubmit.bind(this)},r.createElement(l.ModalHeader,null,"add"===this.props.store.correctionModalType?"Add an additional fact":"Add an alternate"),r.createElement(l.ModalBody,{className:"flex-shrink-1 flex-grow-0"},"add"===this.props.store.correctionModalType&&r.createElement(l.FormGroup,{row:!0,className:"mt-3"},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted pl-sm-1 pr-sm-2 pt-sm-2"},r.createElement(l.Label,{for:"correctionType"},"Choose fact type:")),r.createElement(l.Col,{sm:6,className:"pl-sm-1"},r.createElement(l.Input,{type:"select",bsSize:"sm",name:"correctionType",id:"correctionType",value:this.props.store.correctionType?this.props.store.correctionType:"",onChange:this.handleCorrectionTypeChange.bind(this)},r.createElement("option",{disabled:!0,value:""},"Choose fact type"),!(this.initial.firstName&&this.initial.lastName&&this.initial.maidenName&&this.initial.suffix)&&r.createElement("option",{value:"personal"},"Personal"),!(this.initial.birthDate&&this.initial.birthPlace)&&r.createElement("option",{value:"birth"},"Birth"),!this.initial.residencePlace&&r.createElement("option",{value:"residence"},"Residence"),!(this.initial.marriageDate&&this.initial.marriagePlace)&&r.createElement("option",{value:"marriage"},"Marriage"),!(this.initial.deathDate&&this.initial.deathPlace)&&r.createElement("option",{value:"death"},"Death"),!(this.initial.burialDate&&this.initial.burialPlace)&&r.createElement("option",{value:"burial"},"Burial")))),e,r.createElement(P,{choices:t,selected:this.state.selectedReasons,handleChange:this.handleReasonChange.bind(this)}),this.state.errorMessage&&r.createElement(l.FormGroup,{row:!0},r.createElement(l.Col,null,r.createElement("p",{className:"alert alert-danger error_24"},this.state.errorMessage)))),r.createElement(l.ModalFooter,null,r.createElement(l.Button,{color:"dark",outline:!0,className:"rounded-pill",onClick:this.cancel.bind(this)},"Cancel"),r.createElement(l.Button,{color:"primary",className:"rounded-pill",type:"submit",disabled:!this.hasCorrections()||!this.isFormValid()||this.state.submitting},"Save")))))},t=i.__decorate([o.observer],t)}(r.Component);t.CorrectionModal=S;var N=function(e){return r.createElement(r.Fragment,null,r.createElement(l.FormGroup,{row:!0,className:"mb-0"},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted pt-sm-4 pl-sm-1 pr-sm-2 d-none d-sm-block"},"Name:"),r.createElement(l.Col,{sm:4,className:"px-sm-1"},r.createElement(l.Label,{for:"firstName",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-0"},"First name(s)")),r.createElement(l.Input,{type:"text",name:"firstName",id:"firstName",value:e.firstName,onChange:e.handleOnChange,onBlur:e.handleOnBlur,valid:"valid"===e.feedback.firstName.type,invalid:!(!e.feedback.firstName.message||"invalid"!==e.feedback.firstName.type)})),r.createElement(l.Col,{sm:4,className:"pl-sm-1"},r.createElement(l.Label,{for:"lastName",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-sm-0 pr-2 pt-3"},"Last name")),r.createElement(l.Input,{type:"text",name:"lastName",id:"lastName",value:e.lastName,onChange:e.handleOnChange,onBlur:e.handleOnBlur,valid:"valid"===e.feedback.lastName.type,invalid:!(!e.feedback.lastName.message||"invalid"!==e.feedback.lastName.type)}))),r.createElement(l.FormGroup,{row:!0},r.createElement(l.Col,{sm:{size:3,offset:3},className:"px-sm-1"},r.createElement(l.Label,{for:"maidenName",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-3 pt-sm-0"},"Maiden name")),r.createElement(l.Input,{type:"text",name:"maidenName",id:"maidenName",value:e.maidenName,onChange:e.handleOnChange,onBlur:e.handleOnBlur,valid:"valid"===e.feedback.maidenName.type,invalid:!(!e.feedback.maidenName.message||"invalid"!==e.feedback.maidenName.type)})),r.createElement(l.Col,{sm:2,className:"pl-sm-1"},r.createElement(l.Label,{for:"suffix",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-3 pr-2 pt-sm-0"},"Suffix")),r.createElement(l.Input,{type:"text",name:"suffix",id:"suffix",list:"suffixes",className:"d-inline-block",value:e.suffix,onChange:e.handleOnChange,onBlur:e.handleOnBlur,valid:"valid"===e.feedback.suffix.type,invalid:!(!e.feedback.suffix.message||"invalid"!==e.feedback.suffix.type)}),r.createElement("span",{className:"dropdown-toggle position-absolute mt-2 ml-n4"}),r.createElement("datalist",{id:"suffixes"},"or",r.createElement("label",null,"Choose one",r.createElement("option",null,"Jr"),r.createElement("option",null,"Sr"),r.createElement("option",null,"I"),r.createElement("option",null,"II"),r.createElement("option",null,"III"),r.createElement("option",null,"IV"),r.createElement("option",null,"V"),r.createElement("option",null,"VI"))))),r.createElement(l.FormGroup,{row:!0,className:"mt-2"},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted pl-sm-1 pr-sm-2"},"Gender:"),r.createElement(l.Col,{sm:8,className:"pl-sm-1"},r.createElement(l.FormGroup,{check:!0,inline:!0},r.createElement(l.Label,{check:!0},r.createElement(l.Input,{type:"radio",name:"gender",value:"Male",checked:"Male"==e.gender,onChange:e.handleOnChange,className:"mr-0"})," ","Male")),r.createElement(l.FormGroup,{check:!0,inline:!0},r.createElement(l.Label,{check:!0},r.createElement(l.Input,{type:"radio",name:"gender",value:"Female",checked:"Female"==e.gender,onChange:e.handleOnChange,className:"mr-0"})," ","Female")),r.createElement(l.FormGroup,{check:!0,inline:!0},r.createElement(l.Label,{check:!0},r.createElement(l.Input,{type:"radio",name:"gender",value:"Other",checked:"Other"==e.gender,onChange:e.handleOnChange,className:"mr-0"})," ","Other")),r.createElement(l.FormGroup,{check:!0,inline:!0},r.createElement(l.Label,{check:!0},r.createElement(l.Input,{type:"radio",name:"gender",value:"Unknown",checked:"Unknown"==e.gender,onChange:e.handleOnChange,className:"mr-0"})," ","Unknown")))))},x=function(e){var t="".concat(e.eventType,"Date"),n="".concat(e.eventType,"Place"),a=(0,u.parseISO)(e.eventDateString);return r.createElement(r.Fragment,null,r.createElement(l.FormGroup,{row:!0},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted py-2 pr-sm-2"},e.eventDateLabel,":"),r.createElement(l.Col,{sm:8,className:"px-sm-1"},r.createElement(c.default,{name:t,id:t,selected:(0,u.isValid)(a)?a:null,placeholderText:e.eventDateString&&!(0,u.isValid)(a)?e.eventDateString:null,dateFormat:"dd MMMM, yyyy",className:"form-control",maxDate:new Date,onChange:function(n){return e.handleDateChange(n,t)}}))),r.createElement(l.FormGroup,{row:!0},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted py-2 pr-sm-2"},e.eventPlaceLabel,":"),r.createElement(l.Col,{sm:8,className:"px-sm-1"},r.createElement(l.Input,{type:"text",name:n,id:n,value:e.eventPlace,onChange:e.handleOnChange,onBlur:e.handleOnBlur,valid:e.placeValid,invalid:e.placeInvalid}))))},k=function(e){return r.createElement(r.Fragment,null,r.createElement(l.Row,{className:"mb-0"},r.createElement(l.Col,{sm:3,className:"text-sm text-uppercase text-muted pt-sm-4 pl-sm-1 pr-sm-2 d-none d-sm-block"},"Relationship"),r.createElement(l.Col,{sm:4,className:"text-sm text-uppercase text-muted pt-sm-4 pl-sm-1 pr-sm-2 d-none d-sm-block"},"First Name"),r.createElement(l.Col,{sm:4,className:"text-sm text-uppercase text-muted pt-sm-4 pl-sm-1 pr-sm-2 d-none d-sm-block"},"Last Name")),i.__spreadArray([],i.__read(e.relatives.values()),!1).map((function(t,n){var a=!1,i=!1,o=!1,s=!1;if(e.feedback.relatives.has(t.pid)){var c=e.feedback.relatives.get(t.pid);c.givenName&&(a="valid"===c.givenName.type,i=c.givenName.message&&"invalid"===c.givenName.type),c.surname&&(o="valid"===c.surname.type,s=c.surname.message&&"invalid"===c.surname.type)}return r.createElement(l.FormGroup,{key:n,row:!0,className:"mb-0"},r.createElement(l.Col,{sm:3,className:"px-sm-1"},r.createElement(l.Input,{type:"select",bsSize:"sm",name:"".concat(t.pid,":relationship"),id:"".concat(t.pid,":relationship"),value:t.relationship,onChange:function(n){return e.handleOnChange(n,t.pid,"relationship")},onBlur:function(n){return e.handleOnBlur(n,t.pid,"relationship")}},r.createElement("option",{value:"parents"},"Parent"),r.createElement("option",{value:"spouses"},"Spouse"),r.createElement("option",{value:"siblings"},"Sibling"),r.createElement("option",{value:"children"},"Child"))),r.createElement(l.Col,{sm:4,className:"px-sm-1"},r.createElement(l.Input,{type:"text",name:"".concat(t.pid,":givenName"),id:"".concat(t.pid,":givenName"),value:t.givenName,onChange:function(n){return e.handleOnChange(n,t.pid,"givenName")},onBlur:function(n){return e.handleOnBlur(n,t.pid,"givenName")},valid:a,invalid:i})),r.createElement(l.Col,{sm:4,className:"pl-sm-1"},r.createElement(l.Input,{type:"text",name:"".concat(t.pid,":surname"),id:"".concat(t.pid,":surname"),value:t.surname,onChange:function(n){return e.handleOnChange(n,t.pid,"surname")},onBlur:function(n){return e.handleOnBlur(n,t.pid,"surname")},valid:o,invalid:s})))})))},P=function(e){return e.choices&&e.choices.size>0?r.createElement(l.FormGroup,{row:!0},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted pl-sm-1 pr-sm-2"},"Reason:"),r.createElement(l.Col,{xs:{size:11,offset:1},sm:{size:8,offset:0},className:"pl-sm-1"},r.createElement("fieldset",null,Array.from(e.choices.entries()).map((function(t,n){return r.createElement(d.ReasonCheckbox,{key:n,label:t[1],checked:e.selected.has(t[0]),handleChange:e.handleChange.bind(a,t[0])})}))))):null},I=function(e){function t(t){var n=e.call(this,t)||this;return n.setWrapperRef=n.setWrapperRef.bind(n),n.handleClickOutside=n.handleClickOutside.bind(n),n}return i.__extends(t,e),t.prototype.componentDidMount=function(){document.addEventListener("touchend",this.handleClickOutside),document.addEventListener("mousedown",this.handleClickOutside)},t.prototype.componentWillUnmount=function(){document.removeEventListener("touchend",this.handleClickOutside),document.removeEventListener("mousedown",this.handleClickOutside)},t.prototype.setWrapperRef=function(e){this.wrapperRef=e},t.prototype.handleClickOutside=function(e){this.wrapperRef&&!this.wrapperRef.contains(e.target)&&this.props.handleClick()},t.prototype.render=function(){var e="birthDate"===this.props.type||"marriageDate"===this.props.type||"deathDate"===this.props.type||"burialDate"===this.props.type;return r.createElement("div",{ref:this.setWrapperRef,className:"alternates position-absolute popover popover-custom shadow bs-popover-bottom mt-4",role:"tooltip"},r.createElement("div",{className:"arrow",style:{left:"90%"}}),r.createElement("div",{className:"popover-body"},r.createElement("h6",{className:"text-uppercase text-muted pr-4 mb-0"},"Alternate ",b.get(this.props.type)),this.props.alternates.map((function(t,n){return r.createElement(l.Row,{key:n,className:"border-bottom align-items-center"},r.createElement(l.Col,{xs:7,className:"py-2"},r.createElement("span",{className:"altValue"},e?(0,h.getDisplayDate)(t.value):t.value)),r.createElement(l.Col,{xs:5,className:"text-right"},r.createElement("small",null,r.createElement("p",{className:"text-muted m-0"},"Added by ",r.createElement("a",{href:"/profile/".concat(t.username),className:"altAttribution text-muted"},t.username)))))})),this.props.original&&r.createElement(l.Row,{className:"align-items-center"},r.createElement(l.Col,{className:"py-2"},r.createElement("span",null,e?(0,h.getDisplayDate)(this.props.original):this.props.original)),r.createElement(l.Col,{className:"text-right"},r.createElement("small",null,r.createElement("p",{className:"text-muted m-0"},"Original"))))))},t}(r.Component);t.Alternates=I},604:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObituaryStore=void 0;var a=n(3),i=n(8),r=n(195),o=n(20),s=n(15),l=function(){function e(e,t){var n,i;if(this.rawToSelfFieldMap=new Map([["GivenName","givenName"],["Surname","surname"],["MaidenName","maidenName"],["Suffix","suffix"],["Gender","gender"],["Age","age"],["BirthDates","birthDate"],["BirthPlaces","birthPlace"],["ResidencePlaces","residencePlace"],["MarriageDates","marriageDate"],["MarriagePlaces","marriagePlace"],["DeathDates","deathDate"],["DeathPlaces","deathPlace"],["BurialDates","burialDate"],["BurialPlaces","burialPlace"]]),this.rawToRelativeFieldMap=new Map([["GivenName","givenName"],["Surname","surname"],["Gender","gender"]]),this.pageId=e,this.obitId=t.id,this.extractionKey=t.extractionKey,this.self=t.extraction.self,this.parents=t.extraction.parents?t.extraction.parents:[],this.spouses=t.extraction.spouses?t.extraction.spouses:[],this.siblings=t.extraction.siblings?t.extraction.siblings:[],this.children=t.extraction.children?t.extraction.children:[],this.corrections=new Map,t.corrections)try{for(var r=a.__values(Object.entries(t.corrections)),o=r.next();!o.done;o=r.next()){var s=a.__read(o.value,2),l=s[0],c=s[1];this.corrections.set(Number(l),c)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}this.submittedFields=new Array,this.correctionMode=!1,this.correctionModalOpen=!1,this.correctionModalType="edit",this.correctionType=null,this.alternatesOpen=!1,this.alternatesFieldType=null,this.usernameMap=new Map,this.loadUsernames(a.__spreadArray([],a.__read(this.corrections.keys()),!1).filter((function(e){return!(ncom.user&&Number(e)===ncom.user)})).map((function(e){return Number(e)})))}return e.prototype.addCorrection=function(e,t){this.corrections.has(e)?this.corrections.get(e).push(t):this.corrections.set(e,[t])},e.prototype.addSubmittedFields=function(e){var t=this.submittedFields;Object.keys(e.self).forEach((function(e){t.push(e)})),this.submittedFields=t},e.prototype.toggleCorrectionMode=function(){this.correctionMode=!this.correctionMode},e.prototype.toggleCorrectionModal=function(){this.correctionModalOpen=!this.correctionModalOpen},e.prototype.setModalType=function(e){this.correctionModalType=e},e.prototype.setCorrectionType=function(e){this.correctionType=e},e.prototype.toggleAlternatesPopup=function(e){this.alternatesOpen=!this.alternatesOpen,this.alternatesFieldType=e},e.prototype.loadUsernames=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n=this;return a.__generator(this,(function(i){switch(i.label){case 0:return t=new Set,e.forEach((function(e){n.usernameMap.has(e)||t.add(e)})),t.size>0?[4,s.AccountDao.getUsernames(a.__spreadArray([],a.__read(t),!1))]:[3,2];case 1:i.sent().forEach((function(e){n.usernameMap.set(e.userId,e.username)})),i.label=2;case 2:return[2]}}))}))},e.prototype.getExtractedField=function(e,t){switch(t){case"givenName":return e.GivenName?e.GivenName[0]:null;case"surname":return e.Surname?e.Surname[0]:null;case"maidenName":return e.MaidenName?e.MaidenName[0]:null;case"suffix":return e.Suffix?e.Suffix[0]:null;case"gender":return e.Gender;case"age":return e.Age;case"birthDate":return e.BirthDates&&e.BirthDates.length>0&&e.BirthDates[0].Year&&e.BirthDates[0].Month&&e.BirthDates[0].Day?(0,o.format)((0,o.parse)("".concat(e.BirthDates[0].Year,"-").concat(e.BirthDates[0].Month,"-").concat(e.BirthDates[0].Day),"yyyy-M-d",new Date),"yyyy-MM-dd"):null;case"birthPlace":return e.BirthPlaces?e.BirthPlaces[0]:null;case"residencePlace":return e.ResidencePlaces?e.ResidencePlaces[0]:null;case"marriageDate":return e.MarriageDates&&e.MarriageDates.length>0&&e.MarriageDates[0].Year&&e.MarriageDates[0].Month&&e.MarriageDates[0].Day?(0,o.format)((0,o.parse)("".concat(e.MarriageDates[0].Year,"-").concat(e.MarriageDates[0].Month,"-").concat(e.MarriageDates[0].Day),"yyyy-M-d",new Date),"yyyy-MM-dd"):null;case"marriagePlace":return e.MarriagePlaces?e.MarriagePlaces[0]:null;case"deathDate":return e.DeathDates&&e.DeathDates.length>0&&e.DeathDates[0].Year&&e.DeathDates[0].Month&&e.DeathDates[0].Day?(0,o.format)((0,o.parse)("".concat(e.DeathDates[0].Year,"-").concat(e.DeathDates[0].Month,"-").concat(e.DeathDates[0].Day),"yyyy-M-d",new Date),"yyyy-MM-dd"):null;case"deathPlace":return e.DeathPlaces?e.DeathPlaces[0]:null;case"burialDate":return e.BurialDates&&e.BurialDates.length>0&&e.BurialDates[0].Year&&e.BurialDates[0].Month&&e.BurialDates[0].Day?(0,o.format)((0,o.parse)("".concat(e.BurialDates[0].Year,"-").concat(e.BurialDates[0].Month,"-").concat(e.BurialDates[0].Day),"yyyy-M-d",new Date),"yyyy-MM-dd"):null;case"burialPlace":return e.BurialPlaces?e.BurialPlaces[0]:null}},Object.defineProperty(e.prototype,"hasAlternates",{get:function(){return this.corrections.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){var e=this,t=this.obituaryData,n=t.self.has("givenName")?t.self.get("givenName"):{},i=t.self.has("surname")?t.self.get("surname"):{},o=t.self.has("suffix")?t.self.get("suffix"):{},s="";n.extracted&&(s+=n.extracted),i.extracted&&(s+=" ".concat(i.extracted)),o.extracted&&(s+=" ".concat(o.extracted));var l=(0,r.getLatestAlternate)(n.alternates,ncom.user?ncom.user:0),c=(0,r.getLatestAlternate)(i.alternates,ncom.user?ncom.user:0),p=(0,r.getLatestAlternate)(o.alternates,ncom.user?ncom.user:0),d=new Array,m=n.alternates?n.alternates.map((function(e){return e.userId})):[],u=i.alternates?i.alternates.map((function(e){return e.userId})):[],h=o.alternates?o.alternates.map((function(e){return e.userId})):[];new Set(a.__spreadArray(a.__spreadArray(a.__spreadArray([],a.__read(m),!1),a.__read(u),!1),a.__read(h),!1)).forEach((function(t){var a=(0,r.getLatestAlternate)(n.alternates,t),s=(0,r.getLatestAlternate)(i.alternates,t),l=(0,r.getLatestAlternate)(o.alternates,t),c=e.getAlternateName(n.extracted,i.extracted,o.extracted,a,s,l);if(c){var p=e.usernameMap.get(t);d.push({userId:t,username:p,value:c})}}));var g=this.getAlternateName(n.extracted,i.extracted,o.extracted,l,c,p);return{value:g||s,extractedValue:s,alternates:d.sort((function(e,t){return ncom.user&&e.userId===ncom.user&&t.userId!==ncom.user?-1:ncom.user&&e.userId!==ncom.user&&t.userId===ncom.user?1:0}))}},enumerable:!1,configurable:!0}),e.prototype.getAlternateName=function(e,t,n,a,i,r){var o="";return(a||i||r)&&((a||e)&&(o+=a?a.value:e),(i||t)&&(o+=" ".concat(i?i.value:t)),(r||n)&&(o+=" ".concat(r?r.value:n))),o},Object.defineProperty(e.prototype,"givenName",{get:function(){return this.getSelfField("givenName")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"surname",{get:function(){return this.getSelfField("surname")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maidenName",{get:function(){return this.getSelfField("maidenName")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"suffix",{get:function(){return this.getSelfField("suffix")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gender",{get:function(){return this.getSelfField("gender")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"age",{get:function(){return this.getSelfField("age")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"birthDate",{get:function(){return this.getSelfField("birthDate")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"birthPlace",{get:function(){return this.getSelfField("birthPlace")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"residencePlace",{get:function(){return this.getSelfField("residencePlace")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"marriageDate",{get:function(){return this.getSelfField("marriageDate")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"marriagePlace",{get:function(){return this.getSelfField("marriagePlace")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deathDate",{get:function(){return this.getSelfField("deathDate")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deathPlace",{get:function(){return this.getSelfField("deathPlace")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"burialDate",{get:function(){return this.getSelfField("burialDate")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"burialPlace",{get:function(){return this.getSelfField("burialPlace")},enumerable:!1,configurable:!0}),e.prototype.getSelfField=function(e){var t=this,n=this.obituaryData;if(n.self.has(e)){var a=n.self.get(e),i=a.extracted,o=(0,r.reduceAlternates)(a.alternates),s=(0,r.getLatestAlternate)(a.alternates,ncom.user?ncom.user:0);return{value:s?s.value:i,extractedValue:i,alternates:o.sort((function(e,t){return ncom.user&&e.userId===ncom.user&&t.userId!==ncom.user?-1:ncom.user&&e.userId!==ncom.user&&t.userId===ncom.user?1:0})).map((function(e){return{username:t.usernameMap.get(e.userId),value:e.value}}))}}return{}},Object.defineProperty(e.prototype,"relatives",{get:function(){var e,t,n=this.obituaryData,i=new Map;if(n.relatives&&n.relatives.size>0)try{for(var r=a.__values(n.relatives.entries()),o=r.next();!o.done;o=r.next()){var s=a.__read(o.value,2),l=s[0],c=s[1];i.set(l,{pid:l,givenName:this.getRelativeField(c,"givenName"),surname:this.getRelativeField(c,"surname"),gender:this.getRelativeField(c,"gender"),relationship:this.getRelativeField(c,"relationship")})}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},enumerable:!1,configurable:!0}),e.prototype.getRelativeField=function(e,t){if(e.has(t)){var n=e.get(t);return n.alternates&&n.alternates.length>0?(0,r.getLatestAlternate)(n.alternates,ncom.user?ncom.user:0).value:n&&n.extracted?n.extracted:""}return""},Object.defineProperty(e.prototype,"obituaryData",{get:function(){var e,t,n,i,r,s,l,c,p={self:new Map,relatives:new Map};try{for(var d=a.__values(Object.keys(this.self)),m=d.next();!m.done;m=d.next()){var u=m.value,h=this.rawToSelfFieldMap.get(u),g=this.getExtractedField(this.self,h);g&&p.self.set(h,{extracted:g})}}catch(t){e={error:t}}finally{try{m&&!m.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}if(this.parseExtractedRelatives(p,"parents",this.parents),this.parseExtractedRelatives(p,"spouses",this.spouses),this.parseExtractedRelatives(p,"siblings",this.siblings),this.parseExtractedRelatives(p,"children",this.children),this.corrections.size>0)try{for(var f=a.__values(this.corrections.keys()),b=f.next();!b.done;b=f.next()){var y=b.value;try{for(var v=(r=void 0,a.__values(this.corrections.get(y))),_=v.next();!_.done;_=v.next()){var E=_.value;if(E.corrected&&E.corrected.self)try{for(var w=(l=void 0,a.__values(Object.entries(E.corrected.self))),C=w.next();!C.done;C=w.next()){var S=a.__read(C.value,2),N=(u=S[0],S[1]),x=(h=u,{userId:Number(y),value:N,correctionId:E.correctionId,modified:(0,o.parseISO)(E.modified)});if(p.self.has(h)){var k=p.self.get(h);k.alternates&&k.alternates.length>0?k.alternates.push(x):k.alternates=[x]}else p.self.set(h,{alternates:[x]})}}catch(e){l={error:e}}finally{try{C&&!C.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}}}catch(e){r={error:e}}finally{try{_&&!_.done&&(s=v.return)&&s.call(v)}finally{if(r)throw r.error}}}}catch(e){n={error:e}}finally{try{b&&!b.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}return p},enumerable:!1,configurable:!0}),e.prototype.parseExtractedRelatives=function(e,t,n){var i=this;n&&n.length>0&&n.forEach((function(n,r){var o,s,l="".concat(t,":").concat(r);try{for(var c=a.__values(Object.keys(n)),p=c.next();!p.done;p=c.next()){var d=p.value,m=i.rawToRelativeFieldMap.get(d),u=i.getExtractedField(n,m);u&&(e.relatives.has(l)?e.relatives.get(l).set(m,{extracted:u}):e.relatives.set(l,new Map([[m,{extracted:u}]])))}}catch(e){o={error:e}}finally{try{p&&!p.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}e.relatives.has(l)&&e.relatives.get(l).set("relationship",{extracted:t})}))},e.prototype.parseRelativeCorrections=function(e,t,n,i,r){var s,l,c,p;if(i)try{for(var d=a.__values(Object.entries(i)),m=d.next();!m.done;m=d.next()){var u=a.__read(m.value,2),h=u[0],g=u[1],f="".concat(r,":").concat(h);try{for(var b=(c=void 0,a.__values(Object.entries(g))),y=b.next();!y.done;y=b.next()){var v=a.__read(y.value,2),_=v[0],E=v[1],w=_,C={userId:Number(t),value:E,correctionId:n.correctionId,modified:(0,o.parseISO)(n.modified)};if(e.relatives.has(f)){var S=e.relatives.get(f);if(S.has(w)){var N=S.get(w);N.alternates?N.alternates.push(C):N.alternates=[C]}else S.set(w,{alternates:[C]})}else e.relatives.set(f,new Map([[w,{alternates:[C]}]]))}}catch(e){c={error:e}}finally{try{y&&!y.done&&(p=b.return)&&p.call(b)}finally{if(c)throw c.error}}}}catch(e){s={error:e}}finally{try{m&&!m.done&&(l=d.return)&&l.call(d)}finally{if(s)throw s.error}}},a.__decorate([i.observable],e.prototype,"corrections",void 0),a.__decorate([i.observable],e.prototype,"submittedFields",void 0),a.__decorate([i.observable],e.prototype,"correctionMode",void 0),a.__decorate([i.observable],e.prototype,"correctionModalOpen",void 0),a.__decorate([i.observable],e.prototype,"correctionModalType",void 0),a.__decorate([i.observable],e.prototype,"correctionType",void 0),a.__decorate([i.observable],e.prototype,"alternatesOpen",void 0),a.__decorate([i.observable],e.prototype,"alternatesFieldType",void 0),a.__decorate([i.observable],e.prototype,"usernameMap",void 0),a.__decorate([i.action],e.prototype,"addCorrection",null),a.__decorate([i.action],e.prototype,"addSubmittedFields",null),a.__decorate([i.action],e.prototype,"toggleCorrectionMode",null),a.__decorate([i.action],e.prototype,"toggleCorrectionModal",null),a.__decorate([i.action],e.prototype,"setModalType",null),a.__decorate([i.action],e.prototype,"setCorrectionType",null),a.__decorate([i.action],e.prototype,"toggleAlternatesPopup",null),a.__decorate([i.action],e.prototype,"loadUsernames",null),a.__decorate([i.computed],e.prototype,"hasAlternates",null),a.__decorate([i.computed],e.prototype,"name",null),a.__decorate([i.computed],e.prototype,"givenName",null),a.__decorate([i.computed],e.prototype,"surname",null),a.__decorate([i.computed],e.prototype,"maidenName",null),a.__decorate([i.computed],e.prototype,"suffix",null),a.__decorate([i.computed],e.prototype,"gender",null),a.__decorate([i.computed],e.prototype,"age",null),a.__decorate([i.computed],e.prototype,"birthDate",null),a.__decorate([i.computed],e.prototype,"birthPlace",null),a.__decorate([i.computed],e.prototype,"residencePlace",null),a.__decorate([i.computed],e.prototype,"marriageDate",null),a.__decorate([i.computed],e.prototype,"marriagePlace",null),a.__decorate([i.computed],e.prototype,"deathDate",null),a.__decorate([i.computed],e.prototype,"deathPlace",null),a.__decorate([i.computed],e.prototype,"burialDate",null),a.__decorate([i.computed],e.prototype,"burialPlace",null),a.__decorate([i.computed],e.prototype,"relatives",null),a.__decorate([i.computed],e.prototype,"obituaryData",null),e}();t.ObituaryStore=l},605:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarriageStore=void 0;var a=n(3),i=n(8),r=n(195),o=n(20),s=n(15),l=function(){function e(e,t){var n,i;if(this.pageId=e,this.marriageId=t.id,t.articleId&&(this.articleId=t.articleId),this.extractionKey=t.extractionKey,this.marriage=t.marriage,this.corrections=new Map,t.corrections)try{for(var r=a.__values(Object.entries(t.corrections)),o=r.next();!o.done;o=r.next()){var s=a.__read(o.value,2),l=s[0],c=s[1];this.corrections.set(Number(l),c)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}this.submittedFields=new Array,this.correctionMode=!1,this.correctionModalOpen=!1,this.correctionModalType="edit",this.correctionType=null,this.alternatesOpen=!1,this.alternatesFieldType=null,this.usernameMap=new Map,this.loadUsernames(a.__spreadArray([],a.__read(this.corrections.keys()),!1).filter((function(e){return!(ncom.user&&Number(e)===ncom.user)})).map((function(e){return Number(e)})))}return e.prototype.addCorrection=function(e,t){this.corrections.has(e)?this.corrections.get(e).push(t):this.corrections.set(e,[t])},e.prototype.addSubmittedFields=function(e){var t=this.submittedFields;Object.keys(e).forEach((function(e){"self"===e?t.push("selfName"):"spouse"===e?t.push("spouseName"):t.push(e)})),this.submittedFields=t},e.prototype.toggleCorrectionMode=function(){this.correctionMode=!this.correctionMode},e.prototype.toggleCorrectionModal=function(){this.correctionModalOpen=!this.correctionModalOpen},e.prototype.setModalType=function(e){this.correctionModalType=e},e.prototype.setCorrectionType=function(e){this.correctionType=e},e.prototype.toggleAlternatesPopup=function(e){this.alternatesOpen=!this.alternatesOpen,this.alternatesFieldType=e},e.prototype.loadUsernames=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n=this;return a.__generator(this,(function(i){switch(i.label){case 0:return t=new Set,e.forEach((function(e){n.usernameMap.has(e)||t.add(e)})),t.size>0?[4,s.AccountDao.getUsernames(a.__spreadArray([],a.__read(t),!1))]:[3,2];case 1:i.sent().forEach((function(e){n.usernameMap.set(e.userId,e.username)})),i.label=2;case 2:return[2]}}))}))},Object.defineProperty(e.prototype,"hasAlternates",{get:function(){return this.corrections.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfName",{get:function(){return this.getNewlywedName("self",this.marriage.self)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spouseName",{get:function(){return this.getNewlywedName("spouse",this.marriage.spouse)},enumerable:!1,configurable:!0}),e.prototype.getNewlywedName=function(e,t){var n=this,i="";t.givenName&&(i+=t.givenName),t.maidenName&&(i+=" (".concat(t.maidenName,")")),t.surname&&(i+=" ".concat(t.surname)),t.suffix&&(i+=" ".concat(t.suffix));var o=this.alternatesMap,s=o.has("".concat(e,"GivenName"))?o.get("".concat(e,"GivenName")):[],l=o.has("".concat(e,"MaidenName"))?o.get("".concat(e,"MaidenName")):[],c=o.has("".concat(e,"Surname"))?o.get("".concat(e,"Surname")):[],p=o.has("".concat(e,"Suffix"))?o.get("".concat(e,"Suffix")):[],d=new Array,m=s.map((function(e){return e.userId})),u=l.map((function(e){return e.userId})),h=c.map((function(e){return e.userId})),g=p.map((function(e){return e.userId}));new Set(a.__spreadArray(a.__spreadArray(a.__spreadArray(a.__spreadArray([],a.__read(m),!1),a.__read(u),!1),a.__read(h),!1),a.__read(g),!1)).forEach((function(e){var a=(0,r.getLatestAlternate)(s,e),i=(0,r.getLatestAlternate)(l,e),o=(0,r.getLatestAlternate)(c,e),m=(0,r.getLatestAlternate)(p,e),u=n.getAlternateName(t.givenName,t.maidenName,t.surname,t.suffix,a,i,o,m);u&&d.push({userId:e,username:n.getUsername(e),value:u})}));var f=(0,r.getLatestAlternate)(s,ncom.user?ncom.user:0),b=(0,r.getLatestAlternate)(l,ncom.user?ncom.user:0),y=(0,r.getLatestAlternate)(c,ncom.user?ncom.user:0),v=(0,r.getLatestAlternate)(p,ncom.user?ncom.user:0),_=this.getAlternateName(t.givenName,t.maidenName,t.surname,t.suffix,f,b,y,v);return{value:_||i,extractedValue:i,alternates:d.sort((function(e,t){return ncom.user&&e.userId===ncom.user&&t.userId!==ncom.user?-1:ncom.user&&e.userId!==ncom.user&&t.userId===ncom.user?1:0}))}},e.prototype.getAlternateName=function(e,t,n,a,i,r,o,s){var l="";return(i||o||r||s)&&((i||e)&&(l+=i?i.value:e),(r||t)&&(l+=" (".concat(r?r.value:t,")")),(o||n)&&(l+=" ".concat(o?o.value:n)),(s||a)&&(l+=" ".concat(s?s.value:a))),l},e.prototype.getUsername=function(e){return this.usernameMap.get(e)},Object.defineProperty(e.prototype,"selfTitle",{get:function(){return this.getCorrectableDisplayField("selfTitle",this.marriage.self.title)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfGivenName",{get:function(){return this.getCorrectableDisplayField("selfGivenName",this.marriage.self.givenName)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSurname",{get:function(){return this.getCorrectableDisplayField("selfSurname",this.marriage.self.surname)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSuffix",{get:function(){return this.getCorrectableDisplayField("selfSuffix",this.marriage.self.suffix)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfMaidenName",{get:function(){return this.getCorrectableDisplayField("selfMaidenName",this.marriage.self.maidenName)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfNickname",{get:function(){var e=this.marriage.self.nicknames&&this.marriage.self.nicknames.length>0?this.marriage.self.nicknames.shift():"";return this.getCorrectableDisplayField("selfNickname",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfGender",{get:function(){return this.getCorrectableDisplayField("selfGender",this.marriage.self.gender)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spouseTitle",{get:function(){return this.getCorrectableDisplayField("spouseTitle",this.marriage.spouse.title)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spouseGivenName",{get:function(){return this.getCorrectableDisplayField("spouseGivenName",this.marriage.spouse.givenName)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spouseSurname",{get:function(){return this.getCorrectableDisplayField("spouseSurname",this.marriage.spouse.surname)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spouseSuffix",{get:function(){return this.getCorrectableDisplayField("spouseSuffix",this.marriage.spouse.suffix)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spouseMaidenName",{get:function(){return this.getCorrectableDisplayField("spouseMaidenName",this.marriage.spouse.maidenName)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spouseNickname",{get:function(){var e=this.marriage.spouse.nicknames&&this.marriage.spouse.nicknames.length>0?this.marriage.spouse.nicknames.shift():"";return this.getCorrectableDisplayField("spouseNickname",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spouseGender",{get:function(){return this.getCorrectableDisplayField("spouseGender",this.marriage.spouse.gender)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ceremonyVenue",{get:function(){return this.getCorrectableDisplayField("ceremonyVenue",this.marriage.ceremonyVenue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"honeymoonPlace",{get:function(){return this.getCorrectableDisplayField("honeymoonPlace",this.marriage.honeymoonPlace)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"licenseDate",{get:function(){return this.getCorrectableDisplayField("licenseDate",this.parseDate(this.marriage.licenseDate))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"licensePlace",{get:function(){return this.getCorrectableDisplayField("licensePlace",this.marriage.licensePlace)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"marriagePlace",{get:function(){return this.getCorrectableDisplayField("marriagePlace",this.marriage.marriagePlace)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"weddingDate",{get:function(){return this.getCorrectableDisplayField("weddingDate",this.parseDate(this.marriage.weddingDate))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"receptionVenue",{get:function(){return this.getCorrectableDisplayField("receptionVenue",this.marriage.receptionVenue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"engagementDate",{get:function(){return this.getCorrectableDisplayField("engagementDate",this.parseDate(this.marriage.engagementDate))},enumerable:!1,configurable:!0}),e.prototype.parseDate=function(e){if(e&&e.inferred&&e.inferred.year&&e.inferred.month&&e.inferred.day){var t=(0,o.parse)("".concat(e.inferred.year,"-").concat(e.inferred.month,"-").concat(e.inferred.day),"yyyy-M-d",new Date);if((0,o.isDate)(t)&&(0,o.isValid)(t))return(0,o.format)(t,"yyyy-MM-dd")}if(e){var n=(0,o.parseISO)(e.value);return(0,o.isDate)(n)&&(0,o.isValid)(n)?(0,o.format)(n,"yyyy-MM-dd"):e.value}return""},Object.defineProperty(e.prototype,"parents",{get:function(){var e=this.getRelatives(this.marriage.self.parents,"self","parents"),t=this.getRelatives(this.marriage.spouse.parents,"spouse","parents"),n=this.marriage.newlyweds?this.getRelatives(this.marriage.newlyweds.parents,"newlyweds","parents"):[];return a.__spreadArray(a.__spreadArray(a.__spreadArray([],a.__read(e),!1),a.__read(t),!1),a.__read(n),!1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"siblings",{get:function(){var e=this.getRelatives(this.marriage.self.siblings,"self","siblings"),t=this.getRelatives(this.marriage.spouse.siblings,"spouse","siblings"),n=this.marriage.newlyweds?this.getRelatives(this.marriage.newlyweds.siblings,"newlyweds","siblings"):[];return a.__spreadArray(a.__spreadArray(a.__spreadArray([],a.__read(e),!1),a.__read(t),!1),a.__read(n),!1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){var e=this.getRelatives(this.marriage.self.children,"self","children"),t=this.getRelatives(this.marriage.spouse.children,"spouse","children"),n=this.marriage.newlyweds?this.getRelatives(this.marriage.newlyweds.children,"newlyweds","children"):[];return a.__spreadArray(a.__spreadArray(a.__spreadArray([],a.__read(e),!1),a.__read(t),!1),a.__read(n),!1)},enumerable:!1,configurable:!0}),e.prototype.getRelatives=function(e,t,n){var a=new Array;if(e&&e.length>0)for(var i=0;i<e.length;i++){var r=e[i];a.push({pid:"".concat(t,":").concat(n,":").concat(i),title:r.title,givenName:r.givenName,surname:r.surname,gender:r.gender,relationship:n}),r.spouse&&a.push({pid:"".concat(t,":").concat(n,":").concat(i,":spouse"),title:r.spouse.title,givenName:r.spouse.givenName,surname:r.spouse.surname,gender:r.spouse.gender,relationship:n})}return a},Object.defineProperty(e.prototype,"officiant",{get:function(){if(this.marriage.officiant&&this.marriage.officiant.length>0){var e=this.marriage.officiant.shift();return{title:e.title,givenName:e.givenName,surname:e.surname}}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"brideAttire",{get:function(){return this.marriage.brideAttire&&this.marriage.brideAttire.length>0?this.marriage.brideAttire:[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flowers",{get:function(){return this.marriage.flowers&&this.marriage.flowers.length>0?this.marriage.flowers:[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"weddingParty",{get:function(){return this.marriage.weddingParty&&this.marriage.weddingParty.length>0?this.marriage.weddingParty.map((function(e){return{title:e.title,givenName:e.givenName,surname:e.surname}})):[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"otherPeople",{get:function(){return this.marriage.otherPeople&&this.marriage.otherPeople.length>0?this.marriage.otherPeople.map((function(e){return{title:e.title,givenName:e.givenName,surname:e.surname}})):[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schools",{get:function(){var e=new Array;return this.marriage.self.schools&&this.marriage.self.schools.length>0&&(e=e.concat(this.marriage.self.schools.filter((function(e){return e.name})).map(this.toDisplaySchool))),this.marriage.spouse.schools&&this.marriage.spouse.schools.length>0&&(e=e.concat(this.marriage.spouse.schools.filter((function(e){return e.name})).map(this.toDisplaySchool))),e},enumerable:!1,configurable:!0}),e.prototype.toDisplaySchool=function(e){var t={name:e.name};return e.graduationDate&&e.graduationDate.inferred&&e.graduationDate.inferred.year&&(t.graduationYear=e.graduationDate.inferred.year),t},Object.defineProperty(e.prototype,"employers",{get:function(){var e=new Array;return this.marriage.self.employers&&this.marriage.self.employers.length>0&&(e=e.concat(this.marriage.self.employers)),this.marriage.spouse.schools&&this.marriage.spouse.schools.length>0&&(e=e.concat(this.marriage.spouse.employers)),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"occupations",{get:function(){var e=new Array;return this.marriage.self.occupations&&this.marriage.self.occupations.length>0&&(e=e.concat(this.marriage.self.occupations)),this.marriage.spouse.occupations&&this.marriage.spouse.occupations.length>0&&(e=e.concat(this.marriage.spouse.occupations)),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"residences",{get:function(){var e=new Map;return this.marriage.self.residencePlaces&&this.marriage.self.residencePlaces.length>0&&this.marriage.self.residencePlaces.forEach((function(t){var n=t.toLowerCase().trim();e.has(n)||e.set(n,t)})),this.marriage.spouse.residencePlaces&&this.marriage.spouse.residencePlaces.length>0&&this.marriage.spouse.residencePlaces.forEach((function(t){var n=t.toLowerCase().trim();e.has(n)||e.set(n,t)})),Array.from(e.values())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentResidences",{get:function(){var e=new Map;return this.marriage.self.parents&&this.marriage.self.parents.length>0&&this.marriage.self.parents.forEach((function(t){t.residencePlaces&&t.residencePlaces.length>0&&t.residencePlaces.forEach((function(t){var n=t.toLowerCase().trim();e.has(n)||e.set(n,t)}))})),this.marriage.spouse.parents&&this.marriage.spouse.parents.length>0&&this.marriage.spouse.parents.forEach((function(t){t.residencePlaces&&t.residencePlaces.length>0&&t.residencePlaces.forEach((function(t){var n=t.toLowerCase().trim();e.has(n)||e.set(n,t)}))})),Array.from(e.values())},enumerable:!1,configurable:!0}),e.prototype.getCorrectableDisplayField=function(e,t){var n=this,a={};t&&(a.value=t,a.extractedValue=t);var i=this.alternatesMap;if(i.has(e)){var o=i.get(e);a.alternates=(0,r.reduceAlternates)(o).map((function(e){return{username:n.getUsername(e.userId),value:e.value}})),a.value=(0,r.getLatestAlternate)(o,ncom.user?ncom.user:0).value}return a},Object.defineProperty(e.prototype,"alternatesMap",{get:function(){var e,t,n,i,r,s,l,c,p=new Map;if(this.corrections.size>0)try{for(var d=a.__values(this.corrections.keys()),m=d.next();!m.done;m=d.next()){var u=m.value;try{for(var h=(n=void 0,a.__values(this.corrections.get(u))),g=h.next();!g.done;g=h.next()){var f=g.value;if(f.corrected){var b=f.corrected;try{for(var y=(r=void 0,a.__values(Object.entries(b))),v=y.next();!v.done;v=y.next()){var _=a.__read(v.value,2),E=_[0],w=_[1];if("self"===E||"spouse"===E)try{for(var C=(l=void 0,a.__values(Object.entries(w))),S=C.next();!S.done;S=C.next()){var N=a.__read(S.value,2),x=N[0],k=N[1],P={userId:Number(u),value:k,correctionId:f.correctionId,modified:(0,o.parseISO)(f.modified)},I="".concat(E).concat(x.charAt(0).toUpperCase()+x.slice(1));p.has(I)?p.get(I).push(P):p.set(I,[P])}}catch(e){l={error:e}}finally{try{S&&!S.done&&(c=C.return)&&c.call(C)}finally{if(l)throw l.error}}else{P={userId:Number(u),value:w,correctionId:f.correctionId,modified:(0,o.parseISO)(f.modified)};p.has(E)?p.get(E).push(P):p.set(E,[P])}}}catch(e){r={error:e}}finally{try{v&&!v.done&&(s=y.return)&&s.call(y)}finally{if(r)throw r.error}}}}}catch(e){n={error:e}}finally{try{g&&!g.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{m&&!m.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}return p},enumerable:!1,configurable:!0}),a.__decorate([i.observable],e.prototype,"corrections",void 0),a.__decorate([i.observable],e.prototype,"submittedFields",void 0),a.__decorate([i.observable],e.prototype,"correctionMode",void 0),a.__decorate([i.observable],e.prototype,"correctionModalOpen",void 0),a.__decorate([i.observable],e.prototype,"correctionModalType",void 0),a.__decorate([i.observable],e.prototype,"correctionType",void 0),a.__decorate([i.observable],e.prototype,"alternatesOpen",void 0),a.__decorate([i.observable],e.prototype,"alternatesFieldType",void 0),a.__decorate([i.observable],e.prototype,"usernameMap",void 0),a.__decorate([i.action],e.prototype,"addCorrection",null),a.__decorate([i.action],e.prototype,"addSubmittedFields",null),a.__decorate([i.action],e.prototype,"toggleCorrectionMode",null),a.__decorate([i.action],e.prototype,"toggleCorrectionModal",null),a.__decorate([i.action],e.prototype,"setModalType",null),a.__decorate([i.action],e.prototype,"setCorrectionType",null),a.__decorate([i.action],e.prototype,"toggleAlternatesPopup",null),a.__decorate([i.action],e.prototype,"loadUsernames",null),a.__decorate([i.computed],e.prototype,"hasAlternates",null),a.__decorate([i.computed],e.prototype,"selfName",null),a.__decorate([i.computed],e.prototype,"spouseName",null),a.__decorate([i.computed],e.prototype,"selfTitle",null),a.__decorate([i.computed],e.prototype,"selfGivenName",null),a.__decorate([i.computed],e.prototype,"selfSurname",null),a.__decorate([i.computed],e.prototype,"selfSuffix",null),a.__decorate([i.computed],e.prototype,"selfMaidenName",null),a.__decorate([i.computed],e.prototype,"selfNickname",null),a.__decorate([i.computed],e.prototype,"selfGender",null),a.__decorate([i.computed],e.prototype,"spouseTitle",null),a.__decorate([i.computed],e.prototype,"spouseGivenName",null),a.__decorate([i.computed],e.prototype,"spouseSurname",null),a.__decorate([i.computed],e.prototype,"spouseSuffix",null),a.__decorate([i.computed],e.prototype,"spouseMaidenName",null),a.__decorate([i.computed],e.prototype,"spouseNickname",null),a.__decorate([i.computed],e.prototype,"spouseGender",null),a.__decorate([i.computed],e.prototype,"ceremonyVenue",null),a.__decorate([i.computed],e.prototype,"honeymoonPlace",null),a.__decorate([i.computed],e.prototype,"licenseDate",null),a.__decorate([i.computed],e.prototype,"licensePlace",null),a.__decorate([i.computed],e.prototype,"marriagePlace",null),a.__decorate([i.computed],e.prototype,"weddingDate",null),a.__decorate([i.computed],e.prototype,"receptionVenue",null),a.__decorate([i.computed],e.prototype,"engagementDate",null),a.__decorate([i.computed],e.prototype,"parents",null),a.__decorate([i.computed],e.prototype,"siblings",null),a.__decorate([i.computed],e.prototype,"children",null),a.__decorate([i.computed],e.prototype,"officiant",null),a.__decorate([i.computed],e.prototype,"brideAttire",null),a.__decorate([i.computed],e.prototype,"flowers",null),a.__decorate([i.computed],e.prototype,"weddingParty",null),a.__decorate([i.computed],e.prototype,"otherPeople",null),a.__decorate([i.computed],e.prototype,"schools",null),a.__decorate([i.computed],e.prototype,"employers",null),a.__decorate([i.computed],e.prototype,"occupations",null),a.__decorate([i.computed],e.prototype,"residences",null),a.__decorate([i.computed],e.prototype,"parentResidences",null),a.__decorate([i.computed],e.prototype,"alternatesMap",null),e}();t.MarriageStore=l},606:function(e,t,n){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0}),t.Alternates=t.CorrectionModal=void 0;var i=n(3),r=n(1),o=n(6),s=n(8),l=n(5),c=n(343);n(352);var p=n(7),d=n(353),m=n(262),u=n(20),h=n(55),g=n(195),f=n(31);try{(0,h.arrayIncludes)()}catch(e){}function b(e){var t="";return t+=void 0!==e.title?e.title:"",t+=void 0!==e.givenName?" ".concat(e.givenName):"",(t+=void 0!==e.surname?" ".concat(e.surname):"").trim()}function y(e){var t="";return t+=void 0!==e.title?e.title:"",t+=void 0!==e.givenName?" ".concat(e.givenName):"",(t+=void 0!==e.surname?" ".concat(e.surname):"").trim()}function v(e){var t=e.name;return e.graduationYear&&(t+=" (g: ".concat(e.graduationYear,")")),t}var _=new Map([["selfName","Name"],["spouseName","Spouse"],["weddingDate","Marriage Date"],["marriagePlace","Marriage Place"],["ceremonyVenue","Marriage Venue"],["receptionVenue","Reception Venue"],["honeymoonPlace","Honeymoon Place"],["engagementDate","Engagement Date"],["licenseDate","License Date"],["licensePlace","License Place"]]),E=new Map([["selfName","Names"],["spouseName","Names"],["weddingDate","Marriage Date"],["marriagePlace","Marriage Place"],["ceremonyVenue","Marriage Venue"],["receptionVenue","Reception Venue"],["honeymoonPlace","Honeymoon Place"],["engagementDate","Engagement Date"],["licenseDate","License Date"],["licensePlace","License Place"]]),w=function(e){function t(t){var n=e.call(this,t)||this,a=!1;try{a=null!=new URLSearchParams(window.document.location.search).get("add-alternate-info-btn")}catch(e){}return n.state={visibleAddAlternateInfoButton:a},n}return i.__extends(t,e),t.prototype.onClickSTA=function(e){this.props.onClickSTA()},t.prototype.onClickClip=function(e){this.props.onClickClip()},t.prototype.onUpdateViewerData=function(){this.props.onUpdateViewerData(this.props.store.marriageId,(0,s.toJS)(this.props.store.corrections))},t.prototype.toggleCorrectionMode=function(e){ncom.user&&("link"!==e&&"button"!==e||(0,f.sendEvent)("viewer-marriage","click",e),this.props.store.toggleCorrectionMode(),this.props.onToggleCorrectionMode(this.props.store.correctionMode))},t.prototype.componentDidMount=function(){this.props.onModalContentChanged()},t.prototype.componentDidUpdate=function(){this.props.onModalContentChanged()},t.prototype.render=function(){var e=this,t=this.props.store.selfName,n=this.props.store.spouseName,a=this.props.store.parents,i=this.props.store.siblings,o=this.props.store.children,s=this.props.store.ceremonyVenue,c=this.props.store.honeymoonPlace,m=this.props.store.licenseDate,u=this.props.store.licensePlace,h=this.props.store.marriagePlace,g=this.props.store.weddingDate,f=this.props.store.receptionVenue,b=this.props.store.engagementDate,y=this.props.store.officiant,v=this.props.store.brideAttire,_=this.props.store.flowers,E=this.props.store.weddingParty,w=this.props.store.otherPeople,C=this.props.store.residences,S=this.props.store.parentResidences,N=this.props.store.schools,x=this.props.store.employers,k=this.props.store.occupations;return this.props.store.correctionMode?r.createElement(r.Fragment,null,r.createElement("div",{className:"obituary_header position-relative"},r.createElement("p",{className:"correction alert alert-warning correction p-3"},"Add alternate info by selecting a fact below.")),r.createElement(l.ModalBody,{className:"flex-shrink-1 flex-grow-0 pt-0 px-0"},r.createElement(P,{store:this.props.store,onUpdateViewerData:this.onUpdateViewerData.bind(this)}),this.marriageFields(t,n,a,i,o,s,c,m,u,h,g,f,b,y,v,_,E,w,C,S,N,x,k),!(t.value&&n.value&&s.value&&c.value&&m.value&&u.value&&h.value&&g.value&&f.value&&b.value)&&r.createElement(l.Row,null,r.createElement(l.Col,{className:"text-center my-2"},r.createElement("a",{role:"button",className:"btn btn-link btn-sm",href:"",onClick:function(t){t.preventDefault(),e.props.store.toggleCorrectionModal(),e.props.store.setModalType("add")}},r.createElement("span",{className:"icon-news icon-plus"})," Add additional fact")))),r.createElement(l.ModalFooter,null,r.createElement(l.Button,{color:"primary",className:"rounded-pill",onClick:this.toggleCorrectionMode.bind(this,"done")},"Done"))):r.createElement(r.Fragment,null,r.createElement("h6",{className:"border-bottom py-3 pl-3 pl-md-0"},r.createElement(p.Icon,{icon:"marriage","aria-hidden":"true"}),"Marriage"),r.createElement(l.Row,{className:"obituary_header marriage position-relative",noGutters:!0},r.createElement(l.Col,{xs:3,sm:4,className:"text-right p-0 m-0"},r.createElement("span",{className:"d-inline-block icon-news icon-marriage mr-n3","aria-label":"Marriage Article"})),r.createElement(l.Col,{className:"m-0 pl-4"},r.createElement("h2",{className:"marriage-title h5 text-left text-secondary2 mb-0"},t.value," & ",n.value))),r.createElement(l.ModalBody,{className:"flex-shrink-1 flex-grow-0 pt-0 overflow-auto"},this.marriageFields(t,n,a,i,o,s,c,m,u,h,g,f,b,y,v,_,E,w,C,S,N,x,k)),r.createElement(l.Row,{className:"bg-white border-top position-relative",noGutters:!0},r.createElement(l.Col,null,this.props.store.hasAlternates&&r.createElement(l.Row,{noGutters:!0},r.createElement(l.Col,{xs:{offset:1,size:11},className:"pl-1"},r.createElement("small",null,r.createElement("p",{className:"text-muted pt-2 m-0 pr-2 text-right"},r.createElement("b",null,"*")," – Alternate fact")))),r.createElement(l.Row,{className:"obituary_disclaimer",noGutters:!0},r.createElement(l.Col,{xs:1,className:"py-3 py-sm-2 px-1 text-center"},r.createElement("span",{className:"icon-news text-muted icon-help pull-left large align-middle"})),r.createElement(l.Col,{xs:11,className:"pl-1"},r.createElement("small",null,r.createElement("p",{className:"text-muted py-2 m-0"},"These facts were pulled from this record by a computer and may not be accurate.",ncom.user&&r.createElement(r.Fragment,null," ",r.createElement("button",{id:"add-alternate-info-link",type:"button",onClick:this.toggleCorrectionMode.bind(this,"link"),className:"btn btn-link btn-sm p-0 border-0 align-baseline m-0"},"Add or update information")," · ",r.createElement(d.ReportIssueModal,{pageId:this.props.store.pageId,articleId:this.props.store.marriageId,articleType:"marriage"})))))))),r.createElement(l.ModalFooter,null,ncom.user&&this.state.visibleAddAlternateInfoButton&&r.createElement(l.Button,{outline:!0,color:"dark",id:"add-alternate-info-btn",className:"py-2 float-left btn-sm rounded-pill",onClick:this.toggleCorrectionMode.bind(this,"button")},"Add or update information"),this.props.viewer.isReadingSupported&&r.createElement(l.Button,{color:"secondary",className:"rounded-pill",onClick:function(){e.props.viewer.readSegment()}},r.createElement("img",{src:"/i/voice-search.svg",width:"12",alt:"",className:"mr-2","aria-hidden":"true"}),null===this.props.viewer.isReading?"Speak":this.props.viewer.isReading?"Pause":"Resume"),r.createElement(l.Button,{color:"acom",className:"save-to-ancestry rounded-pill",onClick:this.onClickSTA.bind(this)},r.createElement(p.Icon,{icon:"acom","aria-hidden":"true"}),"Save to Ancestry"),r.createElement(l.Button,{color:"primary",className:"rounded-pill",onClick:this.onClickClip.bind(this)},r.createElement(p.Icon,{icon:"clip",title:"Clip"}),this.props.hasClipped?"Clipping":"Clip")))},t.prototype.marriageFields=function(e,t,n,a,i,o,s,l,c,p,d,m,u,h,g,f,_,E,w,N,x,k,P){return r.createElement(r.Fragment,null,r.createElement("div",{className:"obituary_self_facts"},this.props.store.correctionMode&&this.props.store.submittedFields.length>0&&r.createElement("p",{className:"text-success text-center mb-1"},r.createElement("span",{className:"icon-news icon-check"},"Alternate facts in ",r.createElement("b",null,"bold and green"))),e.value&&r.createElement(C,{type:"selfName",field:e,submitted:this.props.store.submittedFields.includes("selfName"),correctionMode:this.props.store.correctionMode,correctionType:"self",alternatesPopupVisible:this.props.store.alternatesOpen&&"selfName"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"selfName")}),t.value&&r.createElement(C,{type:"spouseName",field:t,submitted:this.props.store.submittedFields.includes("spouseName"),correctionMode:this.props.store.correctionMode,correctionType:"spouse",alternatesPopupVisible:this.props.store.alternatesOpen&&"spouseName"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"spouseName")}),!this.props.store.correctionMode&&n&&n.length>0&&r.createElement(S,{label:"Parents",items:n.map(b).filter((function(e){return e}))}),d.value&&r.createElement(C,{type:"weddingDate",field:d,submitted:this.props.store.submittedFields.includes("weddingDate"),correctionMode:this.props.store.correctionMode,correctionType:"marriage",alternatesPopupVisible:this.props.store.alternatesOpen&&"weddingDate"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"weddingDate")}),p.value&&r.createElement(C,{type:"marriagePlace",field:p,submitted:this.props.store.submittedFields.includes("marriagePlace"),correctionMode:this.props.store.correctionMode,correctionType:"marriage",alternatesPopupVisible:this.props.store.alternatesOpen&&"marriagePlace"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"marriagePlace")}),o.value&&r.createElement(C,{type:"ceremonyVenue",field:o,submitted:this.props.store.submittedFields.includes("ceremonyVenue"),correctionMode:this.props.store.correctionMode,correctionType:"marriage",alternatesPopupVisible:this.props.store.alternatesOpen&&"ceremonyVenue"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"ceremonyVenue")}),u.value&&r.createElement(C,{type:"engagementDate",field:u,submitted:this.props.store.submittedFields.includes("engagementDate"),correctionMode:this.props.store.correctionMode,correctionType:"marriage",alternatesPopupVisible:this.props.store.alternatesOpen&&"engagementDate"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"engagementDate")}),m.value&&r.createElement(C,{type:"receptionVenue",field:m,submitted:this.props.store.submittedFields.includes("receptionVenue"),correctionMode:this.props.store.correctionMode,correctionType:"marriage",alternatesPopupVisible:this.props.store.alternatesOpen&&"receptionVenue"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"receptionVenue")}),s.value&&r.createElement(C,{type:"honeymoonPlace",field:s,submitted:this.props.store.submittedFields.includes("honeymoonPlace"),correctionMode:this.props.store.correctionMode,correctionType:"marriage",alternatesPopupVisible:this.props.store.alternatesOpen&&"honeymoonPlace"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"honeymoonPlace")}),l.value&&r.createElement(C,{type:"licenseDate",field:l,submitted:this.props.store.submittedFields.includes("licenseDate"),correctionMode:this.props.store.correctionMode,correctionType:"marriage",alternatesPopupVisible:this.props.store.alternatesOpen&&"licenseDate"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"licenseDate")}),c.value&&r.createElement(C,{type:"licensePlace",field:c,submitted:this.props.store.submittedFields.includes("licensePlace"),correctionMode:this.props.store.correctionMode,correctionType:"marriage",alternatesPopupVisible:this.props.store.alternatesOpen&&"licensePlace"===this.props.store.alternatesFieldType,toggleCorrectionModal:this.props.store.toggleCorrectionModal.bind(this.props.store),setCorrectionType:this.props.store.setCorrectionType.bind(this.props.store),handleAlternatesClick:this.props.store.toggleAlternatesPopup.bind(this.props.store,"licensePlace")}),!this.props.store.correctionMode&&h&&r.createElement(S,{label:"Officiant",items:[y(h)]}),!this.props.store.correctionMode&&g&&r.createElement(S,{label:"Bride Attire",items:g}),!this.props.store.correctionMode&&f&&r.createElement(S,{label:"Flowers",items:f}),!this.props.store.correctionMode&&(_.length>0||a.length>0||i.length>0||E.length>0)&&r.createElement("div",{className:"obituary_names_mentioned mt-2 pb-2 border-top"},r.createElement("h4",{className:"h6 text-center py-2 text-muted border-bottom text-uppercase"},"Names Mentioned"),_.length>0&&r.createElement(S,{label:"Wedding Party",items:_.map(y).filter((function(e){return e}))}),a.length>0&&r.createElement(S,{label:"Siblings",items:a.map(b).filter((function(e){return e}))}),i.length>0&&r.createElement(S,{label:"Children",items:i.map(b).filter((function(e){return e}))}),E.length>0&&r.createElement(S,{label:"Other Names",items:E.map(y).filter((function(e){return e}))})),!this.props.store.correctionMode&&(w.length>0||N.length>0||x.length>0||k.length>0||P.length>0)&&r.createElement("div",{className:"obituary_names_mentioned mt-2 pb-2 border-top"},r.createElement("h6",{className:"text-center py-2 text-muted border-bottom text-uppercase"},r.createElement("small",null,"Other Details")),w.length>0&&r.createElement(S,{label:"Residences",items:w}),N.length>0&&r.createElement(S,{label:"Parent Residences",items:N}),x.length>0&&r.createElement(S,{label:"Schools",items:x.map(v)}),k.length>0&&r.createElement(S,{label:"Employers",items:k}),P.length>0&&r.createElement(S,{label:"Occupations",items:P}))))},t=i.__decorate([o.observer],t)}(r.Component);t.default=w;var C=function(e){var t="weddingDate"===e.type||"engagementDate"===e.type||"licenseDate"===e.type;return r.createElement(l.FormGroup,{role:"button",row:!0,className:e.correctionMode?e.submitted?"m-0 icon-news text-success font-weight-bold alert-warning border-bottom":"m-0 icon-news alert-warning border-bottom":"m-0 icon-news",onClick:e.correctionMode?function(t){t.preventDefault(),e.toggleCorrectionModal(),e.setCorrectionType(e.correctionType)}:null,"aria-label":e.correctionMode?"Click to add an Alternate to this fact":""},r.createElement(l.Col,{xs:3,sm:4,className:"text-right text-uppercase text-muted py-1 pr-0 pl-0"},r.createElement("small",null,_.get(e.type))),r.createElement(l.Col,{xs:9,sm:8,className:"pt-c15 py-1 pr-4"},t?(0,g.getDisplayDate)(e.field.value):e.field.value,e.field.alternates&&e.field.alternates.length>0&&r.createElement(r.Fragment,null,r.createElement("b",{title:"Alternate fact"},"*"),!e.correctionMode&&r.createElement(r.Fragment,null,r.createElement("a",{className:"text-muted icon-more-dots more-options",onClick:e.alternatesPopupVisible?null:e.handleAlternatesClick.bind(a),title:"Alternate fact details",role:"button"}),e.alternatesPopupVisible&&r.createElement(T,{type:e.type,original:e.field.extractedValue,alternates:e.field.alternates,handleClick:e.handleAlternatesClick})))))},S=function(e){var t=e.label,n=e.items,a=i.__read(r.useState(!1),2),o=a[0],s=a[1];if(n&&n.length>0){var c=n.slice(0,o?n.length:2).join(", ");return r.createElement(l.Row,{className:"m-0"},r.createElement(l.Col,{xs:3,sm:4,className:"text-right text-uppercase text-muted pt-0 pb-1 pr-0 pl-0"},r.createElement("small",null,t)),r.createElement(l.Col,{xs:9,sm:8,className:"pt-c15 pb-0"},c),!o&&n.length>2&&r.createElement(l.Col,{xs:{size:7,offset:3},sm:{size:8,offset:4},className:"pb-2 pt-0 mt-n1"},r.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),s(!0)},className:"text-uppercase"},r.createElement("small",null,"View ",n.length-2," more"))))}return null},N=/^[A-Za-z \-\'\"\.,']*$/,x=/^[A-Za-z\.]*$/,k=/^[0-9A-Za-z \-\'\"\.,']*$/,P=function(e){function t(t){var n=e.call(this,t)||this;return n.defaultInputStatus={message:"",type:"invalid"},n.state={submitting:!1,errorMessage:null,selfTitle:n.props.store.selfTitle.value,selfGivenName:n.props.store.selfGivenName.value,selfSurname:n.props.store.selfSurname.value,selfSuffix:n.props.store.selfSuffix.value,selfMaidenName:n.props.store.selfMaidenName.value,selfNickname:n.props.store.selfNickname.value,selfGender:n.props.store.selfGender.value,spouseTitle:n.props.store.spouseTitle.value,spouseGivenName:n.props.store.spouseGivenName.value,spouseSurname:n.props.store.spouseSurname.value,spouseSuffix:n.props.store.spouseSuffix.value,spouseMaidenName:n.props.store.spouseMaidenName.value,spouseNickname:n.props.store.spouseNickname.value,spouseGender:n.props.store.spouseGender.value,weddingDate:n.props.store.weddingDate.value,marriagePlace:n.props.store.marriagePlace.value,ceremonyVenue:n.props.store.ceremonyVenue.value,engagementDate:n.props.store.engagementDate.value,receptionVenue:n.props.store.receptionVenue.value,honeymoonPlace:n.props.store.honeymoonPlace.value,licenseDate:n.props.store.licenseDate.value,licensePlace:n.props.store.licensePlace.value,selectedReasons:new Set,feedback:{title:n.defaultInputStatus,givenName:n.defaultInputStatus,surname:n.defaultInputStatus,maidenName:n.defaultInputStatus,nickname:n.defaultInputStatus,suffix:n.defaultInputStatus,weddingDate:n.defaultInputStatus,marriagePlace:n.defaultInputStatus,ceremonyVenue:n.defaultInputStatus,engagementDate:n.defaultInputStatus,receptionVenue:n.defaultInputStatus,honeymoonPlace:n.defaultInputStatus,licenseDate:n.defaultInputStatus,licensePlace:n.defaultInputStatus}},n.setInitialFromState(),n}return i.__extends(t,e),t.prototype.setInitialFromState=function(){this.initial={selfTitle:this.state.selfTitle,selfGivenName:this.state.selfGivenName,selfSurname:this.state.selfSurname,selfSuffix:this.state.selfSuffix,selfMaidenName:this.state.selfMaidenName,selfNickname:this.state.selfNickname,selfGender:this.state.selfGender,spouseTitle:this.state.spouseTitle,spouseGivenName:this.state.spouseGivenName,spouseSurname:this.state.spouseSurname,spouseSuffix:this.state.spouseSuffix,spouseMaidenName:this.state.spouseMaidenName,spouseNickname:this.state.spouseNickname,spouseGender:this.state.spouseGender,weddingDate:this.state.weddingDate,marriagePlace:this.state.marriagePlace,ceremonyVenue:this.state.ceremonyVenue,engagementDate:this.state.engagementDate,receptionVenue:this.state.receptionVenue,honeymoonPlace:this.state.honeymoonPlace,licenseDate:this.state.licenseDate,licensePlace:this.state.licensePlace}},t.prototype.setStateFromInitial=function(){this.setState({selfTitle:this.initial.selfTitle,selfGivenName:this.initial.selfGivenName,selfSurname:this.initial.selfSurname,selfSuffix:this.initial.selfSuffix,selfMaidenName:this.initial.selfMaidenName,selfNickname:this.initial.selfNickname,selfGender:this.initial.selfGender,spouseTitle:this.initial.spouseTitle,spouseGivenName:this.initial.spouseGivenName,spouseSurname:this.initial.spouseSurname,spouseSuffix:this.initial.spouseSuffix,spouseMaidenName:this.initial.spouseMaidenName,spouseNickname:this.initial.spouseNickname,spouseGender:this.initial.spouseGender,weddingDate:this.initial.weddingDate,marriagePlace:this.initial.marriagePlace,ceremonyVenue:this.initial.ceremonyVenue,engagementDate:this.initial.engagementDate,receptionVenue:this.initial.receptionVenue,honeymoonPlace:this.initial.honeymoonPlace,licenseDate:this.initial.licenseDate,licensePlace:this.initial.licensePlace})},t.prototype.handleInputChange=function(e){var t;this.setState(((t={})[e.target.name]=e.target.value,t))},t.prototype.handleSelfSpouseInputChange=function(e,t){var n,a=t+e.target.name.charAt(0).toUpperCase()+e.target.name.slice(1);this.setState(((n={})[a]=e.target.value,n))},t.prototype.handleDateChange=function(e,t){var n;(0,u.isDate)(e)&&(0,u.isValid)(e)&&this.setState(((n={})[t]=e?(0,u.format)(e,"yyyy-MM-dd"):"",n))},t.prototype.validateInput=function(e){var t=e.target.name,n=e.target.value,a=this.state.feedback;"givenName"===t||"surname"===t||"maidenName"===t||"nickname"===t?N.test(n)&&n.length>=0&&n.length<=50?a[t]={type:"valid"}:a[t]={message:"Please enter a valid name.",type:"invalid"}:"suffix"===t?x.test(n)&&n.length>=0&&n.length<=20?a[t]={type:"valid"}:a[t]={message:"Please enter a valid suffix.",type:"invalid"}:"title"===t?x.test(n)&&n.length>=0&&n.length<=20?a[t]={type:"valid"}:a[t]={message:"Please enter a valid title.",type:"invalid"}:"ceremonyVenue"!==t&&"marriagePlace"!==t&&"receptionVenue"!==t&&"honeymoonPlace"!==t||(k.test(n)&&n.length>=0&&n.length<=100?a[t]={type:"valid"}:a[t]={message:"Please enter a valid place.",type:"invalid"}),this.setState({feedback:a})},t.prototype.handleReasonChange=function(e){var t=this.state.selectedReasons;t.has(e)?t.delete(e):t.add(e),this.setState({selectedReasons:t})},t.prototype.handleCorrectionTypeChange=function(e){this.props.store.setCorrectionType(e.target.value)},t.prototype.hasCorrections=function(){return this.state.selfTitle!==this.initial.selfTitle||this.state.selfGivenName!==this.initial.selfGivenName||this.state.selfSurname!==this.initial.selfSurname||this.state.selfSuffix!==this.initial.selfSuffix||this.state.selfMaidenName!==this.initial.selfMaidenName||this.state.selfNickname!==this.initial.selfNickname||this.state.selfGender!==this.initial.selfGender||this.state.spouseTitle!==this.initial.spouseTitle||this.state.spouseGivenName!==this.initial.spouseGivenName||this.state.spouseSurname!==this.initial.spouseSurname||this.state.spouseSuffix!==this.initial.spouseSuffix||this.state.spouseMaidenName!==this.initial.spouseMaidenName||this.state.spouseNickname!==this.initial.spouseNickname||this.state.spouseGender!==this.initial.spouseGender||this.state.weddingDate!==this.initial.weddingDate||this.state.marriagePlace!==this.initial.marriagePlace||this.state.ceremonyVenue!==this.initial.ceremonyVenue||this.state.engagementDate!==this.initial.engagementDate||this.state.receptionVenue!==this.initial.receptionVenue||this.state.honeymoonPlace!==this.initial.honeymoonPlace||this.state.licenseDate!==this.initial.licenseDate||this.state.licensePlace!==this.initial.licensePlace},t.prototype.isFormValid=function(){return!(this.state.feedback.title.message&&"invalid"===this.state.feedback.title.type||this.state.feedback.givenName.message&&"invalid"===this.state.feedback.givenName.type||this.state.feedback.surname.message&&"invalid"===this.state.feedback.surname.type||this.state.feedback.maidenName.message&&"invalid"===this.state.feedback.maidenName.type||this.state.feedback.nickname.message&&"invalid"===this.state.feedback.nickname.type||this.state.feedback.suffix.message&&"invalid"===this.state.feedback.suffix.type||this.state.feedback.weddingDate.message&&"invalid"===this.state.feedback.weddingDate.type||this.state.feedback.marriagePlace.message&&"invalid"===this.state.feedback.marriagePlace.type||this.state.feedback.ceremonyVenue.message&&"invalid"===this.state.feedback.ceremonyVenue.type||this.state.feedback.engagementDate.message&&"invalid"===this.state.feedback.engagementDate.type||this.state.feedback.receptionVenue.message&&"invalid"===this.state.feedback.receptionVenue.type||this.state.feedback.honeymoonPlace.message&&"invalid"===this.state.feedback.honeymoonPlace.type||this.state.feedback.licenseDate.message&&"invalid"===this.state.feedback.licenseDate.type||this.state.feedback.licensePlace.message&&"invalid"===this.state.feedback.licensePlace.type)},t.prototype.getCorrected=function(){var e={};return this.state.selfTitle!==this.initial.selfTitle&&(e.self||(e.self={}),e.self.title=this.state.selfTitle),this.state.selfGivenName!==this.initial.selfGivenName&&(e.self||(e.self={}),e.self.givenName=this.state.selfGivenName),this.state.selfSurname!==this.initial.selfSurname&&(e.self||(e.self={}),e.self.surname=this.state.selfSurname),this.state.selfSuffix!==this.initial.selfSuffix&&(e.self||(e.self={}),e.self.suffix=this.state.selfSuffix),this.state.selfMaidenName!==this.initial.selfMaidenName&&(e.self||(e.self={}),e.self.maidenName=this.state.selfMaidenName),this.state.selfNickname!==this.initial.selfNickname&&(e.self||(e.self={}),e.self.nickname=this.state.selfNickname),this.state.selfGender!==this.initial.selfGender&&(e.self||(e.self={}),e.self.gender=this.state.selfGender),this.state.spouseTitle!==this.initial.spouseTitle&&(e.spouse||(e.spouse={}),e.spouse.title=this.state.spouseTitle),this.state.spouseGivenName!==this.initial.spouseGivenName&&(e.spouse||(e.spouse={}),e.spouse.givenName=this.state.spouseGivenName),this.state.spouseSurname!==this.initial.spouseSurname&&(e.spouse||(e.spouse={}),e.spouse.surname=this.state.spouseSurname),this.state.spouseSuffix!==this.initial.spouseSuffix&&(e.spouse||(e.spouse={}),e.spouse.suffix=this.state.spouseSuffix),this.state.spouseMaidenName!==this.initial.spouseMaidenName&&(e.spouse||(e.spouse={}),e.spouse.maidenName=this.state.spouseMaidenName),this.state.spouseNickname!==this.initial.spouseNickname&&(e.spouse||(e.spouse={}),e.spouse.nickname=this.state.spouseNickname),this.state.spouseGender!==this.initial.spouseGender&&(e.spouse||(e.spouse={}),e.spouse.gender=this.state.spouseGender),this.state.weddingDate!==this.initial.weddingDate&&(e.weddingDate=this.state.weddingDate),this.state.marriagePlace!==this.initial.marriagePlace&&(e.marriagePlace=this.state.marriagePlace),this.state.ceremonyVenue!==this.initial.ceremonyVenue&&(e.ceremonyVenue=this.state.ceremonyVenue),this.state.engagementDate!==this.initial.engagementDate&&(e.engagementDate=this.state.engagementDate),this.state.receptionVenue!==this.initial.receptionVenue&&(e.receptionVenue=this.state.receptionVenue),this.state.honeymoonPlace!==this.initial.honeymoonPlace&&(e.honeymoonPlace=this.state.honeymoonPlace),this.state.licenseDate!==this.initial.licenseDate&&(e.licenseDate=this.state.licenseDate),this.state.licensePlace!==this.initial.licensePlace&&(e.licensePlace=this.state.licensePlace),e},t.prototype.handleSubmit=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,n,a;return i.__generator(this,(function(i){switch(i.label){case 0:if(e.preventDefault(),!this.hasCorrections())return this.setState({errorMessage:"Nothing has been corrected yet."}),[2];if(!ncom.user)return this.setState({errorMessage:"You must be logged in to submit a correction."}),[2];this.setState({submitting:!0}),i.label=1;case 1:return i.trys.push([1,6,,7]),t=this.getCorrected(),n={extractionKey:this.props.store.extractionKey,corrected:t,reason:this.state.selectedReasons.size>0?Array.from(this.state.selectedReasons):void 0},a=null,this.props.store.articleId?[4,m.ArticleDao.addMarriageCorrection(this.props.store.pageId,this.props.store.articleId,n,this.props.store.marriageId)]:[3,3];case 2:return a=i.sent(),[3,5];case 3:return[4,m.ArticleDao.addMarriageCorrection(this.props.store.pageId,this.props.store.marriageId,n)];case 4:a=i.sent(),i.label=5;case 5:return this.props.store.addSubmittedFields(t),this.props.store.addCorrection(ncom.user,a),this.props.onUpdateViewerData(),this.setInitialFromState(),this.resetAndClose(),[3,7];case 6:return i.sent(),this.setState({errorMessage:"An error occurred while saving your changes."}),[3,7];case 7:return this.setState({submitting:!1}),[2]}}))}))},t.prototype.cancel=function(){this.setStateFromInitial(),this.resetAndClose()},t.prototype.resetAndClose=function(){this.setState({errorMessage:null,selectedReasons:new Set,feedback:{title:this.defaultInputStatus,givenName:this.defaultInputStatus,surname:this.defaultInputStatus,maidenName:this.defaultInputStatus,nickname:this.defaultInputStatus,suffix:this.defaultInputStatus,weddingDate:this.defaultInputStatus,marriagePlace:this.defaultInputStatus,ceremonyVenue:this.defaultInputStatus,engagementDate:this.defaultInputStatus,receptionVenue:this.defaultInputStatus,honeymoonPlace:this.defaultInputStatus,licenseDate:this.defaultInputStatus,licensePlace:this.defaultInputStatus}}),this.props.store.setCorrectionType(null),this.props.store.setModalType("edit"),this.props.store.toggleCorrectionModal()},t.prototype.render=function(){var e=null,t=null;return"self"===this.props.store.correctionType?e=r.createElement(I,{type:"self",title:this.state.selfTitle?this.state.selfTitle:"",givenName:this.state.selfGivenName?this.state.selfGivenName:"",surname:this.state.selfSurname?this.state.selfSurname:"",maidenName:this.state.selfMaidenName?this.state.selfMaidenName:"",nickname:this.state.selfNickname?this.state.selfNickname:"",suffix:this.state.selfSuffix?this.state.selfSuffix:"",gender:this.state.selfGender?this.state.selfGender:"Unknown",handleOnChange:this.handleSelfSpouseInputChange.bind(this),handleOnBlur:this.validateInput.bind(this),feedback:this.state.feedback}):"spouse"===this.props.store.correctionType?e=r.createElement(I,{type:"spouse",title:this.state.spouseTitle?this.state.spouseTitle:"",givenName:this.state.spouseGivenName?this.state.spouseGivenName:"",surname:this.state.spouseSurname?this.state.spouseSurname:"",maidenName:this.state.spouseMaidenName?this.state.spouseMaidenName:"",nickname:this.state.spouseNickname?this.state.spouseNickname:"",suffix:this.state.spouseSuffix?this.state.spouseSuffix:"",gender:this.state.spouseGender?this.state.spouseGender:"Unknown",handleOnChange:this.handleSelfSpouseInputChange.bind(this),handleOnBlur:this.validateInput.bind(this),feedback:this.state.feedback}):"marriage"===this.props.store.correctionType&&(e=r.createElement(M,{ceremonyVenue:this.state.ceremonyVenue?this.state.ceremonyVenue:"",honeymoonPlace:this.state.honeymoonPlace?this.state.honeymoonPlace:"",licenseDateString:this.state.licenseDate?this.state.licenseDate:"",licensePlace:this.state.licensePlace?this.state.licensePlace:"",marriagePlace:this.state.marriagePlace?this.state.marriagePlace:"",weddingDateString:this.state.weddingDate?this.state.weddingDate:"",receptionVenue:this.state.receptionVenue?this.state.receptionVenue:"",engagementDateString:this.state.engagementDate?this.state.engagementDate:"",handleOnChange:this.handleInputChange.bind(this),handleDateChange:this.handleDateChange.bind(this),handleOnBlur:this.validateInput.bind(this),feedback:this.state.feedback})),"add"===this.props.store.correctionModalType&&(t=new Map([["notTranscribed","This fact was not transcribed from the article"],["notMentioned","Additional information not mentioned in obituary"]])),r.createElement(r.Fragment,null,this.props.store.correctionModalOpen&&r.createElement(l.Modal,{isOpen:this.props.store.correctionModalOpen,size:"lg","aria-modal":"true"},r.createElement(l.Form,{onSubmit:this.handleSubmit.bind(this)},r.createElement(l.ModalHeader,null,"add"===this.props.store.correctionModalType?"Add an additional fact":"Add an alternate"),r.createElement(l.ModalBody,null,"add"===this.props.store.correctionModalType&&r.createElement(l.FormGroup,{row:!0,className:"mt-3"},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted pl-sm-1 pr-sm-2 pt-sm-2"},r.createElement(l.Label,{for:"correctionType"},"Choose fact type:")),r.createElement(l.Col,{sm:6,className:"pl-sm-1"},r.createElement(l.Input,{type:"select",bsSize:"sm",name:"correctionType",id:"correctionType",value:this.props.store.correctionType?this.props.store.correctionType:"",onChange:this.handleCorrectionTypeChange.bind(this)},r.createElement("option",{disabled:!0,value:""},"Choose fact type"),!(this.initial.selfTitle&&this.initial.selfGivenName&&this.initial.selfSurname&&this.initial.selfSuffix&&this.initial.selfMaidenName&&this.initial.selfNickname&&this.initial.selfGender)&&r.createElement("option",{value:"self"},"Self"),!(this.initial.spouseTitle&&this.initial.spouseGivenName&&this.initial.spouseSurname&&this.initial.spouseSuffix&&this.initial.spouseMaidenName&&this.initial.spouseNickname&&this.initial.spouseGender)&&r.createElement("option",{value:"spouse"},"Spouse"),!(this.initial.ceremonyVenue&&this.initial.honeymoonPlace&&this.initial.licenseDate&&this.initial.licensePlace&&this.initial.marriagePlace&&this.initial.weddingDate&&this.initial.receptionVenue&&this.initial.engagementDate)&&r.createElement("option",{value:"marriage"},"Marriage")))),e,r.createElement(D,{choices:t,selected:this.state.selectedReasons,handleChange:this.handleReasonChange.bind(this)}),this.state.errorMessage&&r.createElement(l.FormGroup,{row:!0},r.createElement(l.Col,null,r.createElement("p",{className:"alert alert-danger error_24"},this.state.errorMessage)))),r.createElement(l.ModalFooter,null,r.createElement(l.Button,{color:"dark",outline:!0,className:"rounded-pill",onClick:this.cancel.bind(this)},"Cancel"),r.createElement(l.Button,{color:"primary",type:"submit",className:"rounded-pill",disabled:!this.hasCorrections()||!this.isFormValid()||this.state.submitting},"Save")))))},t=i.__decorate([o.observer],t)}(r.Component);t.CorrectionModal=P;var I=function(e){return r.createElement(r.Fragment,null,r.createElement(l.FormGroup,{row:!0,className:"mb-0"},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted pt-sm-4 pl-sm-1 pr-sm-2 d-none d-sm-block"},"Name:"),r.createElement(l.Col,{sm:2,className:"px-sm-1"},r.createElement(l.Label,{for:"title",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-3 pr-2 pt-sm-0"},"Title")),r.createElement(l.Input,{type:"text",name:"title",id:"title",list:"titles",className:"d-inline-block",value:e.title,onChange:function(t){return e.handleOnChange(t,e.type)},onBlur:e.handleOnBlur,valid:"valid"===e.feedback.title.type,invalid:!(!e.feedback.title.message||"invalid"!==e.feedback.title.type)}),r.createElement("span",{className:"dropdown-toggle position-absolute mt-2 ml-n4"}),r.createElement("datalist",{id:"titles"},"or",r.createElement("label",null,"Choose one",r.createElement("option",null,"Mr"),r.createElement("option",null,"Mrs"),r.createElement("option",null,"Miss"),r.createElement("option",null,"Dr")))),r.createElement(l.Col,{sm:3,className:"px-sm-1"},r.createElement(l.Label,{for:"givenName",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-0"},"First name(s)")),r.createElement(l.Input,{type:"text",name:"givenName",id:"givenName",value:e.givenName,onChange:function(t){return e.handleOnChange(t,e.type)},onBlur:e.handleOnBlur,valid:"valid"===e.feedback.givenName.type,invalid:!(!e.feedback.givenName.message||"invalid"!==e.feedback.givenName.type)})),r.createElement(l.Col,{sm:3,className:"pl-sm-1"},r.createElement(l.Label,{for:"surname",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-sm-0 pr-2 pt-3"},"Last name")),r.createElement(l.Input,{type:"text",name:"surname",id:"surname",value:e.surname,onChange:function(t){return e.handleOnChange(t,e.type)},onBlur:e.handleOnBlur,valid:"valid"===e.feedback.surname.type,invalid:!(!e.feedback.surname.message||"invalid"!==e.feedback.surname.type)}))),r.createElement(l.FormGroup,{row:!0,className:"mb-0"},r.createElement(l.Col,{sm:{size:3,offset:3},className:"px-sm-1"},r.createElement(l.Label,{for:"nickname",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-3 pt-sm-0"},"Nickname")),r.createElement(l.Input,{type:"text",name:"nickname",id:"nickname",value:e.nickname,onChange:function(t){return e.handleOnChange(t,e.type)},onBlur:e.handleOnBlur,valid:"valid"===e.feedback.nickname.type,invalid:!(!e.feedback.nickname.message||"invalid"!==e.feedback.nickname.type)})),r.createElement(l.Col,{sm:3,className:"px-sm-1"},r.createElement(l.Label,{for:"maidenName",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-3 pt-sm-0"},"Maiden name")),r.createElement(l.Input,{type:"text",name:"maidenName",id:"maidenName",value:e.maidenName,onChange:function(t){return e.handleOnChange(t,e.type)},onBlur:e.handleOnBlur,valid:"valid"===e.feedback.maidenName.type,invalid:!(!e.feedback.maidenName.message||"invalid"!==e.feedback.maidenName.type)})),r.createElement(l.Col,{sm:2,className:"pl-sm-1"},r.createElement(l.Label,{for:"suffix",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-3 pr-2 pt-sm-0"},"Suffix")),r.createElement(l.Input,{type:"text",name:"suffix",id:"suffix",list:"suffixes",className:"d-inline-block",value:e.suffix,onChange:function(t){return e.handleOnChange(t,e.type)},onBlur:e.handleOnBlur,valid:"valid"===e.feedback.suffix.type,invalid:!(!e.feedback.suffix.message||"invalid"!==e.feedback.suffix.type)}),r.createElement("span",{className:"dropdown-toggle position-absolute mt-2 ml-n4"}),r.createElement("datalist",{id:"suffixes"},"or",r.createElement("label",null,"Choose one",r.createElement("option",null,"Jr"),r.createElement("option",null,"Sr"),r.createElement("option",null,"I"),r.createElement("option",null,"II"),r.createElement("option",null,"III"),r.createElement("option",null,"IV"),r.createElement("option",null,"V"),r.createElement("option",null,"VI"))))),r.createElement(l.FormGroup,{row:!0,className:"mt-2"},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted pl-sm-1 pr-sm-2"},"Gender:"),r.createElement(l.Col,{sm:8,className:"pl-sm-1"},r.createElement("fieldset",null,r.createElement(l.FormGroup,{check:!0,inline:!0},r.createElement(l.Label,{check:!0},r.createElement(l.Input,{type:"radio",name:"gender",value:"Male",checked:"Male"==e.gender,onChange:function(t){return e.handleOnChange(t,e.type)},className:"mr-0"})," ","Male")),r.createElement(l.FormGroup,{check:!0,inline:!0},r.createElement(l.Label,{check:!0},r.createElement(l.Input,{type:"radio",name:"gender",value:"Female",checked:"Female"==e.gender,onChange:function(t){return e.handleOnChange(t,e.type)},className:"mr-0"})," ","Female")),r.createElement(l.FormGroup,{check:!0,inline:!0},r.createElement(l.Label,{check:!0},r.createElement(l.Input,{type:"radio",name:"gender",value:"Other",checked:"Other"==e.gender,onChange:function(t){return e.handleOnChange(t,e.type)},className:"mr-0"})," ","Other")),r.createElement(l.FormGroup,{check:!0,inline:!0},r.createElement(l.Label,{check:!0},r.createElement(l.Input,{type:"radio",name:"gender",value:"Unknown",checked:"Unknown"==e.gender,onChange:function(t){return e.handleOnChange(t,e.type)},className:"mr-0"})," ","Unknown"))))))},M=function(e){var t=(0,u.parseISO)(e.licenseDateString),n=(0,u.parseISO)(e.weddingDateString),a=(0,u.parseISO)(e.engagementDateString);return r.createElement(r.Fragment,null,r.createElement(l.FormGroup,{row:!0,className:"mb-0"},r.createElement(l.Col,{sm:2,className:"text-sm-right text-uppercase text-muted pt-sm-4 pl-sm-1 pr-sm-2 d-none d-sm-block"},"Wedding:"),r.createElement(l.Col,{sm:3,className:"px-sm-1"},r.createElement(l.Label,{for:"weddingDate",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-3 pr-2 pt-sm-0"},"Date")),r.createElement(c.default,{name:"weddingDate",id:"weddingDate",selected:(0,u.isValid)(n)?n:null,placeholderText:e.weddingDateString&&!(0,u.isValid)(n)?e.weddingDateString:null,dateFormat:"dd MMMM, yyyy",className:"form-control",maxDate:new Date,onChange:function(t){return e.handleDateChange(t,"weddingDate")}})),r.createElement(l.Col,{sm:3,className:"pl-sm-1"},r.createElement(l.Label,{for:"marriagePlace",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-sm-0 pr-2 pt-3"},"Place")),r.createElement(l.Input,{type:"text",name:"marriagePlace",id:"marriagePlace",value:e.marriagePlace,onChange:e.handleOnChange,onBlur:e.handleOnBlur,valid:"valid"===e.feedback.marriagePlace.type,invalid:!(!e.feedback.marriagePlace.message||"invalid"!==e.feedback.marriagePlace.type)})),r.createElement(l.Col,{sm:3,className:"px-sm-1"},r.createElement(l.Label,{for:"ceremonyVenue",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-0"},"Ceremony Venue")),r.createElement(l.Input,{type:"text",name:"ceremonyVenue",id:"ceremonyVenue",value:e.ceremonyVenue,onChange:e.handleOnChange,onBlur:e.handleOnBlur,valid:"valid"===e.feedback.ceremonyVenue.type,invalid:!(!e.feedback.ceremonyVenue.message||"invalid"!==e.feedback.ceremonyVenue.type)}))),r.createElement(l.FormGroup,{row:!0,className:"mb-0"},r.createElement(l.Col,{sm:{offset:2,size:3},className:"px-sm-1"},r.createElement(l.Label,{for:"engagementDate",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-3 pr-2 pt-sm-0"},"Engagement Date")),r.createElement(c.default,{name:"engagementDate",id:"engagementDate",selected:(0,u.isValid)(a)?a:null,placeholderText:e.engagementDateString&&!(0,u.isValid)(a)?e.engagementDateString:null,dateFormat:"dd MMMM, yyyy",className:"form-control",maxDate:new Date,onChange:function(t){return e.handleDateChange(t,"engagementDate")}})),r.createElement(l.Col,{sm:3,className:"pl-sm-1"},r.createElement(l.Label,{for:"receptionVenue",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-sm-0 pr-2 pt-3"},"Reception Venue")),r.createElement(l.Input,{type:"text",name:"receptionVenue",id:"receptionVenue",value:e.receptionVenue,onChange:e.handleOnChange,onBlur:e.handleOnBlur,valid:"valid"===e.feedback.receptionVenue.type,invalid:!(!e.feedback.receptionVenue.message||"invalid"!==e.feedback.receptionVenue.type)})),r.createElement(l.Col,{sm:3,className:"px-sm-1"},r.createElement(l.Label,{for:"honeymoonPlace",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-0"},"Honeymoon Place")),r.createElement(l.Input,{type:"text",name:"honeymoonPlace",id:"honeymoonPlace",value:e.honeymoonPlace,onChange:e.handleOnChange,onBlur:e.handleOnBlur,valid:"valid"===e.feedback.honeymoonPlace.type,invalid:!(!e.feedback.honeymoonPlace.message||"invalid"!==e.feedback.honeymoonPlace.type)}))),r.createElement(l.FormGroup,{row:!0,className:"mb-0"},r.createElement(l.Col,{sm:2,className:"text-sm-right text-uppercase text-muted pt-sm-4 pl-sm-1 pr-sm-2 d-none d-sm-block"},"License:"),r.createElement(l.Col,{sm:3,className:"px-sm-1"},r.createElement(l.Label,{for:"licenseDate",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-3 pr-2 pt-sm-0"},"Date")),r.createElement(c.default,{name:"licenseDate",id:"licenseDate",selected:(0,u.isValid)(t)?t:null,placeholderText:e.licenseDateString&&!(0,u.isValid)(t)?e.licenseDateString:null,dateFormat:"dd MMMM, yyyy",className:"form-control",maxDate:new Date,onChange:function(t){return e.handleDateChange(t,"licenseDate")}})),r.createElement(l.Col,{sm:3,className:"pl-sm-1"},r.createElement(l.Label,{for:"licensePlace",className:"m-0"},r.createElement("small",{className:"text-muted d-block text-uppercase pt-sm-0 pr-2 pt-3"},"Place")),r.createElement(l.Input,{type:"text",name:"licensePlace",id:"licensePlace",value:e.licensePlace,onChange:e.handleOnChange,onBlur:e.handleOnBlur,valid:"valid"===e.feedback.licensePlace.type,invalid:!(!e.feedback.licensePlace.message||"invalid"!==e.feedback.licensePlace.type)}))))},D=function(e){return e.choices&&e.choices.size>0?r.createElement(l.FormGroup,{row:!0},r.createElement(l.Col,{sm:3,className:"text-sm-right text-uppercase text-muted pl-sm-1 pr-sm-2"},"Reason:"),r.createElement(l.Col,{xs:{size:11,offset:1},sm:{size:8,offset:0},className:"pl-sm-1"},r.createElement("fieldset",null,Array.from(e.choices.entries()).map((function(t,n){return r.createElement(d.ReasonCheckbox,{key:n,label:t[1],checked:e.selected.has(t[0]),handleChange:e.handleChange.bind(a,t[0])})}))))):null},T=function(e){function t(t){var n=e.call(this,t)||this;return n.setWrapperRef=n.setWrapperRef.bind(n),n.handleClickOutside=n.handleClickOutside.bind(n),n}return i.__extends(t,e),t.prototype.componentDidMount=function(){document.addEventListener("touchend",this.handleClickOutside),document.addEventListener("mousedown",this.handleClickOutside)},t.prototype.componentWillUnmount=function(){document.removeEventListener("touchend",this.handleClickOutside),document.removeEventListener("mousedown",this.handleClickOutside)},t.prototype.setWrapperRef=function(e){this.wrapperRef=e},t.prototype.handleClickOutside=function(e){this.wrapperRef&&!this.wrapperRef.contains(e.target)&&this.props.handleClick()},t.prototype.render=function(){var e="weddingDate"===this.props.type||"licenseDate"===this.props.type||"engagementDate"===this.props.type;return r.createElement("div",{ref:this.setWrapperRef,className:"alternates position-absolute popover popover-custom shadow bs-popover-bottom mt-4",role:"tooltip"},r.createElement("div",{className:"arrow",style:{left:"90%"}}),r.createElement("div",{className:"popover-body"},r.createElement("h6",{className:"text-uppercase text-muted pr-4 mb-0"},"Alternate ",E.get(this.props.type)),this.props.alternates.map((function(t,n){return r.createElement(l.Row,{key:n,className:"border-bottom align-items-center"},r.createElement(l.Col,{xs:7,className:"py-2"},r.createElement("span",{className:"altValue"},e?(0,g.getDisplayDate)(t.value):t.value)),r.createElement(l.Col,{xs:5,className:"text-right"},r.createElement("small",null,r.createElement("p",{className:"text-muted m-0"},"Added by ",r.createElement("a",{href:"/profile/".concat(t.username),className:"altAttribution text-muted"},t.username)))))})),this.props.original&&r.createElement(l.Row,{className:"align-items-center"},r.createElement(l.Col,{className:"py-2"},r.createElement("span",null,e?(0,g.getDisplayDate)(this.props.original):this.props.original)),r.createElement(l.Col,{className:"text-right"},r.createElement("small",null,r.createElement("p",{className:"text-muted m-0"},"Original"))))))},t}(r.Component);t.Alternates=T},607:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrintSaveView=void 0;var a=n(3),i=n(1),r=n(19),o=n(54),s=n(5),l=n(90),c=n(86),p=n(111),d=n(21);t.PrintSaveView=(0,r.observer)((function(e){var t=i.useContext(l.ViewerContext),n=i.useContext(c.NcomContext),r=a.__read(i.useState(null),2),m=r[0],u=r[1],h=i.useRef(!1);if(!t.printFullOrPartChoice)return null;var g="full",f=null,b=null,y=null;if(null!==t.selectedSegment&&"clipping"===t.selectedSegment.type){var v=t.clippings.find((function(e){return e.clipping_id===parseInt(t.selectedSegment.id)}));if(v){y="/clippings/download/?id=".concat(v.clipping_id),f="".concat(y,"&print=1");var _=v.title?v.title.replace(/\W/g,"_"):v.publication&&v.publication.name&&v.page_date&&v.page_title?"".concat(v.publication.name,"_").concat(v.page_date).concat(-1===v.page_title.toLowerCase().indexOf("page")?"_page":"","_").concat(v.page_title).replace(/\W/g,"_"):"";b="".concat(n.paths.image,"/img/img?clippingId=").concat(v.clipping_id,"&a=download&filename=").concat(_),g="part"}}if(null===f){var E="";if("part"===t.printFullOrPartChoice.mode&&(null!==t.editSegment||null!==t.selectedSegment)){var w=t.editSegment?t.editSegment.rectangle:t.selectedSegment.rectangle,C=w.x,S=w.y,N=w.width,x=w.height;E="&x=".concat(Math.ceil(C),"&y=").concat(Math.ceil(S),"&width=").concat(Math.ceil(N),"&height=").concat(Math.ceil(x)),g="part"}y="/download/image/?id=".concat(t.page.id,"&fcftoken=").concat(t.fcfToken||t.iat).concat(E),f="".concat(y,"&print=1"),b="".concat(y,"&type=jpg&chunkdownload=1")}var k=function(e){var n=function(){t.setPrintFullOrPartChoice(null),"part"===g&&t.setEditSegment(null),"PrintSaveView"===t.currentInformationPaneLayer&&t.shiftInformationPaneLayer()};setTimeout((function(){window.innerWidth<o.BREAKPOINT_MD?(t.setShowInformationPane(!1),setTimeout((function(){n()}),300)):n()}),e?5e3:1)},P=function(e){var a,i;h.current||((0,p.putEvent)({type:"SAVE",facets:{label:"image",format:e,user:(null==n?void 0:n.user)?n.user:void 0,product:(null===(a=null==n?void 0:n.product)||void 0===a?void 0:a.id)?n.product.id:void 0,institution:(null===(i=null==n?void 0:n.institution)||void 0===i?void 0:i.id)?n.institution.id:void 0,image:t.image.imageId,publication:t.image.publicationId}}),h.current=!0,setTimeout((function(){h.current=!1}),1e3))};return i.createElement(i.Fragment,null,null===t.printFullOrPartChoice.mode&&i.createElement(i.Fragment,null,i.createElement("h3",{className:"my-2 py-2 h6 py-3"},i.createElement("span",{className:"icon-news icon-download","aria-hidden":"true"})," Download and Print"),i.createElement("div",{className:"border-top py-3 row justify-content-center",role:"group"},i.createElement("a",{className:"col col-md-auto btn btn-outline-light border-primary border jpg p-3 mx-2",href:"",role:"button",onClick:function(e){e.preventDefault(),t.setPrintFullOrPartChoice({mode:"full"})}},i.createElement("span",{className:"print-save-option-preview",role:"img","aria-labelledby":"entireP",style:{backgroundImage:"url(".concat(t.thumbnail.href)}}),i.createElement("b",{className:"text-dark",id:"entireP"},"Entire page")),i.createElement("a",{className:"col col-md-auto btn btn-outline-light border-primary border pdf p-3 mx-2",href:"",role:"button",onClick:function(e){if(e.preventDefault(),n.user)t.setPrintFullOrPartChoice(null),t.createClipping("print-or-save");else{var a=t.selectedSegment;t.setSelectedSegment(null,!1);var i=a?a.rectangle:t.viewer.getViewportClippingRectangle();t.setEditSegment({id:"new",rectangle:i,type:"clipping",source:a}),t.setPrintFullOrPartChoice({mode:"part"})}}},i.createElement("span",{className:"print-save-option-preview portion",role:"img","aria-labelledby":"selectP",style:{backgroundImage:"url(".concat(t.thumbnail.href)}}),i.createElement("b",{className:"text-dark",id:"selectP"},"Select portion of page")))),null!==t.printFullOrPartChoice.mode&&i.createElement(i.Fragment,null,i.createElement("fieldset",{className:"py-3 row justify-content-center align-items-center"},i.createElement("legend",{className:"my-2 py-2 h6 px-3 border-bottom"},i.createElement("span",{className:"icon-news icon-print","aria-hidden":"true"}),"full"===g?i.createElement(i.Fragment,null,"Print or Download Entire Page"):null!==t.selectedSegment?i.createElement(i.Fragment,null,"Print or Download ",i.createElement("span",{className:"text-capitalize"},t.selectedSegment.type)):i.createElement(i.Fragment,null,"Select an area to Print or Download")),i.createElement("a",{className:"col col-md-auto btn btn-outline-light border-primary border jpg p-3 mx-1",role:"button",onClick:function(e){e.preventDefault();try{u(null);var n=document.createElement("iframe");n.setAttribute("style","width:0;height:0;"),n.src=f,document.body.appendChild(n),u({color:"success",message:i.createElement(i.Fragment,null,"Your print should begin soon")}),P("print"),(0,d.sendActionEvent)("print",t.image.imageId.toString(),{newspaper_name:t.image.publicationTitle,newspaper_date:t.image.date}),k(!0)}catch(e){u({color:"danger",message:i.createElement(i.Fragment,null,"Sorry, we are unable to print at this time. Please Try again later.")})}}},i.createElement("b",{className:"text-dark icon-news icon-print"},"Print")),i.createElement("a",{className:"col col-md-auto btn btn-outline-light border-primary border jpg p-3 mx-1",role:"button",target:"_blank",href:b,onClick:function(e){u({color:"success",message:i.createElement(i.Fragment,null,"Your JPG download should begin soon")}),P("jpg"),(0,d.sendActionEvent)("save",t.image.imageId.toString(),{newspaper_name:t.image.publicationTitle,newspaper_date:t.image.date}),k(!0)}},i.createElement("b",{className:"text-dark icon-news icon-download"},"Save as JPG")),i.createElement("a",{className:"col col-md-auto btn btn-outline-light border-primary border pdf p-3 mx-1",role:"button",target:"_blank","aria-describedby":"pdfNote",href:y,onClick:function(e){u({color:"success",message:i.createElement(i.Fragment,null,"Your PDF download should begin soon")}),P("pdf"),(0,d.sendActionEvent)("save",t.image.imageId.toString(),{newspaper_name:t.image.publicationTitle,newspaper_date:t.image.date}),k(!0)}},i.createElement("b",{className:"text-dark icon-news icon-download"},"Save as PDF*")),i.createElement("p",{className:"text-muted mt-4",id:"pdfNote"},"* PDF—Includes source information")),i.createElement(s.Row,{class:!0},!!m&&i.createElement(s.Col,null,i.createElement(s.Alert,{color:m.color,className:"text-center"},m.message)))))}))},608:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaginationBar=void 0;var a=n(3),i=n(1),r=n(22),o=n(19),s=n(90),l=n(5),c=n(20),p=n(7);t.PaginationBar=(0,o.observer)((function(e){var t=i.useContext(s.ViewerContext),n=(0,r.useNavigate)(),o=a.__read(i.useState(""),2),d=o[0],m=o[1],u=a.__read(i.useState(null),2),h=u[0],g=u[1],f=function(e){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(n){switch(n.label){case 0:return t.setBrowsePath(null),[4,t.loadPublicationBrowsePath()];case 1:return n.sent(),[4,t.loadIssues()];case 2:return n.sent(),t.setBrowsePath("publication"===e?t.browseNodePublication:"issue"===e?t.browseNodeIssue:t.browseNodePage),t.setShowPaginationPane("browse"!==t.paginationPane.mode||!t.paginationPane.visible,"browse"),[2]}}))}))};return i.createElement("div",{id:"viewer-pagination-bar",className:"shadow-sm ".concat(t.showInformationPane?"opened":""),role:"navigation","aria-label":"Newspaper navigation"},i.createElement(l.ButtonGroup,{className:"bg-white rounded-lg align-items-center"},i.createElement(l.Button,{id:"page-left",color:"white",className:"icon-news icon-chevron-left rounded-0 border-right border",disabled:null===t.previousPage,"aria-label":"Previous page",onClick:function(){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return[4,t.loadPublicationBrowsePath()];case 1:return e.sent(),[4,t.loadIssues()];case 2:return e.sent(),t.previousPage&&(n("/image/".concat(t.previousPage.id,"/"),{state:{previous:t.page.id}}),t.loadImage(t.previousPage.id,!0)),[2]}}))}))}}),i.createElement(l.Button,{id:"page-right",color:"white","aria-label":"Next page",className:"icon-news icon-chevron rounded-0 border-right border mr-md-1",disabled:null===t.nextPage,onClick:function(){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return[4,t.loadPublicationBrowsePath()];case 1:return e.sent(),[4,t.loadIssues()];case 2:return e.sent(),t.nextPage&&(n("/image/".concat(t.nextPage.id,"/"),{state:{previous:t.page.id}}),t.loadImage(t.nextPage.id,!0)),[2]}}))}))}}),i.createElement(l.Button,{id:"mobile-information-button",color:"white",className:"d-md-none border-left border","aria-label":"Show sidebar",onClick:function(){t.showInformationPane?t.removeInformationPaneLayer("default",!0):t.addInformationPaneLayer("default")}},i.createElement(l.Badge,{pill:!0,"aria-hidden":"true"},"i")),i.createElement(l.Button,{id:"mobile-browse-button",color:"white",className:"d-md-none border-left border","aria-label":"Show sidebar",onClick:function(){f()}},i.createElement(p.Icon,{"aria-hidden":"true",icon:"film"})),t.selectedSegment&&!t.informationPaneLayers.length&&i.createElement(l.Button,{id:"mobile-details-button",color:"color",className:"d-md-none border-left border","aria-label":"Show sidebar",onClick:function(){t.addInformationPaneLayer("Segment")}},"Details"),i.createElement("div",{id:"browse-information",color:"white",className:"d-none d-md-block text-left text-nowrap"},t.image&&i.createElement("div",{className:"form-inline flex-nowrap no-gutters align-items-center"},i.createElement("div",{className:"col pl-2"},i.createElement("a",{role:"button",href:t.browseNodePublication,onClick:function(e){e.preventDefault(),f("publication")}},t.image.publicationTitle),i.createElement("span",{"aria-hidden":"true",className:"px-2 text-muted"},"›"),i.createElement("a",{role:"button",href:t.browseNodeIssue,onClick:function(e){e.preventDefault(),f("issue")}},(0,c.format)((0,c.parseISO)(t.image.date),"dd MMM yyyy, EEE")),i.createElement("span",{"aria-hidden":"true",className:"px-2 text-muted"},"›"),i.createElement("a",{role:"button",href:"#",onClick:function(e){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(t){return e.preventDefault(),f(),[2]}))}))}},"Page:"),i.createElement("label",{htmlFor:"pageNum",className:"sr-only"},"Select page number"),i.createElement("input",{className:"col-md-2 col-1 mx-2 form-control form-control-sm hide-spinner font-weight-bold ".concat(h?"is-valid":!1===h?"is-invalid":""),type:"text",id:"pageNum",size:3,placeholder:t.image.title.replace(/page\s/i,""),value:d,onChange:function(e){m(e.target.value)},onKeyDown:function(e){return a.__awaiter(void 0,void 0,void 0,(function(){var i;return a.__generator(this,(function(a){switch(a.label){case 0:return"Enter"!==e.key?[3,5]:[4,t.loadPublicationBrowsePath()];case 1:return a.sent(),[4,t.loadIssues()];case 2:return a.sent(),t.edition?(i=t.edition.pages.find((function(e){return e.number===d})))?(g(!0),n("/image/".concat(i.id,"/"),{state:{previous:t.page.id}}),[4,t.loadImage(i.id,!0)]):[3,4]:[3,5];case 3:return a.sent(),g(null),m(""),[3,5];case 4:g(!1),a.label=5;case 5:return[2]}}))}))}}),t.edition&&!1===h&&i.createElement("span",{className:"invalid-feedback text-right fixed-top bg-white rounded-sm mt-n3 col-5 ml-auto",role:"alert"},t.edition.pages.length," pages in this edition"))))))}))},609:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaginationPane=void 0;var a=n(1),i=n(19),r=n(90),o=n(248),s=n(7);t.PaginationPane=(0,i.observer)((function(e){var t=a.useContext(r.ViewerContext);return a.createElement("div",{id:"pagination-pane",className:t.paginationPane.visible?"open":""},a.createElement("div",{className:"".concat(t.paginationPane.mode," row no-gutters flex-column")},a.createElement("div",{className:"text-right pt-2 pr-2"},a.createElement(s.CloseButton,{onClick:function(){t.setShowPaginationPane(!1)}})),"browse"===t.paginationPane.mode&&t.browsePath&&a.createElement("div",{id:"viewer-page"},a.createElement(o.Browse,{viewerUrl:t.browsePath}))))}))},610:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewerControls=void 0;var a=n(1),i=n(19),r=n(90),o=n(5);t.ViewerControls=(0,i.observer)((function(e){var t=a.useContext(r.ViewerContext);return a.createElement("div",{id:"viewer-controls",className:"d-none d-md-block ".concat(t.showInformationPane?" opened":""),style:t.hideNavigationHeader?{}:{top:64}},a.createElement("div",{className:"viewer-control-tray d-flex flex-column rounded-lg p-1"},a.createElement(o.ButtonGroup,{vertical:!0,className:"mb-2 p-1","aria-label":"Image zooming controls"},a.createElement("button",{type:"button",title:"Zoom in",id:"btn-zoom-in",className:"btn btn-dark shadow icon-news icon-plus",disabled:t.zoom===t.MAX_ZOOM,onClick:function(){t.viewer.setZoom(1.3*t.zoom)}}),a.createElement("button",{type:"button",title:"Zoom out",id:"btn-zoom-out",className:"btn btn-dark shadow icon-news icon-minus",disabled:t.zoom===t.MIN_ZOOM,onClick:function(){t.viewer.setZoom(t.zoom/1.3)}})),a.createElement("button",{type:"button",title:"Brightness and Contrast",id:"btn-contrast",className:"btn btn-dark rounded-pill shadow icon-news icon-contrast",onClick:function(){"ImageSettings"===t.currentInformationPaneLayer?t.shiftInformationPaneLayer(!0):t.addInformationPaneLayer("ImageSettings")}})))}))},611:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OtherOptions=t.FreeTrialCard=t.HardOfferCard=t.SubscriptionDenyModal=void 0;var a=n(3),i=n(1),r=n(7),o=n(5),s=n(86),l=n(20),c=n(84),p=n(42),d=n(19);t.SubscriptionDenyModal=(0,d.observer)((function(e){var n,a,l,c=e.denies,d=i.useContext(s.NcomContext),u=i.useContext(p.SignInContext),h=c.find((function(e){return e.freeTrial})),g=c.find((function(e){return!e.freeTrial&&e.subscriptionTypeId<=5})),f=c.find((function(e){return e.subscriptionTypeId>5})),b=-1===d.subscription.indexOf("extra")&&-1!==d.subscription.indexOf("subscriber"),y=f&&(g||h),v="INT-deny-".concat(e.denyFromLocation),_=1===d.product.id||d.product.open,E=i.createElement(i.Fragment,null,y?"Choose":"You need"," a ",i.createElement("span",{className:"text-secondary2"},"subscription"));return b&&!y&&(E=i.createElement(i.Fragment,null,"Upgrade to a ",i.createElement("span",{className:"text-secondary2"},"Publisher Extra Subscription"))),i.createElement(r.NewsModal,{id:"subscription-deny",close:function(){var t=document.referrer?document.referrer:"";t.search("browse")>=0||t.search("search")>=0||t.search("title")>=0?history.go(-1):document.location.href="/newspage/".concat(e.image.imageId,"/")},visible:e.visible,size:"lg",header:i.createElement(i.Fragment,null,E," to view this page"),footer:d.user?i.createElement(o.Col,null,"Not ",i.createElement("b",{className:"text-truncate"},u.email),"? ",i.createElement("a",{href:"",onClick:function(e){e.preventDefault(),u.signout()}},"Sign out")):i.createElement(o.Col,null,"Already have an account? ",i.createElement("a",{href:"",onClick:function(e){e.preventDefault(),u.setMode("SIGNIN"),u.setIsVisibleLogin(!0)}},"Sign in"))},_&&!f&&!!h&&i.createElement(o.Row,null,i.createElement(o.Col,{sm:12,md:6},i.createElement(t.FreeTrialCard,{iid:v,deny:h,cardClassName:"border-0"},i.createElement(o.CardTitle,{className:"h5 text-center"},"Start a ",null===(n=null==h?void 0:h.freeTrialInfo)||void 0===n?void 0:n.duration,"-Day Free Trial"),i.createElement("ul",null,i.createElement("li",null,"Gain immediate access to this page"),i.createElement("li",null,"Unlimited access to ",(0,r.getText)(h.pageCount)," pages from over ",(0,r.roundCount)(h.publicationCount,100),"+ newspapers"),i.createElement("li",null,"Millions of pages added every month"))),e.showOtherOptions&&i.createElement(t.OtherOptions,{iid:v})),!!e.image&&i.createElement(m,{image:e.image})),_&&!f&&!h&&!!g&&i.createElement(o.Row,null,!!g&&!h&&i.createElement(o.Col,{sm:12,md:6},i.createElement(t.HardOfferCard,{iid:v,isUpgrade:b,deny:g,header:i.createElement(o.CardHeader,{className:"bg-extra text-center font-weight-bold"},"Access Everything"),cardBodyClassName:"border border-extra"},i.createElement(o.CardTitle,{className:"h5 text-center"},b&&i.createElement(i.Fragment,null,"Upgrade to "),g.subscriptionTypeName),i.createElement("ul",null,i.createElement("li",null,"Gain immediate access to this page"),i.createElement("li",null,"Unlimited access to ",(0,r.getText)(g.pageCount)," pages from over ",(0,r.roundCount)(g.publicationCount,100),"+ newspapers"),i.createElement("li",null,"Millions of pages added every month")))),!!e.image&&i.createElement(m,{image:e.image})),_&&!!f&&(!!h||!!g)&&i.createElement(i.Fragment,null,i.createElement(o.Row,null,!!h&&i.createElement(o.Col,{sm:12,md:6},i.createElement(t.FreeTrialCard,{iid:v,deny:h,header:i.createElement(o.CardHeader,{className:"bg-extra text-center font-weight-bold"},"Access Everything"),cardBodyClassName:"border border-extra"},i.createElement(o.CardTitle,{className:"h5 text-center"},"Start a ",null===(a=null==h?void 0:h.freeTrialInfo)||void 0===a?void 0:a.duration,"-Day Free Trial"),i.createElement("ul",null,i.createElement("li",null,"Includes access to the ",f.subscriptionTypeName," Archive"),i.createElement("li",null,"Plus unlimited access to ",i.createElement("b",null,(0,r.getText)(h.pageCount)," pages")," from over ",i.createElement("b",null,(0,r.roundCount)(h.publicationCount,100),"+ newspapers")),i.createElement("li",null,"Millions of additional pages ",i.createElement("b",null,"added monthly"))))),!!g&&!h&&i.createElement(o.Col,{sm:12,md:6},i.createElement(t.HardOfferCard,{iid:v,isUpgrade:b,deny:g,header:i.createElement(o.CardHeader,{className:"bg-extra text-center font-weight-bold"},"Access Everything"),cardBodyClassName:"border border-extra"},i.createElement(o.CardTitle,{className:"h5 text-center"},b&&i.createElement(i.Fragment,null,"Upgrade to "),i.createElement("span",{className:"text-extra"},g.subscriptionTypeName)),i.createElement("ul",null,i.createElement("li",null,"Includes access to the ",f.subscriptionTypeName," Archive"),i.createElement("li",null,"Plus unlimited access to ",i.createElement("b",null,(0,r.getText)(g.pageCount)," pages")," from over ",i.createElement("b",null,(0,r.roundCount)(g.publicationCount,100),"+ newspapers")),i.createElement("li",null,"Continually updated")))),i.createElement(o.Col,{sm:12,md:6},i.createElement(t.HardOfferCard,{iid:v,isUpgrade:!1,deny:f},i.createElement(o.CardTitle,{className:"h5 text-center"},"Get full access to the ",f.subscriptionTypeName," Archive"),i.createElement(o.CardText,null,"Subscribe to ",f.subscriptionTypeName," Archive to access ",i.createElement("b",null,(0,r.getText)(f.pageCount)," pages")," from ",i.createElement("b",null,f.startYear," to ",f.endYear))))),e.showOtherOptions&&i.createElement(t.OtherOptions,{iid:v})),!_&&!!f&&(!!h||!!g)&&i.createElement(i.Fragment,null,i.createElement(o.Row,null,i.createElement(o.Col,{sm:12,md:6},i.createElement(t.HardOfferCard,{iid:v,isUpgrade:!1,deny:f},i.createElement(o.CardTitle,{className:"h5 text-center"},"Get full access to the ",f.subscriptionTypeName," Archive"),i.createElement(o.CardText,null,"Subscribe to ",f.subscriptionTypeName," Archive to access ",i.createElement("b",null,(0,r.getText)(f.pageCount)," pages")," from ",i.createElement("b",null,f.startYear," to ",f.endYear)))),!!h&&i.createElement(o.Col,{sm:12,md:6},i.createElement(t.FreeTrialCard,{iid:v,deny:h,header:i.createElement(o.CardHeader,{className:"bg-extra text-center font-weight-bold"},"Access even more Newspapers"),cardBodyClassName:"border border-extra"},i.createElement(o.CardTitle,{className:"h5 text-center"},i.createElement("b",{style:{fontSize:"44px"},className:"icon-news icon-extra text-extra float-left"}),"Start a ",null===(l=null==h?void 0:h.freeTrialInfo)||void 0===l?void 0:l.duration,"-Day Free Trial of Newspapers.com ",i.createElement("span",{className:"text-extra"},h.subscriptionTypeName)),i.createElement("ul",null,i.createElement("li",null,"Includes access to the ",f.subscriptionTypeName," Archive"),i.createElement("li",null,"Plus unlimited access to ",i.createElement("b",null,(0,r.getText)(h.pageCount)," pages")," from over ",i.createElement("b",null,(0,r.roundCount)(h.publicationCount,100),"+ newspapers")),i.createElement("li",null,"Millions of additional pages ",i.createElement("b",null,"added monthly"))))),!!g&&!h&&i.createElement(o.Col,{sm:12,md:6},i.createElement(t.HardOfferCard,{iid:v,isUpgrade:b,deny:g,header:i.createElement(o.CardHeader,{className:"bg-extra text-center font-weight-bold"},"Access Everything"),cardBodyClassName:"border border-extra"},i.createElement(o.CardTitle,{className:"h5 text-center"},b&&i.createElement(i.Fragment,null,"Upgrade to "),g.subscriptionTypeName),i.createElement("ul",null,i.createElement("li",null,"Includes access to the ",f.subscriptionTypeName," Archive"),i.createElement("li",null,"Plus unlimited access to ",i.createElement("b",null,(0,r.getText)(g.pageCount)," pages")," from over ",i.createElement("b",null,(0,r.roundCount)(g.publicationCount,100),"+ newspapers")),i.createElement("li",null,"Continually updated"))))),e.showOtherOptions&&i.createElement(t.OtherOptions,{iid:v})))}));t.HardOfferCard=function(e){var t=i.useContext(s.NcomContext),n=a.__read(i.useState(!1),2),r=n[0],l=n[1],p=e.deny,d=(0,c.getCurrencyDetails)(p.currency),m=(0,c.getDisplayDuration)(p.duration),u=p.regularPrice!==p.discountPrice,h=t.paths.www;return p.subdomain&&(h=-1!==p.subdomain.indexOf(".")?"https://".concat(p.subdomain):t.paths.www.replace("www",p.subdomain)),i.createElement(o.Card,null,e.header,i.createElement(o.CardBody,{className:e.cardBodyClassName},e.children,i.createElement("div",{className:"text-center"},u&&i.createElement("del",{className:"text-muted mr-2 d-inline-block"},d.symbol,p.regularPrice),i.createElement("strong",{className:"h5 text-secondary2"},d.symbol,p.discountPrice)," per ",m,u&&"*",u&&i.createElement("p",{className:"text-muted mb-0"},i.createElement("span",{className:"highlight"},"*",p.discountName?p.discountName:""," discount applied.")),p.refunds&&i.createElement("p",{className:"mt-3"},"Refund from existing subscription(s): ",i.createElement("span",{className:"text-green"},p.refundAmount),i.createElement("a",{href:"/choose-a-plan/?r=1",onClick:function(e){e.preventDefault(),l(!r)}},"— ",r?"Hide":"See"," details")),r&&i.createElement("div",{className:"p-1",style:{backgroundColor:"#fdf7c7"}},i.createElement("h6",{className:"text-green"},"Refund Details"),p.refunds.map((function(e){return i.createElement("p",null,"You will receive a ",i.createElement("strong",null,"refund of ",(0,c.getCurrencyDetails)(e.currency).symbol,e.refund)," for the remaining value of your current ",i.createElement("strong",null,e.subscriptionName)," subscription. Please allow 3-5 business days for the refund to appear on your statement.")})),i.createElement("p",null,"This refund is from the remaining balance on your existing subscription(s) and will appear as a separate transaction on the card which was originally charged."))),i.createElement("div",{className:"text-center mt-3"},i.createElement("a",{href:"".concat(h,"/").concat(e.isUpgrade?"account/billing":"register","/?subscribe=yes&iid=").concat(e.iid,"&subtype=").concat(p.subscriptionTypeInternalName,"&ft=false&duration=").concat(p.duration),className:"btn btn-primary"},e.isUpgrade?"Upgrade Now":"Buy Now"),i.createElement("p",{className:"text-muted text-center mt-3"},i.createElement("small",null,"Plan prices are in ",d.pricesIn)))))};t.FreeTrialCard=function(e){var t=e.deny,n=i.useContext(s.NcomContext);return i.createElement(o.Card,{className:e.cardClassName},e.header,i.createElement(o.CardBody,{className:e.cardBodyClassName},e.children,i.createElement("div",{className:"text-center"},i.createElement("a",{href:"".concat(n.paths.www,"/freetrial/?subscribe=yes&iid=").concat(e.iid,"&subtype=").concat(t.subscriptionTypeInternalName,"&ft=true&duration=").concat(t.duration),className:"btn btn-primary"},"Start Free Trial"))))};var m=function(e){var t=i.useContext(s.NcomContext);return i.createElement(o.Col,{className:"d-none d-md-block",md:6},i.createElement(o.Card,null,i.createElement(o.CardHeader,{className:"bg-dark text-white text-center font-weight-bold"},e.image.publicationTitle," · ",(0,l.format)((0,l.parseISO)(e.image.date),"dd MMM yyyy")),i.createElement(o.CardImg,{top:!0,width:"100%",className:"img-fluid",height:"250",src:(0,r.getThumbnailUrl)(t.paths.image,e.image.imageId,{cache:!0,fill:!0})}),e.image.extra&&i.createElement(o.CardBody,{className:"border border-extra"},i.createElement(o.CardText,{className:"text-extra text-center font-weight-bold"},i.createElement("span",{className:"icon-news icon-extra"}),"Publisher Extra Paper"))))};t.OtherOptions=function(e){return i.createElement("div",{className:"float-right"},i.createElement("small",null,"See other ",i.createElement("a",{href:"/choose-a-plan/?iid=".concat(e.iid)},"options")))}},612:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderBar=void 0;var a=n(1),i=n(19),r=n(90),o=n(5),s=n(54),l=n(13),c=n(7);t.HeaderBar=(0,i.observer)((function(e){var t,n,i=a.useContext(r.ViewerContext),p=(null!=i.clippings?i.clippings.length:0)+(null!=i.articles?i.articles.marriages.length+i.articles.obituaries.length:0),d=!!i.image&&i.image.archived;return a.createElement(o.Container,{fluid:!0,tag:"main",className:"bg-white px-0 position-absolute border-bottom viewer-navbar",id:"content",tabIndex:-1},a.createElement(o.Row,{className:"shadow-sm align-items-center flex-nowrap"},a.createElement(l.ErrorBoundary,{FallbackComponent:c.FallbackOops},a.createElement("div",{className:"col-auto pr-0"},a.createElement("div",{"data-cy":"headerbar-nav-btn",className:"nav-btn",onClick:function(){i.toggleNavigationHeader()}},a.createElement("label",{itemID:"navcheck",className:"start","aria-controls":"#main-nav-list",id:"start"},a.createElement("div",{className:"spinner diagonal part-1","aria-hidden":"true"}),a.createElement("div",{className:"spinner horizontal","aria-hidden":"true"}),a.createElement("div",{className:"spinner diagonal part-2","aria-hidden":"true"}),a.createElement("span",{className:"sr-only"},"Show Navigation"))))),a.createElement(l.ErrorBoundary,{FallbackComponent:c.FallbackOops},!!document.referrer&&a.createElement("div",{className:"d-none d-sm-block col-auto px-0 border-right align-self-stretch order-2"},a.createElement(o.Button,{"data-cy":"headerbar-back-btn",color:"white",className:"icon-news icon-chevron-left border-bottom rounded-0 h-100",size:"lg",onClick:function(){location.href=document.referrer}}))),a.createElement(l.ErrorBoundary,{FallbackComponent:c.FallbackOops},a.createElement(o.Col,{className:"".concat(null!==i.hits.hits||i.hitsLoading?"d-flex align-items-center bg-primary position-relative align-self-stretch order-5 order-sm-3":"order-3"),xs:null!==i.hits.hits||i.hitsLoading?12:"",sm:7,md:"auto",lg:4,xl:3},a.createElement(o.InputGroup,{className:"".concat(null!==i.hits.hits||i.hitsLoading?"py-2 px-2 px-md-0":"")},!(null===(t=i.image)||void 0===t?void 0:t.archived)&&a.createElement(o.Input,{id:"find-text-on-this-page-input","data-cy":"find-text-input",bsSize:"sm",type:"text",placeholder:window.innerWidth<s.BREAKPOINT_SM?"Find text":"Find text on this page",className:"rounded-pill-start bg-light",disabled:null!==i.editSegment||i.hitsLoading,onKeyUp:function(e){"Enter"===e.code&&i.getHits()},onChange:function(e){i.setHitsText(e.target.value),""===e.target.value&&i.getHits()},value:i.hitsText}),!(null===(n=i.image)||void 0===n?void 0:n.archived)&&a.createElement(o.InputGroupAddon,{addonType:"append"},a.createElement(o.Button,{"data-cy":"find-text-search-or-close-btn",size:"sm",color:"light",className:"search border-left-0 border rounded-pill-end icon-news ".concat(i.hitsTextChanged||null===i.hits.hits?"icon-mag-left":"icon-close"),disabled:null!==i.editSegment,"aria-label":i.hitsTextChanged||null===i.hits.hits?"Find":"Clear search terms",onClick:function(){i.hitsTextChanged||i.setHitsText(""),i.getHits()}}))),i.hitsLoading&&a.createElement("div",{className:"text-white w-100 position-absolute text-center py-2 mx-n2",role:"status"},"Loading …"),!i.hitsLoading&&null!==i.hits.hits&&a.createElement("div",{className:"bg-primary d-flex align-items-center ml-md-2 px-2 px-md-0 py-2"},i.hits.hits.length>1&&a.createElement(o.ButtonGroup,{className:"col-auto ml-auto px-0"},a.createElement(o.Button,{color:"primary","aria-label":"Previous match",className:"icon-news icon-chevron-left",disabled:0===i.hits.hits.length,onClick:function(){i.setSelectedHitIndex(i.selectedHitIndex>0?i.selectedHitIndex-1:i.hits.hits.length-1)}}),a.createElement(o.Button,{color:"primary","aria-label":"Next match",className:"icon-news icon-chevron",disabled:0===i.hits.hits.length,onClick:function(){i.setSelectedHitIndex(i.selectedHitIndex<i.hits.hits.length-1?i.selectedHitIndex+1:0)}})),a.createElement("p",{className:"ml-2 text-nowrap text-white mb-0 small"},i.hits.hits.length>0?a.createElement(a.Fragment,null,i.selectedHitIndex+1," of ",i.hits.hits.length,"  matches"):a.createElement(a.Fragment,null,"No matches found"))))),p>0&&a.createElement(o.Col,{className:"d-none d-md-block order-4 pl-md-2"},a.createElement(o.Button,{"data-cy":"headerbar-see-clipping-types",color:i.showInformationPane?"brand":"secondary",size:"sm",className:"text-nowrap rounded-pill ".concat(i.showInformationPane?"text-white dropup":""),disabled:null!==i.editSegment||null!==i.selectedSegment,onClick:function(){i.showInformationPane?i.removeInformationPaneLayer("default",!0):i.addInformationPaneLayer("default")}},a.createElement("span",{className:"d-none d-md-inline"},i.showInformationPane?"Hide":"Show"," Details "),a.createElement(o.Badge,{color:"white",pill:!0},p)," ",a.createElement("span",{className:"dropdown-toggle","aria-hidden":"true"}))),a.createElement(o.Col,{xs:"auto",className:"d-none d-lg-block text-right ml-auto order-md-5"},!d&&a.createElement(o.Button,{id:"btn-clip",size:"sm",className:"icon-news icon-clip mr-1 rounded-pill",disabled:null!==i.editSegment,color:"dark",outline:!0,"data-cy":"clip-btn",onClick:function(e){i.createClipping("none")}}," Clip"),a.createElement(o.Button,{id:"btn-print",color:"dark","data-cy":"print-btn",size:"sm",outline:!0,className:"icon-news icon-download mr-1 rounded-pill",disabled:null!==i.editSegment,title:"Download and Print",onClick:function(e){i.beginPrintSave()}}," Download"),!d&&a.createElement(o.Button,{id:"btn-share",color:"primary",size:"sm","data-cy":"share-btn",outline:!0,disabled:null!==i.editSegment,className:"icon-news icon-share rounded-pill ".concat(i.editSegment&&"share"===i.postCreationAction?"selected":"","  mr-1"),onClick:function(e){i.createClipping("share")}}," Share"),!d&&a.createElement(o.Button,{id:"btn-save-to-ancestry",color:"","data-cy":"save-acom-btn",size:"sm",className:"icon-news icon-acom rounded-pill save-to-ancestry ".concat(i.editSegment&&"save-to-ancestry"===i.postCreationAction?"selected":"","  mr-1"),disabled:null!==i.editSegment,onClick:function(e){i.createClipping("save-to-ancestry")}}," Save to Ancestry")),a.createElement(o.Col,{className:"d-lg-none ml-auto pl-0 text-right".concat(null!==i.hits.hits||i.hitsLoading?" order-3 order-sm-5":" order-5"),xs:"auto"},a.createElement(o.ButtonGroup,{className:"mr-2"},a.createElement(o.UncontrolledDropdown,null,a.createElement(o.DropdownToggle,{id:"actionsMenu",className:"btn btn-secondary btn-sm shadow-sm border px-3 font-weight-bold  rounded-pill"},"Actions …"),a.createElement(o.DropdownMenu,{"aria-labelledby":"actionsMenu",right:!0},!d&&a.createElement(o.DropdownItem,{disabled:null!==i.editSegment,onClick:function(){i.createClipping("save-to-ancestry")}},a.createElement("span",{className:"ml-n2 icon-news icon-acom save-to-ancestry rounded p-1 mr-1","aria-hidden":"true"})," Save to Ancestry"),!d&&a.createElement(o.DropdownItem,{disabled:null!==i.editSegment,onClick:function(){i.createClipping("share")}},a.createElement("span",{className:"ml-n2 icon-news icon-share bg-primary rounded p-1 mr-1 text-white","aria-hidden":"true"})," Share"),a.createElement(o.DropdownItem,{disabled:null!==i.editSegment,onClick:function(){i.beginPrintSave()}},a.createElement("span",{className:"ml-n2 icon-news icon-print p-1 mr-1","aria-hidden":"true"})," Download and Print"),a.createElement(o.DropdownItem,{disabled:null!==i.editSegment,onClick:function(){i.createClipping("none")}},a.createElement("span",{className:"ml-n2 icon-news icon-clip p-1 mr-1","aria-hidden":"true"})," Clip"),a.createElement(o.DropdownItem,{disabled:null!==i.editSegment,onClick:function(){"ImageSettings"===i.currentInformationPaneLayer?i.shiftInformationPaneLayer(!0):i.addInformationPaneLayer("ImageSettings")}},a.createElement("span",{className:"ml-n2 icon-news icon-contrast p-1 mr-1","aria-hidden":"true"})," Brightness & Contrast"),a.createElement(o.DropdownItem,{disabled:null!==i.editSegment,onClick:function(){i.setShowInformationPane(!i.showInformationPane)}},i.showInformationPane?"Hide":"Show"," Details ",a.createElement(o.Badge,{color:"danger",pill:!0},p)," ",a.createElement("span",{className:"dropdown-toggle","aria-hidden":"true"}))))))))}))},614:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmEmailModal=void 0;var a=n(3),i=n(1),r=n(7),o=n(5),s=n(42),l=n(19),c=n(15),p=n(90);t.ConfirmEmailModal=(0,l.observer)((function(e){var t=i.useContext(p.ViewerContext),n=i.useContext(s.SignInContext),l=a.__read(i.useState(null),2),d=l[0],m=l[1];function u(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,c.AccountDao.resendConfirmation(e.imageId)];case 1:return t.sent(),m({color:"success",message:i.createElement(i.Fragment,null,"A verification email has been resent. It should arrive in your email shortly.")}),[2]}}))}))}return i.createElement(r.NewsModal,{id:"confirm-email-modal",close:function(){t.setShowConfirm(!1)},visible:e.visible,size:"lg",header:i.createElement(i.Fragment,null,"Your email needs to be verified"),footer:null,alert:d},i.createElement("p",null,"An email has been sent to ",i.createElement("strong",null,n.email)," from ",i.createElement("strong",null,"accounts@newspapers.com"),". Please verify your email by selecting the button in the verification email. After verification you will be able to ",i.createElement("a",{href:"/image/".concat(e.imageId,"/")},"return to this page")," and continue."),i.createElement(o.Card,{className:"bg-secondary p-2"},i.createElement(o.CardTitle,{className:"h6 mb-0"},"Didn't get the email?"),i.createElement(o.CardBody,null,i.createElement("ul",{className:"mb-0"},i.createElement("li",null,"The message may take a few minutes to arrive."),i.createElement("li",null,"Is your email address (",n.email,") correct?  If not, you can ",i.createElement("strong",null,i.createElement("a",{href:"/account/",target:"_blank"},"edit your email address"))," in ",i.createElement("b",null,"Account Details"),"."),i.createElement("li",null,"Check your junk email box.  "),null===d&&i.createElement("li",{id:"resend"},"Can't find the email? ",i.createElement(o.Button,{color:"primary",size:"sm",onClick:function(){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,u()];case 1:return e.sent(),[3,3];case 2:return e.sent(),m({color:"danger",message:i.createElement(i.Fragment,null,i.createElement("span",{className:"icon-error","aria-hidden":"true"})," Oops, we are having trouble resending the email. ",i.createElement("a",{href:"#",role:"button",onClick:function(e){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return e.preventDefault(),[4,u()];case 1:return t.sent(),[2]}}))}))}},"Try again"),".")}),[3,3];case 3:return[2]}}))}))}},"Resend"))))))}))},78:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClippingForm=void 0;var a=n(3),i=n(1),r=n(5),o=n(7),s=n(56),l=n(32);t.ClippingForm=function(e){var t=e.clipping,n=e.defaultSettings,c=a.__read(i.useState({value:t?t.title:"",visible:!0}),2),p=c[0],d=c[1],m=a.__read(i.useState({value:t?t.body:"",visible:t&&null!=t.body&&""!=t.body}),2),u=m[0],h=m[1],g=a.__read(i.useState(t&&t.tags?t.tags:""),2),f=g[0],b=g[1],y=a.__read(i.useState(new Map(function(e){var t=new Map,n=localStorage.getItem("recenttags");if(null!==n)try{JSON.parse(n).forEach((function(e){t.set(e.toLowerCase(),{display:e,selected:!1})}))}catch(e){console.error(e)}e&&e.tags&&e.tags.split(",").map((function(e){return e.trim()})).forEach((function(e){t.has(e.toLowerCase())&&t.set(e.toLowerCase(),{display:e,selected:!0})}));return t}(t))),2),v=y[0],_=y[1],E=a.__read(i.useState({visible:!1}),2),w=E[0],C=E[1],S=a.__read(i.useState({checked:t?t.is_public:!n||n.is_public}),2),N=S[0],x=S[1],k=a.__read(i.useState({checked:t?t.is_notify:!n||n.is_notify}),2),P=k[0],I=k[1];var M=i.useMemo((function(){var e=new l.Clipping(-1);return n&&Object.assign(e,n),t&&Object.assign(e,t),e}),[]);return i.useEffect((function(){M.title=p.value,M.body=u.value,M.tags=f,M.is_public=N.checked,M.is_notify=P.checked,e.onChange(M)}),[p,u,f,N,P]),i.createElement(i.Fragment,null,e.deletePageVisible&&i.createElement("p",{className:"alert alert-warning",role:"alert"},"This will ",i.createElement("b",null,"completely remove")," the ",i.createElement("em",null,p.value)," clipping. ",i.createElement("b",null,"You cannot undo this action.")),!e.deletePageVisible&&i.createElement(r.Form,{className:"container-fluid mx-0",onSubmit:function(e){e.preventDefault()}},e.showImage&&i.createElement(r.Row,null,i.createElement(r.Col,{className:"bg-dark text-center p-3"},i.createElement(s.ClipImageSearch,{clipping:t}))),i.createElement(r.FormGroup,{row:!0},i.createElement(r.Col,{sm:12,className:"mt-3"},i.createElement("label",{htmlFor:"clipping_title",className:"mb-1 font-weight-bold d-flex align-items-center"},i.createElement("span",null,"Add a title")," ",i.createElement("span",{className:"clip-title-count text-muted small font-weight-normal ml-auto",id:"clipping_title_chars"},100-p.value.length," ",i.createElement("span",{className:"sr-only"},"characters left"))," "),i.createElement(r.Input,{id:"clipping_title",name:"clipping_title","data-cy":"clip-title",type:"textarea","aria-describedby":"clipping_title_chars",value:p.value,onChange:function(e){e.target.value.length<=100?d(a.__assign(a.__assign({},p),{value:e.target.value.substring(0,100)})):null!=u.value&&0!==u.value.length||(h({visible:!0,value:e.target.value}),d(a.__assign(a.__assign({},p),{value:""})))}}),!u.visible&&i.createElement(r.Button,{"data-cy":"add-details",className:"text-muted text-small text-underline",color:"link",onClick:function(){h({visible:!0,value:""})}},"Add more details"))),u.visible&&i.createElement(r.FormGroup,{row:!0},i.createElement(r.Col,{sm:12,className:"pt-2"},i.createElement("label",{htmlFor:"clipping_body",className:"mb-1 font-weight-bold d-flex align-items-center"},i.createElement("span",null,"Details")," ",i.createElement("span",{id:"clipping_body_chars",className:"ml-auto clip-body-count text-muted font-weight-normal small text-right"},u?500-u.value.length:500," ",i.createElement("span",{className:"sr-only"},"characters left"))),i.createElement(r.Input,{id:"clipping_body",name:"clipping_body","data-cy":"clip-body","aria-describedby":"clipping_body_chars",placeholder:"(Optional)",type:"textarea",value:u.value,onChange:function(e){h({visible:!0,value:e.target.value.substring(0,500)})}}))),e.showTags&&i.createElement(r.FormGroup,{row:!0},i.createElement(r.Col,{sm:12,className:"border-top pt-2"},i.createElement("label",{className:"mb-1 font-weight-bold",htmlFor:"clip_tags"},"Tags"),i.createElement("fieldset",{className:"text-muted py-1 mb-1"},i.createElement("legend",{className:"font-weight-normal d-inline float-left w-auto mb-0 h6 mr-2"},"Recent:")," ",Array.from(v.keys()).map((function(e){var t=v.get(e),n=t.display,a=t.selected;return i.createElement(r.Badge,{role:"button",pill:!0,color:a?"dark":"white",className:"text-capitalize mr-1 ".concat(a?"":"border"),"aria-pressed":a?"true":"false",onClick:function(t){_(new Map(v.set(e,{display:n,selected:!a})));var i=new Map(f.split(",").filter((function(e){return e.trim().length>0})).map((function(e){return[e.trim().toLowerCase(),e.trim()]})));a?i.delete(e):i.set(e,n),b(Array.from(i.values()).join(", "))}},a&&i.createElement("small",{className:"icon-news icon-check mr-1","aria-hidden":"true"}),e)}))),i.createElement(r.Input,{"data-cy":"clip-tags",type:"textarea",id:"clip_tags",placeholder:"(Optional) Add other tags, separated by commas",autoComplete:"off",value:f,"aria-describedby":"clipHelp",onChange:function(e){var t=e.target.value;b(t);var n=new Map(t.split(",").filter((function(e){return e.trim().length>0})).map((function(e){return[e.trim().toLowerCase(),e.trim()]}))),i=new Map(v);i.forEach((function(e,t){i.set(t,a.__assign(a.__assign({},e),{selected:!1}))})),Array.from(n.keys()).forEach((function(e){i.has(e)&&i.set(e,a.__assign(a.__assign({},i.get(e)),{selected:!0}))})),_(i)}}),i.createElement("small",{id:"clipHelp",className:"form-text text-muted"},"Separate tags by commas. (Example: military, sports, society club, researching)"))),w.visible&&i.createElement(r.FormGroup,{row:!0,className:"border-top"},i.createElement(r.Col,{sm:12,className:"py-2"},i.createElement("span",{className:"mb-1 font-weight-bold"},"Who can see your clipping?")),i.createElement(r.Col,{sm:12},i.createElement(o.Checkbox,{name:"Clipping is visible to everyone",checked:N.checked,onChange:function(){x({checked:!N.checked})}}),N.checked&&i.createElement(o.Checkbox,{name:"Notify me when others reclip",checked:P.checked,onChange:function(){I({checked:!P.checked})}}))),i.createElement(r.Row,{className:"border-top ".concat(w.visible?" d-none":"")},i.createElement(r.Col,{sm:12,className:"px-3 py-2"},i.createElement("a",{onClick:function(){C(a.__assign(a.__assign({},w),{visible:!0}))},role:"button",className:"btn p-0 text-muted"},N.checked&&i.createElement(i.Fragment,null,i.createElement(o.Icon,{"data-cy":"visible-to-everyone",icon:"world align-middle","aria-hidden":"true"}),i.createElement("small",null,"Visible to everyone. ",i.createElement("u",null,"Change"))),!N.checked&&i.createElement(i.Fragment,null,i.createElement(o.Icon,{"data-cy":"only-visible-to-you",icon:"lock align-middle","aria-hidden":"true"}),i.createElement("small",null,"Only visible to you. ",i.createElement("u",null,"Change"))))))))}},8:function(e,t){e.exports=mobx},88:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClippingModal=void 0;var a=n(3),i=n(1),r=n(5),o=n(7),s=n(78),l=n(145);t.ClippingModal=function(e){var t=a.__read(i.useState({color:"success",message:""}),2),n=t[0],c=(t[1],a.__read(i.useState(!1),2)),p=c[0],d=c[1],m=a.__read(i.useState(!!e.visible),2),u=m[0],h=m[1],g=a.__read(i.useState(!1),2),f=g[0],b=g[1],y=a.__read(i.useState(e.clipping),2),v=y[0],_=y[1],E=function(){d(!p)},w=function(){var t=!u;t?l.enableBodyScroll(document.getElementById(e.id)):l.clearAllBodyScrollLocks(),h(t)};return i.createElement(i.Fragment,null,e.icon&&i.createElement(o.Icon,{icon:e.icon,onClick:w,title:e.title}),!e.icon&&i.createElement("button",{type:"button",onClick:w,className:"btn btn-link text-muted p-0 font-italic"},"Add a title"),i.createElement(o.NewsModal,{id:e.id,visible:u,header:p?"Remove this Clipping?":e.title,alert:n,footer:i.createElement(o.NewsModalFooter,{saving:f,buttonText:p?"Remove":"create"===e.mode?"Clip":"Save",savingButtonText:p?"Deleting…":"create"===e.mode?"Clipping…":"Saving…",saveButtonColor:"primary",onClose:p?E:w,onSave:function(){b(!0),p?e.onDelete(e.clipping):"create"===e.mode?e.onCreate(v):"update"===e.mode&&e.onUpdate(v,!1),b(!1),h(!1)}},i.createElement(r.Button,{type:"button",color:"outline-danger",size:"sm",onClick:E,className:"mr-auto order-0 ".concat("create"===e.mode||p?" d-none":""),tabIndex:0},i.createElement(o.Icon,{icon:"del","aria-hidden":"true"}),"Remove")),close:w},i.createElement(s.ClippingForm,{showImage:!0,showTags:!0,clipping:e.clipping,deletePageVisible:p,onChange:_})))}},90:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewerStore=t.ViewerContext=void 0;var a=n(3),i=n(1),r=n(8),o=n(54),s=n(341),l=n(579),c=n(108),p=n(79),d=n(580),m=n(7),u=n(581),h=n(15),g=n(225),f=n(111),b=n(61),y=n(21),v=n(20),_=n(129),E=n(582),w=n(342);t.ViewerContext=i.createContext(null);var C=function(){function e(e,t){this.ncom=e,this.signinStore=t,this.alert=null,this.page={id:page.image.imageId,width:page.image.width,height:page.image.height},this.attribution=page.attribution,this.image=page.image,this.rights=page.rights,this.iat=page.iat,this.imageLayer=null,this.allowLoading=!1,this.MIN_ZOOM=.05,this.MAX_ZOOM=2,this.ZOOM_STEP=1.3;var n=w.LocalStorageDao.getViewerZoom();this.zoom=null!==n?n:1,this.imageTilesZoom=.25,this.articles=page.articles,this.clippings=page.clipping?[page.clipping]:null,this.focus=null,this.hits={hits:null},this.hitsText="",this.hitsTextChanged=!1,this.hitsLoading=!1,this.selectedSegment=null,this.highlightSegment=null,this.editSegment=null,this.postCreationAction="none",this.showInformationPane=!1,this.informationPaneLayers=[],this.paginationPane={visible:!1,mode:"browse"},this.publicationBrowsePath=null,this.browsePath=null,this.issues=null,this.hasLoadedTile=new Map,this.shareClipping=null,this.overlappingSegments=null,this.printFullOrPartChoice=null,this.hideNavigationHeader=!0,this.denyFromLocation="search",this.showDeny=!1,this.deny=null,this.replacementImageId=null,this.defaultOpenSetting=!0,this.defaultNotifySetting=!0,this.checkedDefaultSettings=!1,this.imageSettings={contrast:0,brightness:0,invert:!1},this.allowExplicitImageLoading=!1,this.showExplicitWarningModal=!1,this.waitForSegmentOrHitBeforeLoadingTiles=-1!==document.location.search.indexOf("article=")||-1!==document.location.search.indexOf("clipping_id=")||-1!==document.location.search.indexOf("terms="),this.ocr=null,this.isReadingSupported="speechSynthesis"in window&&!(-1!==navigator.userAgent.indexOf("Safari")&&(-1!==navigator.userAgent.indexOf("iPad")||-1!==navigator.userAgent.indexOf("iPhone"))),this.isReading=null,this.readWarningAboutOcr=!1,this.previousActiveElement=null,this.showConfirm=!1;try{var a=new URLSearchParams(window.document.location.search).get("fcfToken");this.fcfToken=a||""}catch(e){}}return e.prototype.loadNeighborImage=function(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,this.loadPublicationBrowsePath()];case 1:return t.sent(),[4,this.loadIssues()];case 2:return t.sent(),"next"===e&&this.nextPage?(history.pushState({previous:this.page.id},"","/image/".concat(this.nextPage.id,"/")),this.loadImage(this.nextPage.id,!0)):"previous"===e&&this.previousPage&&(history.pushState({previous:this.page.id},"","/image/".concat(this.previousPage.id,"/")),this.loadImage(this.previousPage.id,!0)),[2]}}))}))},e.prototype.initializeShortcuts=function(){var e=this,t=navigator.userAgent.toUpperCase().indexOf("MAC OS")>=0;document.addEventListener("keydown",(function(n){if((n.metaKey&&t||n.ctrlKey)&&n.shiftKey&&"KeyC"===n.code&&!e.image.archived)n.preventDefault(),e.toggleClippingMode("none");else if((n.metaKey&&t||n.ctrlKey)&&n.shiftKey&&"KeyS"===n.code&&!e.image.archived&&!e.image.explicit)n.preventDefault(),e.toggleClippingMode("share");else if((n.metaKey&&t||n.ctrlKey)&&"Equal"===n.code)n.preventDefault(),e.viewer.setZoom(1.3*e.zoom);else if((n.metaKey&&t||n.ctrlKey)&&"Minus"===n.code)n.preventDefault(),e.viewer.setZoom(e.zoom/1.3);else if((n.metaKey&&t||n.ctrlKey)&&"ArrowRight"===n.code&&!e.image.archived)n.preventDefault(),e.loadNeighborImage("next");else if((n.metaKey&&t||n.ctrlKey)&&"ArrowLeft"===n.code&&!e.image.archived)n.preventDefault(),e.loadNeighborImage("previous");else if(!(n.metaKey&&t||n.ctrlKey)||"KeyP"!==n.code&&"KeyS"!==n.code||e.image.archived)if((n.metaKey&&t||n.ctrlKey)&&"KeyF"===n.code&&!e.image.archived){n.preventDefault();try{document.getElementById("find-text-on-this-page-input").focus()}catch(e){console.error(e)}}else(n.metaKey&&t||n.ctrlKey)&&"KeyI"===n.code&&!e.image.archived?(n.preventDefault(),null===e.editSegment&&e.setShowInformationPane(!e.showInformationPane)):(n.metaKey&&t||n.ctrlKey)&&"Slash"===n.code&&(n.preventDefault(),"KeyboardShortcuts"===e.currentInformationPaneLayer?e.shiftInformationPaneLayer(!0):e.addInformationPaneLayer("KeyboardShortcuts"));else n.preventDefault(),null===e.printFullOrPartChoice?e.beginPrintSave():e.setPrintFullOrPartChoice(null)}))},e.prototype.initializePopState=function(){var e=this;window.onpopstate=function(){var t=new RegExp(/\/image\/(\d+)\/.*/);if(document.location.pathname.match(t)){var n=parseInt(RegExp.$1);e.loadImage(n,!0)}}},e.prototype.updateDocumentTitle=function(e){document.title="".concat(e?"Article from ":"").concat((0,v.format)((0,v.parseISO)(this.image.date),"dd MMM yyyy"),", ").concat(this.image.title," - ").concat(this.image.publicationTitle," at ").concat(ncom.product.name)},e.prototype.setBrightness=function(e){this.imageSettings=a.__assign(a.__assign({},this.imageSettings),{brightness:e})},e.prototype.setContrast=function(e){this.imageSettings=a.__assign(a.__assign({},this.imageSettings),{contrast:e})},e.prototype.setInvert=function(e){this.imageSettings=a.__assign(a.__assign({},this.imageSettings),{invert:e})},e.prototype.setInformationPaneLayers=function(e){this.informationPaneLayers=e,this.informationPaneLayers.length>0&&this.setShowInformationPane(!0)},e.prototype.addInformationPaneLayer=function(e){e!==this.currentInformationPaneLayer&&(this.informationPaneLayers=a.__spreadArray([e],a.__read(this.informationPaneLayers),!1)),this.setShowInformationPane(!0);try{if(1===this.informationPaneLayers.length)try{this.previousActiveElement=document.activeElement}catch(e){}document.getElementById("information-pane-close-btn").focus()}catch(e){console.error(e)}},e.prototype.shiftInformationPaneLayer=function(e){if(this.informationPaneLayers=a.__spreadArray([],a.__read(this.informationPaneLayers.filter((function(e,t){return t>0}))),!1),0===this.informationPaneLayers.length&&e&&(this.setShowInformationPane(!1),null!==this.previousActiveElement)){try{this.previousActiveElement.focus()}catch(e){}this.previousActiveElement=null}},e.prototype.removeInformationPaneLayer=function(e,t){if(this.informationPaneLayers=a.__spreadArray([],a.__read(this.informationPaneLayers.filter((function(t){return t!==e}))),!1),0===this.informationPaneLayers.length&&t&&(this.setShowInformationPane(!1),null!==this.previousActiveElement)){try{this.previousActiveElement.focus()}catch(e){}this.previousActiveElement=null}},Object.defineProperty(e.prototype,"currentInformationPaneLayer",{get:function(){return this.informationPaneLayers.length>0?this.informationPaneLayers[0]:null},enumerable:!1,configurable:!0}),e.prototype.setShowExplicitWarningModal=function(e){this.showExplicitWarningModal=e},e.prototype.setAllowExplicitImageLoading=function(){this.allowExplicitImageLoading=!0,this.showExplicitWarningModal=!1,this.loadImage(this.page.id,!1)},e.prototype.getDefaultSettings=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t=this;return a.__generator(this,(function(n){switch(n.label){case 0:if(this.checkedDefaultSettings||!ncom.user)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,h.AccountDao.settings()];case 2:return e=n.sent(),this.defaultOpenSetting=e["watch-public"],this.defaultNotifySetting=e["watch-enabled"],[3,4];case 3:return n.sent(),this.setAlert({color:"danger",message:i.createElement(i.Fragment,null,"Sorry, we are unable to load your settings for new clippings. ",i.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),t.checkedDefaultSettings=!1,t.getDefaultSettings()}},"Try Again"),".")}),this.defaultNotifySetting=!0,this.defaultOpenSetting=!0,[3,4];case 4:return this.checkedDefaultSettings=!0,[3,6];case 5:ncom.user||(this.defaultNotifySetting=!0,this.defaultOpenSetting=!0),n.label=6;case 6:return[2]}}))}))},e.prototype.authorizeImage=function(e,t){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(a){switch(a.label){case 0:return e===this.image.imageId?[3,2]:[4,s.ViewerDao.authorizeImage(e,t)];case 1:n=a.sent(),this.page={id:n.image.imageId,width:n.image.width,height:n.image.height},this.image=n.image,this.iat=n.iat,this.rights=n.rights,a.label=2;case 2:return[2]}}))}))},e.prototype.resetViewer=function(){var e=this;this.allowLoading=!1,this.imageLayer=null,this.hasLoadedTile=new Map,this.articles=null,this.hits={hits:null},this.selectedSegment=null,this.editSegment=null,this.clippings=null,this.shareClipping=null,this.postCreationAction="none",this.imageTilesZoom=.25,this.fullResolutionLayerImageTiles=[],this.allowExplicitImageLoading=!1,null!==this.publicationBrowsePath&&this.image.publicationId!==this.publicationBrowsePath.id&&(this.publicationBrowsePath=null),null!==this.issues&&0===this.issues.issues.filter((function(t){return t.date===e.image.date})).length&&(this.issues=null),this.ocr=null,this.viewer.unload()},e.prototype.loadImage=function(e,t){var n,r;return a.__awaiter(this,void 0,void 0,(function(){var o,s,c,p,d,m,u,f=this;return a.__generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,12,,13]),this.toggleNavigationHeader(!1),[4,this.authorizeImage(e,"")];case 1:return a.sent(),t&&this.resetViewer(),this.updateDocumentTitle(),o=this.getFitZoom(),this.MIN_ZOOM=Math.min(o.height,o.width),!this.image.explicit||this.allowExplicitImageLoading?[3,3]:[4,(0,b.getExplicitPreference)(!0)];case 2:if("show"!==a.sent())return this.showExplicitWarningModal=!0,[2];a.label=3;case 3:return this.image.canView?(s=w.LocalStorageDao.getViewerZoom(),this.setZoom(null!==s?s:o.width),this.fullResolutionLayerImageTiles=(0,l.getLayerImageUrls)(this.ncom.paths.image,this.ncom.user,null===(r=null===(n=this.ncom)||void 0===n?void 0:n.institution)||void 0===r?void 0:r.id,this.page,this.imageTilesZoom,0,0,!1,this.iat),this.hasLoadedTile=new Map,this.imageLayer=this.getImageLayer(1),this.allowLoading=!0,this.loadClippings(),[4,this.loadArticles()]):[3,8];case 4:return a.sent(),-1!==this.image.reasonCanView.indexOf("silo-")&&(this.alert={color:"info",message:i.createElement(i.Fragment,null,"You can see this page because you are subscribed through the publisher's website.")}),this.image.archived?[4,this.findReplacementImage()]:[3,6];case 5:return a.sent(),this.alert={color:"warning",message:i.createElement(i.Fragment,null,"Pages from this newspaper have been replaced with better quality images. ",this.replacementImageId?i.createElement("a",{href:"/image/".concat(this.replacementImageId,"/")},"See the updated image"):null)},[3,7];case 6:this.loadHits(),a.label=7;case 7:return this.loadOcr(),(0,y.sendActionEvent)("view",this.image.imageId.toString(),{newspaper_date:this.image.date,newspaper_name:this.image.publicationTitle}),[3,11];case 8:return this.setZoom(o.width),!ncom.product.paid&&ncom.product.id>3&&!ncom.user||this.image.allowedSubscriptionTypes.find((function(e){return-1!==e.indexOf("register")}))?(this.toggleNavigationHeader(!0),this.signinStore.setMode("REGISTER"),this.signinStore.setActivity("to view this page"),this.signinStore.setIsVisibleLogin(!0),[3,11]):[3,9];case 9:return this.toggleNavigationHeader(!0,!1),c=/.*\/browse.*/.test(document.referrer),p=/.*\/newspage.*/.test(document.referrer),d=c?"browse":p?"newspage":"search",[4,h.AccountDao.getDeny(d,ncom.country_code,this.image.imageId)];case 10:m=a.sent(),g.default.set("docId",this.image.imageId.toString(),!0),this.denyFromLocation=d,this.deny=m,this.showDeny=!0,a.label=11;case 11:return[3,13];case 12:return u=a.sent(),console.error(u),this.toggleNavigationHeader(!0,!1),this.alert={color:"danger",message:i.createElement(i.Fragment,null,i.createElement("span",{className:"icon-error"})," Oops, we are having trouble loading the image. ",i.createElement("a",{href:"#",onClick:function(t){t.preventDefault(),f.alert=null,f.loadImage(e,!0)}},"Try again"),".")},[3,13];case 13:return[2]}}))}))},e.prototype.findReplacementImage=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n,i;return a.__generator(this,(function(a){switch(a.label){case 0:return[4,c.BrowseDao.getIssue(this.image.publicationId.toString(),this.image.date)];case 1:return e=a.sent(),t=/Page\s([a-zA-Z0-9]+)/i,this.image.title.match(t),n=RegExp.$1,i=null,e.editions.find((function(e){var t=e.pages.find((function(e){return e.number===n}));return!!t&&(i=t.id,!0)})),this.replacementImageId=i,[2]}}))}))},e.prototype.getFocusRectangle=function(){var e=/focus=([0-9\.]+),([0-9\.]+),([0-9\.]+),([0-9\.]+)/gi.exec(location.search);if(e&&e.length>=5){var t={x1:e[1],y1:e[2],x2:e[3],y2:e[4]};if(t.x2>t.x1&&t.y2>t.y1){var n=Math.round(t.x1*this.page.width),a=Math.round(t.x2*this.page.width),i=Math.round(t.y1*this.page.height);return{x:n,y:i,width:a-n,height:Math.round(t.y2*this.page.height)-i}}}return null},e.prototype.loadArticles=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n,o,l,c,p,d,m,h=this;return a.__generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),this.articles?[3,2]:[4,s.ViewerDao.getArticles(this.image.imageId)];case 1:e=a.sent(),this.articles=e,a.label=2;case 2:try{t=new URLSearchParams(window.document.location.search),-1!==(n=t.get("article")).indexOf("/")&&(n=n.substring(n.indexOf("/")+1,n.length)),o=this.articles.obituaries.find((function(e){return e.id===n})),l=this.articles.marriages.find((function(e){return e.id===n})),c=this.articles.everydayStories.find((function(e){return e.id===n})),o?this.setSelectedSegment({id:n,rectangle:o.rectangle,type:"obituary"}):l?this.setSelectedSegment({id:n,rectangle:l.rectangle,type:"marriage"}):c?(p=void 0,c.polygon?p=(0,u.convertPolygonToRectangle)((0,r.toJS)(c.polygon),this.page.width,this.page.height):c.rectangle&&(p=c.rectangle),p?(this.focus=p,this.setSelectedSegment({id:"focus",rectangle:p,type:"focus"})):this.waitForSegmentOrHitBeforeLoadingTiles=!1):null!==(d=this.getFocusRectangle())?(this.focus=d,this.setSelectedSegment({id:"focus",rectangle:d,type:"focus"})):n&&(this.waitForSegmentOrHitBeforeLoadingTiles=!1)}catch(e){console.error(e)}return[3,4];case 3:return m=a.sent(),this.waitForSegmentOrHitBeforeLoadingTiles=!1,this.articles={obituaries:[],marriages:[],everydayStories:[]},this.alert={color:"danger",message:i.createElement(i.Fragment,null,"Oops, we are having trouble loading articles. ",i.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),h.alert=null,h.loadArticles()}},"Try Again"),".")},console.error(m),[3,4];case 4:return this.viewer&&this.viewer.checkLoadTiles(),[2]}}))}))},e.prototype.loadPublicationBrowsePath=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n=this;return a.__generator(this,(function(a){switch(a.label){case 0:if(null!==this.publicationBrowsePath)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),e=this,[4,c.BrowseDao.getPublicationBrowsePath(this.image.publicationId.toString())];case 2:return e.publicationBrowsePath=a.sent(),[3,4];case 3:return t=a.sent(),console.error(t),this.alert={color:"danger",message:i.createElement(i.Fragment,null,"Oops, we are having trouble loading publication information. ",i.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),n.alert=null,n.loadPublicationBrowsePath()}},"Try Again"),".")},[3,4];case 4:return[2]}}))}))},e.prototype.setBrowsePath=function(e){this.browsePath=e},Object.defineProperty(e.prototype,"browseNodePublication",{get:function(){return this.publicationBrowsePath?this.publicationBrowsePath.path:""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"browseNodeIssue",{get:function(){return this.image.date.match(/(\d{4})-(\d{2})-(\d{2})/),this.publicationBrowsePath?"".concat(this.publicationBrowsePath.path,"/").concat(RegExp.$1,"/").concat(RegExp.$2,"/").concat(RegExp.$3):""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"browseNodePage",{get:function(){var e=null!==this.edition&&this.issues.issues[0].editions.length>1?"/"+this.edition.title.toLowerCase().replace(/\s+/g,"-"):"";return this.browseNodeIssue?"".concat(this.browseNodeIssue).concat(e):""},enumerable:!1,configurable:!0}),e.prototype.loadIssues=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n=this;return a.__generator(this,(function(a){switch(a.label){case 0:if(null!==this.issues)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),e=this,[4,c.BrowseDao.getIssues(this.image.publicationId.toString(),this.image.date,"1","issue")];case 2:return e.issues=a.sent(),[3,4];case 3:return t=a.sent(),console.error(t),this.alert={color:"danger",message:i.createElement(i.Fragment,null,"Oops, we are having trouble loading data for this newspaper issue. ",i.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),n.alert=null,n.loadIssues()}},"Try Again"),".")},[3,4];case 4:return[2]}}))}))},e.prototype.updateClipping=function(e,t,n){return a.__awaiter(this,void 0,void 0,(function(){var i,o,s;return a.__generator(this,(function(l){switch(l.label){case 0:return[4,p.ClippingDao.update(e,t,n)];case 1:return i=l.sent(),this.clippings&&(o=a.__spreadArray([],a.__read((0,r.toJS)(this.clippings)),!1),(s=this.clippings.findIndex((function(t){return t.clipping_id!==e.clipping_id})))>-1?o[s]=i:o.unshift(i),this.clippings=o),[2]}}))}))},e.prototype.loadClippings=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n,r,o,s,l=this;return a.__generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e=this,[4,p.ClippingDao.getClippingsOnPage(this.image.imageId)];case 1:return e.clippings=a.sent(),[3,3];case 2:return t=a.sent(),this.clippings=[],this.alert={color:"danger",message:i.createElement(i.Fragment,null,"Oops, we are having trouble loading clippings. ",i.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),l.alert=null,l.loadClippings()}},"Try Again"),".")},console.error(t),[3,3];case 3:try{n=new URLSearchParams(window.document.location.search),r=n.get("clipping_id"),o=n.get("article"),(s=this.clippings.find((function(e){return e.clipping_id.toString()===r})))&&!o?this.setSelectedSegment({id:r,rectangle:s.rectangle,type:"clipping"}):!r||s||o||(this.waitForSegmentOrHitBeforeLoadingTiles=!1)}catch(e){this.waitForSegmentOrHitBeforeLoadingTiles=!1,console.error(e)}return this.viewer&&this.viewer.checkLoadTiles(),[2]}}))}))},e.prototype.setAlert=function(e){this.alert=e},e.prototype.toggleNavigationHeader=function(e,t){var n=this;this.hideNavigationHeader=void 0!==e?!e:!this.hideNavigationHeader,this.hideNavigationHeader||!1===t||setTimeout((function(){n.ncom.user&&document.getElementById("navcheck").click()}),100)},e.prototype.toggleClippingMode=function(e){if(this.editSegment)this.setEditSegment(null);else{this.setPostCreationAction(e);var t=this.selectedSegment;this.setSelectedSegment(null);var n=t?t.rectangle:this.viewer.getViewportClippingRectangle();this.setEditSegment({id:"new",rectangle:n,type:"clipping",source:t})}},e.prototype.addClipping=function(e){this.clippings=a.__spreadArray(a.__spreadArray([],a.__read((0,r.toJS)(this.clippings)),!1),[e],!1)},e.prototype.removeClipping=function(e){this.clippings=a.__spreadArray([],a.__read(this.clippings.filter((function(t){return t.clipping_id!==e}))),!1)},e.prototype.setShowInformationPane=function(e){this.showInformationPane=e,this.viewer&&(this.viewer.updateProps(this.getViewerData()),this.viewer.position())},e.prototype.setShowPaginationPane=function(e,t){t||(t=this.paginationPane.mode),this.paginationPane={visible:e,mode:t}},e.prototype.setHitsText=function(e){this.hitsText=e,this.hitsTextChanged=!!e},e.prototype.setHitsChanged=function(e){this.hitsTextChanged=e},e.prototype.loadOcr=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t;return a.__generator(this,(function(n){switch(n.label){case 0:if(null!==this.ocr)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),e=this,[4,s.ViewerDao.ocr(this.image.imageId,"page",this.image.imageId.toString())];case 2:return e.ocr=n.sent().ocr,[3,4];case 3:return t=n.sent(),this.ocr="Oops, we are having trouble loading the OCR for this page.",console.error(t),[3,4];case 4:return[2]}}))}))},e.prototype.loadHits=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n,i;return a.__generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),e=new URLSearchParams(window.document.location.search),t=e.get("terms"),n=e.get("match"),t?(this.hitsText=t,[4,this.getHits()]):[3,2];case 1:return a.sent(),n&&this.setSelectedHitIndex(parseInt(n)-1),[3,3];case 2:-1!==document.location.href.indexOf("terms=")&&(this.waitForSegmentOrHitBeforeLoadingTiles=!1),a.label=3;case 3:return[3,5];case 4:return i=a.sent(),console.error(i),[3,5];case 5:return[2]}}))}))},e.prototype.getHits=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:return""!==this.hitsText?[3,1]:(this.hits={hits:null},this.hitsTextChanged=!1,this.setOverlappingSegments(null),[3,5]);case 1:return r.trys.push([1,3,,4]),(0,y.sendActionEvent)("find",this.image.imageId.toString(),{newspaper_name:this.image.publicationTitle,newspaper_date:this.image.date}),this.hitsLoading=!0,[4,s.ViewerDao.getHits(this.image.imageId,this.hitsText)];case 2:return e=r.sent(),this.hitsLoading=!1,e.hits.length?(this.selectedSegment=null,this.selectedHitIndex=0,null!==this.focus&&null!==this.selectedSegment&&"focus"===this.selectedSegment.type&&(e.hits=e.hits.filter((function(e){return(0,u.containsRectangle)(n.focus,e)}))),this.hits=e,e.hits.length||(this.waitForSegmentOrHitBeforeLoadingTiles=!1),window.innerWidth>=o.BREAKPOINT_MD&&((t=this.getOverlappingSegments((function(e){var t,i,r=!1;try{for(var o=a.__values(n.hits.hits),s=o.next();!s.done;s=o.next()){var l=s.value;if((0,u.containsRectangle)(e,{x:l.x,y:l.y,width:l.width,height:l.height})){r=!0;break}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}return r}))).clippings.size||t.marriages.size||t.obituaries.size)&&this.setOverlappingSegments(t)):(this.hits=e,this.waitForSegmentOrHitBeforeLoadingTiles=!1),[3,4];case 3:return r.sent(),this.waitForSegmentOrHitBeforeLoadingTiles=!1,this.hitsLoading=!1,this.hits={hits:null},this.setOverlappingSegments(null),this.setAlert({color:"danger",message:i.createElement(i.Fragment,null,"Sorry, we are unable load matches on the page. ",i.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),n.setAlert(null),n.getHits()}},"Try Again"),".")}),[3,4];case 4:this.hitsTextChanged=!1,r.label=5;case 5:return[2]}}))}))},e.prototype.setSelectedHitIndex=function(e){this.selectedHitIndex=e},Object.defineProperty(e.prototype,"selectedHit",{get:function(){return null!=this.hits.hits&&this.hits.hits.length&&this.selectedHitIndex>=0&&this.selectedHitIndex<this.hits.hits.length?this.hits.hits[this.selectedHitIndex]:null},enumerable:!1,configurable:!0}),e.prototype.setHighlightSegment=function(e){this.highlightSegment=e},e.prototype.setSelectedSegment=function(e,t){var n=this;if(this.setOverlappingSegments(null),this.setHighlightSegment(null),this.setHitsText(""),this.getHits(),this.isReading=null,this.isReadingSupported&&speechSynthesis.cancel(),e){if(null===this.selectedSegment&&("clipping"===e.type||"marriage"===e.type||"obituary"===e.type)&&-1===document.location.search.indexOf(e.id)){var a=[{name:"clipping"===e.type?"clipping_id":"article",value:e.id}],i=(0,_.addOrUpdateParameters)(location.search,a,["clipping_id","article"]);history.pushState({},"","/image/".concat(this.image.imageId,"/").concat(i)),this.updateDocumentTitle(!0)}if(window.innerWidth<o.BREAKPOINT_MD)this.selectedSegment=e;else{(void 0===t||t)&&this.addInformationPaneLayer("Segment");var r=this.showInformationPane;this.showSegmentDetails(t),r?this.selectedSegment=e:setTimeout((function(){n.selectedSegment=e}),250)}}else{i=(0,_.addOrUpdateParameters)(location.search,[],["clipping_id","article"]);history.pushState({},"","/image/".concat(this.image.imageId,"/").concat(i)),this.updateDocumentTitle(!1),this.focus=null,this.selectedSegment=null,this.removeInformationPaneLayer("Segment",!0)}},e.prototype.setEditSegment=function(e,t){var n=this;e?(this.showSegmentDetails(t),this.editSegment=e,this.showInformationPane?this.editSegment=e:setTimeout((0,r.action)((function(){n.editSegment=e})),250)):this.editSegment&&(this.postCreationAction="none",this.editSegment=null,this.removeInformationPaneLayer("Segment"))},e.prototype.setPostCreationAction=function(e){this.postCreationAction=e},e.prototype.setShareClipping=function(e,t){this.shareClipping=null===e?null:{clipping:e,initialName:t}},e.prototype.setShareClippingById=function(e,t){if(e){var n=this.clippings.find((function(t){return t.clipping_id===e}));n&&(this.shareClipping={clipping:n,initialName:t})}else this.shareClipping=null},e.prototype.setPrintFullOrPartChoice=function(e){this.printFullOrPartChoice=e,null!=e?this.addInformationPaneLayer("PrintSaveView"):this.removeInformationPaneLayer("PrintSaveView")},e.prototype.showSegmentDetails=function(e){(void 0===e||e)&&this.addInformationPaneLayer("Segment"),this.setShowPaginationPane(!1)},e.prototype.setZoom=function(e){this.zoom=e,w.LocalStorageDao.setViewerZoom(e)},e.prototype.getFitZoom=function(){return{width:window.innerWidth/this.page.width,height:Math.floor(.7*window.innerHeight)/this.page.height}},e.prototype.getImageLayer=function(e){return{zoom:e,width:Math.floor(this.page.width*e),height:Math.floor(this.page.height*e)}},e.prototype.setHasLoadedTile=function(e){this.hasLoadedTile.set(e,!0)},Object.defineProperty(e.prototype,"thumbnail",{get:function(){return this.page.width&&this.page.height?{width:this.page.width,height:this.page.height,href:(0,m.getThumbnailUrl)(ncom.paths.image,this.page.id,{width:400,height:400,cache:!0})}:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"edition",{get:function(){var e=this;if(this.issues){var t=this.issues.issues[0].editions.find((function(t){return void 0!==t.pages.find((function(t){return t.id===e.image.imageId}))}));return t||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousPage",{get:function(){var e=this;if(null!==this.edition){var t=this.edition.pages.findIndex((function(t){return t.id===e.image.imageId}));if(0===t)return null;var n=this.edition.pages[t-1].id;return{id:n,thumbnail:(0,m.getThumbnailUrl)(ncom.paths.image,n,{width:400,height:400,cache:!0})}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextPage",{get:function(){var e=this;if(null!==this.edition){var t=this.edition.pages.findIndex((function(t){return t.id===e.image.imageId}));if(t===this.edition.pages.length-1)return null;var n=this.edition.pages[t+1].id;return{id:n,thumbnail:(0,m.getThumbnailUrl)(ncom.paths.image,n,{width:400,height:400,cache:!0})}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filteredClippings",{get:function(){var e=this;return null!=this.clippings?this.clippings.filter((function(t){return null===e.overlappingSegments||e.overlappingSegments.clippings.has(t.clipping_id)})):[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filteredObituaries",{get:function(){var e=this;return null!=this.articles?this.articles.obituaries.filter((function(t){return null===e.overlappingSegments||e.overlappingSegments.obituaries.has(t.id)})):[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filteredMarriages",{get:function(){var e=this;return null!=this.articles?this.articles.marriages.filter((function(t){return null===e.overlappingSegments||e.overlappingSegments.marriages.has(t.id)})):[]},enumerable:!1,configurable:!0}),e.prototype.loadSaveToAncestry=function(e){var t=this,n=document.createElement("script");n.src=ncom.saveToAncestryApiScript,document.head.appendChild(n),n.onload=function(){if(void 0!==window.SaveToAncestryApi)try{p.ClippingDao.getSaveToAncestryClippingDetails(e.clipping_id).then((function(t){var n,a,i=t.data;window.SaveToAncestryApi.invoke(i),(0,f.putEvent)({type:"SAVE_TO_ANCESTRY",facets:{label:"clipping",user:(null===ncom||void 0===ncom?void 0:ncom.user)?ncom.user:void 0,product:(null===(n=null===ncom||void 0===ncom?void 0:ncom.product)||void 0===n?void 0:n.id)?ncom.product.id:void 0,institution:(null===(a=null===ncom||void 0===ncom?void 0:ncom.institution)||void 0===a?void 0:a.id)?ncom.institution.id:void 0,clipping:e.clipping_id,image:e.page_id,publication:e.page_publication_id,article:e.article_id?e.article_id:void 0}})}))}catch(e){console.error(e),t.alert={color:"danger",message:i.createElement(i.Fragment,null,"Oops, we are having trouble loading Save to Ancestry. Please try again later.")}}n.remove()}},e.prototype.setOverlappingSegments=function(e){e&&this.addInformationPaneLayer("default"),this.overlappingSegments=e},e.prototype.getOverlappingSegments=function(e){var t=new Map;null!=this.clippings&&this.clippings.filter((function(t){return e(t.rectangle)})).forEach((function(e){t.set(e.clipping_id,!0)}));var n=new Map,a=new Map;return null!=this.articles&&(this.articles.obituaries.filter((function(t){return e(t.rectangle)})).forEach((function(e){n.set(e.id,!0)})),this.articles.marriages.filter((function(t){return e(t.rectangle)})).forEach((function(e){a.set(e.id,!0)}))),{clippings:t,obituaries:n,marriages:a,hasOverlap:t.size+n.size+a.size>1}},e.prototype.checkCreateClippingRights=function(e){if(this.rights.CreateFootnote&&this.rights.CreateFootnote.allowed)return!0;if(this.ncom.user)this.signinStore.confirmed?this.alert={message:i.createElement(i.Fragment,null,i.createElement("span",{className:"icon-error"})," Your account is not allowed to create a clipping at this time."),color:"danger"}:!1===this.signinStore.confirmed&&(this.showConfirm=!0);else{this.toggleNavigationHeader(!0),this.signinStore.setMode("REGISTER");var t=null;switch(e){case"print-or-save":t="to print or download a clipping";break;case"save-to-ancestry":t="to save a clipping to Ancestry";break;case"share":t="to share a clipping";break;case"none":default:t="to create a clipping"}this.signinStore.setActivity(t),this.signinStore.setIsVisibleLogin(!0)}return!1},e.prototype.checkDownloadRights=function(){return!(!this.rights.Download||!this.rights.Download.allowed)||(this.ncom.user?this.signinStore.confirmed?this.alert={message:i.createElement(i.Fragment,null,i.createElement("span",{className:"icon-error"})," Your account is not allowed to download or print at this time."),color:"danger"}:!1===this.signinStore.confirmed&&(this.showConfirm=!0):(this.toggleNavigationHeader(!0),this.signinStore.setMode("REGISTER"),this.signinStore.setActivity("to print or download this page"),this.signinStore.setIsVisibleLogin(!0)),!1)},e.prototype.setShowConfirm=function(e){this.showConfirm=e},e.prototype.createClipping=function(e){var t=this;if(this.editSegment)this.setEditSegment(null);else if("share"===e&&null!==this.selectedSegment&&"clipping"===this.selectedSegment.type){var n=this.clippings.find((function(e){return e.clipping_id===parseInt(t.selectedSegment.id)}));n&&this.setShareClipping(n)}else{if(!this.checkCreateClippingRights(e))return;this.setPostCreationAction(e);var a=this.selectedSegment;this.setSelectedSegment(null);var i=a?a.rectangle:this.viewer.getViewportClippingRectangle();this.setEditSegment({id:"new",rectangle:i,type:"clipping",source:a})}},e.prototype.beginPrintSave=function(){null!=this.selectedSegment&&"clipping"==this.selectedSegment.type?this.setPrintFullOrPartChoice({mode:"part"}):this.checkDownloadRights()&&(ncom.user&&null!=this.selectedSegment?this.createClipping("print-or-save"):null!=this.selectedSegment?this.setPrintFullOrPartChoice({mode:"part"}):this.setPrintFullOrPartChoice({mode:null}))},e.prototype.setFullResolutionLayerImageTiles=function(e){var t,n;this.imageTilesZoom!==e&&(this.imageTilesZoom=e,this.fullResolutionLayerImageTiles=(0,l.getLayerImageUrls)(this.ncom.paths.image,this.ncom.user,null===(n=null===(t=this.ncom)||void 0===t?void 0:t.institution)||void 0===n?void 0:n.id,this.page,this.imageTilesZoom,0,0,!1,this.iat))},e.prototype.setWaitForSegmentOrHitBeforeLoadingTiles=function(e){this.waitForSegmentOrHitBeforeLoadingTiles=e},e.prototype.readSegment=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,n,i,r=this;return a.__generator(this,(function(a){switch(a.label){case 0:return this.isReadingSupported?null===this.isReading||!speechSynthesis.speaking||speechSynthesis.paused?[3,1]:(speechSynthesis.pause(),this.isReading=!1,[3,4]):[2];case 1:return null!==this.isReading&&speechSynthesis.speaking&&speechSynthesis.paused?(speechSynthesis.resume(),this.isReading=!0,[3,4]):[3,2];case 2:if(null===this.selectedSegment)return[3,4];switch(speechSynthesis.cancel(),e="other",this.selectedSegment.type){case"obituary":case"marriage":e="article";break;case"clipping":e=this.selectedSegment.type}return[4,s.ViewerDao.ocr(this.image.imageId,e,this.selectedSegment.id,this.selectedSegment.rectangle)];case 3:t=a.sent().ocr,n=(0,E.cleanOcr)(t),(i=new SpeechSynthesisUtterance("".concat(this.readWarningAboutOcr||!n?"":"The following text was pulled by a computer and may not be accurate."," ").concat(n||"No text was found to read."))).onend=function(){r.isReading=null},window.onbeforeunload=function(){r.isReading=null,speechSynthesis.cancel()},speechSynthesis.speak(i),this.isReading=!0,this.readWarningAboutOcr=!0,a.label=4;case 4:return[2]}}))}))},e.prototype.initializeViewer=function(e,t){var n=this;this.viewer=new d.default(e,t,this.getViewerData(),{onZoom:function(e){e!==n.zoom&&n.setZoom(e)},onRequestLayer:function(e){n.setFullResolutionLayerImageTiles(e)},onSegment:function(e,t){if(n.setOverlappingSegments(null),n.selectedSegment&&null!==e)n.selectedSegment.id!==e.id||n.informationPaneLayers.length||n.addInformationPaneLayer("Segment");else if(null!==e){var a=n.getOverlappingSegments((function(e){return(0,u.containsPoint)(e,t)}));a.hasOverlap?(n.setOverlappingSegments(a),n.setShowInformationPane(!0)):n.setSelectedSegment(e)}else n.setSelectedSegment(null)},onEditSegment:function(e){n.setEditSegment(e,!1)},onTileLoad:function(e){n.setHasLoadedTile(e)},onClearWaitForSegmentOrHitBeforeLoadingTiles:function(){n.setWaitForSegmentOrHitBeforeLoadingTiles(!1)}})},e.prototype.updateViewer=function(e){this.viewer.update(e,this.getViewerData())},e.prototype.getViewerData=function(){return{thumbnail:this.thumbnail,tiles:this.fullResolutionLayerImageTiles,tileImageSettings:this.imageSettings,hasLoadedTile:this.hasLoadedTile,layer:this.imageLayer,zoom:this.zoom,minZoom:this.MIN_ZOOM,maxZoom:this.MAX_ZOOM,articles:this.articles,clippings:this.clippings,focus:this.focus,hits:this.hits,selectedSegment:this.selectedSegment,highlightSegment:this.highlightSegment,overlappingSegments:this.overlappingSegments,editSegment:this.editSegment,selectedHit:this.selectedHit,previousPage:this.previousPage,nextPage:this.nextPage,translateExtentLeftPadding:this.showInformationPane&&window.innerWidth>=o.BREAKPOINT_MD?2e3:500,waitForSegmentOrHitBeforeLoadingTiles:this.waitForSegmentOrHitBeforeLoadingTiles,headerText:"".concat(this.image.publicationTitle," · ").concat((0,v.format)((0,v.parseISO)(this.image.date),"dd MMM yyyy, EEE")," · Page ").concat(this.image.title," · (").concat(this.image.location,")"),ocr:this.ocr,informationPaneOpen:!!this.informationPaneLayers.length}},a.__decorate([r.observable],e.prototype,"alert",void 0),a.__decorate([r.observable],e.prototype,"page",void 0),a.__decorate([r.observable],e.prototype,"imageTilesZoom",void 0),a.__decorate([r.observable],e.prototype,"fullResolutionLayerImageTiles",void 0),a.__decorate([r.observable],e.prototype,"hasLoadedTile",void 0),a.__decorate([r.observable],e.prototype,"imageLayer",void 0),a.__decorate([r.observable],e.prototype,"allowLoading",void 0),a.__decorate([r.observable],e.prototype,"attribution",void 0),a.__decorate([r.observable],e.prototype,"iat",void 0),a.__decorate([r.observable],e.prototype,"zoom",void 0),a.__decorate([r.observable],e.prototype,"image",void 0),a.__decorate([r.observable],e.prototype,"rights",void 0),a.__decorate([r.observable],e.prototype,"articles",void 0),a.__decorate([r.observable],e.prototype,"focus",void 0),a.__decorate([r.observable],e.prototype,"selectedSegment",void 0),a.__decorate([r.observable],e.prototype,"highlightSegment",void 0),a.__decorate([r.observable],e.prototype,"editSegment",void 0),a.__decorate([r.observable],e.prototype,"postCreationAction",void 0),a.__decorate([r.observable],e.prototype,"selectedHitIndex",void 0),a.__decorate([r.observable],e.prototype,"issues",void 0),a.__decorate([r.observable],e.prototype,"hitsText",void 0),a.__decorate([r.observable],e.prototype,"hitsTextChanged",void 0),a.__decorate([r.observable],e.prototype,"hits",void 0),a.__decorate([r.observable],e.prototype,"hitsLoading",void 0),a.__decorate([r.observable],e.prototype,"showInformationPane",void 0),a.__decorate([r.observable],e.prototype,"informationPaneLayers",void 0),a.__decorate([r.observable],e.prototype,"paginationPane",void 0),a.__decorate([r.observable],e.prototype,"clippings",void 0),a.__decorate([r.observable],e.prototype,"publicationBrowsePath",void 0),a.__decorate([r.observable],e.prototype,"browsePath",void 0),a.__decorate([r.observable],e.prototype,"fcfToken",void 0),a.__decorate([r.observable],e.prototype,"shareClipping",void 0),a.__decorate([r.observable],e.prototype,"printFullOrPartChoice",void 0),a.__decorate([r.observable],e.prototype,"overlappingSegments",void 0),a.__decorate([r.observable],e.prototype,"hideNavigationHeader",void 0),a.__decorate([r.observable],e.prototype,"denyFromLocation",void 0),a.__decorate([r.observable],e.prototype,"showDeny",void 0),a.__decorate([r.observable],e.prototype,"deny",void 0),a.__decorate([r.observable],e.prototype,"replacementImageId",void 0),a.__decorate([r.observable],e.prototype,"defaultOpenSetting",void 0),a.__decorate([r.observable],e.prototype,"defaultNotifySetting",void 0),a.__decorate([r.observable],e.prototype,"imageSettings",void 0),a.__decorate([r.observable],e.prototype,"allowExplicitImageLoading",void 0),a.__decorate([r.observable],e.prototype,"showExplicitWarningModal",void 0),a.__decorate([r.observable],e.prototype,"checkedDefaultSettings",void 0),a.__decorate([r.observable],e.prototype,"waitForSegmentOrHitBeforeLoadingTiles",void 0),a.__decorate([r.observable],e.prototype,"ocr",void 0),a.__decorate([r.observable],e.prototype,"isReadingSupported",void 0),a.__decorate([r.observable],e.prototype,"isReading",void 0),a.__decorate([r.observable],e.prototype,"readWarningAboutOcr",void 0),a.__decorate([r.observable],e.prototype,"showConfirm",void 0),a.__decorate([r.action],e.prototype,"setBrightness",null),a.__decorate([r.action],e.prototype,"setContrast",null),a.__decorate([r.action],e.prototype,"setInvert",null),a.__decorate([r.action],e.prototype,"setInformationPaneLayers",null),a.__decorate([r.action],e.prototype,"addInformationPaneLayer",null),a.__decorate([r.action],e.prototype,"shiftInformationPaneLayer",null),a.__decorate([r.action],e.prototype,"removeInformationPaneLayer",null),a.__decorate([r.computed],e.prototype,"currentInformationPaneLayer",null),a.__decorate([r.action],e.prototype,"setShowExplicitWarningModal",null),a.__decorate([r.action],e.prototype,"setAllowExplicitImageLoading",null),a.__decorate([r.action],e.prototype,"getDefaultSettings",null),a.__decorate([r.action],e.prototype,"authorizeImage",null),a.__decorate([r.action],e.prototype,"resetViewer",null),a.__decorate([r.action],e.prototype,"loadImage",null),a.__decorate([r.action],e.prototype,"findReplacementImage",null),a.__decorate([r.action],e.prototype,"loadArticles",null),a.__decorate([r.action],e.prototype,"loadPublicationBrowsePath",null),a.__decorate([r.action],e.prototype,"setBrowsePath",null),a.__decorate([r.computed],e.prototype,"browseNodePublication",null),a.__decorate([r.computed],e.prototype,"browseNodeIssue",null),a.__decorate([r.computed],e.prototype,"browseNodePage",null),a.__decorate([r.action],e.prototype,"loadIssues",null),a.__decorate([r.action],e.prototype,"updateClipping",null),a.__decorate([r.action],e.prototype,"loadClippings",null),a.__decorate([r.action],e.prototype,"setAlert",null),a.__decorate([r.action],e.prototype,"toggleNavigationHeader",null),a.__decorate([r.action],e.prototype,"toggleClippingMode",null),a.__decorate([r.action],e.prototype,"addClipping",null),a.__decorate([r.action],e.prototype,"removeClipping",null),a.__decorate([r.action],e.prototype,"setShowInformationPane",null),a.__decorate([r.action],e.prototype,"setShowPaginationPane",null),a.__decorate([r.action],e.prototype,"setHitsText",null),a.__decorate([r.action],e.prototype,"setHitsChanged",null),a.__decorate([r.action],e.prototype,"loadOcr",null),a.__decorate([r.action],e.prototype,"loadHits",null),a.__decorate([r.action],e.prototype,"getHits",null),a.__decorate([r.action],e.prototype,"setSelectedHitIndex",null),a.__decorate([r.computed],e.prototype,"selectedHit",null),a.__decorate([r.action],e.prototype,"setHighlightSegment",null),a.__decorate([r.action],e.prototype,"setSelectedSegment",null),a.__decorate([r.action],e.prototype,"setEditSegment",null),a.__decorate([r.action],e.prototype,"setPostCreationAction",null),a.__decorate([r.action],e.prototype,"setShareClipping",null),a.__decorate([r.action],e.prototype,"setShareClippingById",null),a.__decorate([r.action],e.prototype,"setPrintFullOrPartChoice",null),a.__decorate([r.action],e.prototype,"showSegmentDetails",null),a.__decorate([r.action],e.prototype,"setZoom",null),a.__decorate([r.action],e.prototype,"setHasLoadedTile",null),a.__decorate([r.computed],e.prototype,"thumbnail",null),a.__decorate([r.computed],e.prototype,"edition",null),a.__decorate([r.computed],e.prototype,"previousPage",null),a.__decorate([r.computed],e.prototype,"nextPage",null),a.__decorate([r.computed],e.prototype,"filteredClippings",null),a.__decorate([r.computed],e.prototype,"filteredObituaries",null),a.__decorate([r.computed],e.prototype,"filteredMarriages",null),a.__decorate([r.action],e.prototype,"checkCreateClippingRights",null),a.__decorate([r.action],e.prototype,"checkDownloadRights",null),a.__decorate([r.action],e.prototype,"setShowConfirm",null),a.__decorate([r.action],e.prototype,"createClipping",null),a.__decorate([r.action],e.prototype,"beginPrintSave",null),a.__decorate([r.action],e.prototype,"setFullResolutionLayerImageTiles",null),a.__decorate([r.action],e.prototype,"setWaitForSegmentOrHitBeforeLoadingTiles",null),a.__decorate([r.action],e.prototype,"readSegment",null),e}();t.ViewerStore=C},99:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MemberNavigation=void 0;var a=n(3),i=n(1),r=n(6),o=n(49),s=n(50),l=n(13),c=n(7),p=n(20),d=n(5),m=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n.node=i.createRef(),n.handleClick=n.handleClick.bind(n),n}return a.__extends(t,e),t.prototype.onClickShowLogin=function(e){e.preventDefault(),this.props.signinStore.setIsVisibleLogin(!this.props.signinStore.visible_login)},t.prototype.onClickMemberInfoDropdown=function(e){e.preventDefault(),this.props.signinStore.setMemberinfoDropdownVisible(!this.props.signinStore.memberinfo_dropdown_visible)},t.prototype.onClickSignout=function(e){e.preventDefault(),this.props.signinStore.signout()},t.prototype.toggleTpaDropdown=function(e){this.props.signinStore.setTpaDropdownVisible(!this.props.signinStore.tpa_dropdown_visible)},t.prototype.onClickRegister=function(e){window.location.href="/register/"},t.prototype.onClickTpaSignIn=function(e){this.props.signinStore.setTpaDropdownVisible(!1),this.props.signinStore.setIsVisibleLogin(!0)},t.prototype.componentWillMount=function(){document.addEventListener("mousedown",this.handleClick,!1)},t.prototype.componentWillUnmount=function(){document.removeEventListener("mousedown",this.handleClick,!1)},t.prototype.handleClick=function(e){this.node&&this.node.current&&this.node.current.contains(e.target)||this.handleOutsideClick()},t.prototype.handleOutsideClick=function(){this.props.signinStore.setMemberinfoDropdownVisible(!1)},t.prototype.render=function(){return i.createElement("div",{ref:this.node,className:"d-flex align-items-center"},i.createElement(l.ErrorBoundary,{FallbackComponent:c.FallbackOops},this.props.signinStore.tpaData.authorized&&i.createElement("button",{type:"button",className:"tpa-nav btn btn-link text-center text-md-right",onClick:this.toggleTpaDropdown.bind(this)},i.createElement("strong",null,this.props.signinStore.tpaData.paper),i.createElement("span",null,"Free access from ",this.props.signinStore.tpaData.startDate?i.createElement(i.Fragment,null,(0,p.format)((0,p.parseISO)(this.props.signinStore.tpaData.startDate),"MMM d, yyyy")):i.createElement(i.Fragment,null,(0,p.sub)(new Date,{years:Number(this.props.signinStore.tpaData.period)}).getFullYear())," to ",(new Date).getFullYear())),this.props.signinStore.tpaData.authorized&&0===this.props.signinStore.id&&i.createElement(c.NewsModal,{id:"news-tpa-modal",visible:this.props.signinStore.tpa_dropdown_visible,header:"".concat(this.props.signinStore.tpaData.paper," Archive Access"),footer:i.createElement(d.Col,{sm:12,className:"text-center"},i.createElement("strong",null,"Already have an account?")," ",i.createElement("a",{href:"javascript:void(0);",onClick:this.onClickTpaSignIn.bind(this),className:"btn-forward"},"Sign In")),close:this.toggleTpaDropdown.bind(this)},i.createElement("div",{id:"tpainfo"},i.createElement("p",{className:"alert alert-warning icon-info"},"You are authenticated through the ",i.createElement("strong",null,this.props.signinStore.tpaData.paper)," with free access ",i.createElement("strong",null,"from ",this.props.signinStore.tpaData.startDate?i.createElement(i.Fragment,null,(0,p.format)((0,p.parseISO)(this.props.signinStore.tpaData.startDate),"MMM d, yyyy")):i.createElement(i.Fragment,null,(0,p.sub)(new Date,{years:Number(this.props.signinStore.tpaData.period)}).getFullYear())," to ",(new Date).getFullYear()),"."),i.createElement("div",{className:"modal-body text-center"},i.createElement("h2",{className:"text-center clr1"},"Create an account for more benefits*"),i.createElement("p",null,i.createElement(c.NewsButton,{color:"p",disabled:!1,disabledLabel:"",onClick:this.onClickRegister.bind(this)},"Create ",i.createElement("em",null,this.props.signinStore.tpaData.paper," Archive")," account*")),i.createElement("p",null,"*An account allows you to create and share Clippings.")))),0===this.props.signinStore.id&&i.createElement("div",{className:"mem-nav ml-auto"},i.createElement(d.Nav,{className:"ml-auto inline navbar-expand",navbar:!0},!this.props.hideSubscribe&&1===ncom.product.id&&i.createElement(d.NavItem,{id:"pg-join",className:"d-none d-sm-inline-block rounded-pill"},i.createElement(d.NavLink,{href:"/free-trial/?iid=3826",className:"active text-white rounded-pill"},"Free Trial")),!this.props.hideSubscribe&&1!==ncom.product.id&&ncom.product.paid&&!this.props.signinStore.tpaData.authorized&&i.createElement(d.NavItem,{id:"pg-join",className:"rounded-pill"},i.createElement(d.NavLink,{href:"/choose-a-plan/?iid=619",className:"active text-white rounded-pill"},i.createElement("i",null,"Get Archive Access"))),!this.props.signinStore.tpaData.authorized&&i.createElement(d.NavItem,{className:"rounded-pill"},i.createElement(d.NavLink,{href:"/signin/",id:"signinlink",className:"signinlink rounded-pill pl-3 pl-md-0",onClick:this.onClickShowLogin.bind(this)},i.createElement("svg",{className:"icon-sm align-middle mr-3 mr-lg-0","aria-labelledby":"icon-person"},i.createElement("use",{xlinkHref:"#icon-person"}))," ",i.createElement("span",{className:"d-none d-xl-inline"},"Sign-in"))))),this.props.signinStore.visible_login&&0===this.props.signinStore.id&&i.createElement(s.SignInModal,{signinStore:this.props.signinStore}),this.props.signinStore.id>0&&i.createElement(o.MemberInfo,{user_id:this.props.signinStore.id,user_name:this.props.signinStore.name?this.props.signinStore.name:"",user_type:this.props.signinStore.type,visible_memberinfo:this.props.signinStore.memberinfo_dropdown_visible,global:this.props.signinStore.ncom,onClickSignout:this.onClickSignout.bind(this),onClickDropdown:this.onClickMemberInfoDropdown.bind(this)})))},t=a.__decorate([r.observer],t)}(i.Component);t.MemberNavigation=m}});
//# sourceMappingURL=viewer.bundle.a1f4893e95fdc508dbef.js.map